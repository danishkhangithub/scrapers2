(window.webpackJsonp=window.webpackJsonp||[]).push([["vdp-payment-calculator"],{"../node_modules/odometer/themes/odometer-theme-default.css":function(e,t,a){},"../node_modules/react-day-picker/lib/style.css":function(e,t,a){},"../node_modules/slick-carousel/slick/slick-theme.css":function(e,t,a){},"../node_modules/slick-carousel/slick/slick.css":function(e,t,a){},"./data/models/dealerships.js":function(e,t,a){"use strict";a.d(t,"a",function(){return h}),a.d(t,"e",function(){return g}),a.d(t,"f",function(){return f}),a.d(t,"g",function(){return b}),a.d(t,"d",function(){return E}),a.d(t,"c",function(){return y}),a.d(t,"b",function(){return v});var s=a("../node_modules/@babel/runtime/helpers/esm/objectSpread.js"),i=a("../node_modules/lodash/round.js"),n=a.n(i),r=a("../node_modules/lodash/get.js"),o=a.n(r),l=a("../node_modules/prop-types/index.js"),c=a.n(l),d=a("./data/api/api-client.js"),p=a("./data/api/api-metrics.js"),m=a("./data/luckdragon/segment.js"),u=a("./data/models/visitor.js");const h={Dealer:c.a.shape({id:c.a.number,rooftopId:c.a.number,name:c.a.string,logicalName:c.a.string,rooftopLogicalName:c.a.string,parentDealershipName:c.a.string,make:c.a.string,address:c.a.shape({apartment:c.a.string,city:c.a.string,stateCode:c.a.string,stateName:c.a.string,street:c.a.string,zip:c.a.string,county:c.a.string,country:c.a.string}),phones:c.a.arrayOf(c.a.string),location:c.a.shape({lat:c.a.number,lon:c.a.number}),distance:c.a.number,productFeatures:c.a.shape({active:c.a.bool,directDealer:c.a.bool,lpStatus:c.a.bool,ppStatus:c.a.bool,upStatus:c.a.bool,verified:c.a.bool,types:c.a.arrayOf(c.a.string),productLineItems:c.a.arrayOf(c.a.shape({id:c.a.number,group:c.a.string,product:c.a.string}))}),phoneNumbers:c.a.shape({}),dealerType:c.a.string,sortOrders:c.a.shape({tier:c.a.number}),publishDate:c.a.string,groupId:c.a.string,groupName:c.a.string,newUsedType:c.a.string,showroomPage:c.a.string,salesReviewCount:c.a.number,salesRating:c.a.number})},g=e=>{let t=e.make,a=void 0===t?"all":t,s=e.pageNum,i=void 0===s?1:s,n=e.directDealer;return`makes["${a}"].page["${i}"].directDealer["${void 0!==n&&n}"]`},f=e=>{let t=e.make,a=void 0===t?"all":t,s=e.pageSize;return`makes["${a}"].page["${void 0===s?1:s}"].mileOne`},b=e=>{let t=e.pageNum;return`national.page["${void 0===t?1:t}"]`},E=(e,t)=>{return`closestDealers.platform["${e?"mobile":"wired"}"].makes["${t.make}"]`},y=e=>{return`closestDealers.makes["${e.make}"]`},v=Object(m.a)("dealerships",[{path:'national.page["{pageNum}"]',async resolve(e,t){const a=e.pageNum,i=`/dealer/v5/find?dealerType=DEALERFRANCHISE&productFeatures.active=true&view=DEFAULT&pageSize=18&pageNum=${a>500?500:a}&groupby=rooftopId&sortBy=displayInfo.salesOverallRating:desc,displayInfo.salesReviewCount:desc`;return Object(p.b)(d.c,t).fetchJson(i).then(e=>Object(s.a)({},e,{totalPages:e.totalPages>500?500:e.totalPages})).catch(()=>({totalPages:0,results:[]}))}},{path:'makes["{make}"].page["{pageNum}"].directDealer["{directDealer}"]',async resolve(e,t){const a=e.make,i=e.pageNum,n=e.directDealer,r=(await t.resolveValue("location",u.c)).zipCode,o=`/dealer/v5/find?dealerType=DEALERFRANCHISE&productFeatures.active=true${"true"===n?"&productFeatures.directDealer=true":""}&view=DEFAULT&pageSize=18&pageNum=${i>500?500:i}${"all"===a?"&groupby=rooftopId":`&make=${a}`}${r?`&address.zip=${r}&radius=500&sortBy=_geo:asc,displayInfo.salesOverallRating:desc`:""}`;return Object(p.b)(d.c,t).fetchJson(o).then(e=>Object(s.a)({},e,{totalPages:e.totalPages>500?500:e.totalPages})).catch(()=>({totalPages:0,results:[]}))}},{path:'makes["{make}"].page["{pageSize}"].mileOne',async resolve(e,t){const a=e.make,i=`/dealer/v5/find?dealerType=DEALERFRANCHISE&productFeatures.active=true&productFeatures.directDealer=true&view=DEFAULT&pageSize=${e.pageSize}&pageNum=1${"all"===a?"":`&make=${a}`}&groupby=rooftopId&address.zip=${(await t.resolveValue("location",u.c)).zipCode}&radius=50&displayInfo.parentDealershipName=MileOne Automotive&sortBy=displayInfo.parentDealershipName,_geo`;return Object(p.b)(d.c,t).fetchJson(i).then(e=>Object(s.a)({},o()(e,"results[0]",{}))).catch(()=>({}))}},{path:'closestDealers.platform["{platform}"].makes["{make}"]',async resolve(e,t){try{const a=e.make,i=e.platform,r=await t.resolveValue("location",u.c),l=r.zipCode,c=r.latitude,m=r.longitude,h="mobile"===i,g=`/dealer/v5/find?dealerType=DEALERFRANCHISE&productFeatures.active=true&view=DEFAULT&pageSize=10&pageNum=1&make=${a}$&address.zip=${l}&lat=${c}&lon=${m}&radius=500&sortBy=_geo:asc`,f=await Object(p.b)(d.c,t).fetchJson(g);return o()(f,"results",[]).map(e=>Object(s.a)({},e,{distanceLabel:h?`${e.name} (${n()(e.distance,1)} mi)`:`${e.name} - ${e.address.city}, ${e.address.stateCode} (${n()(e.distance,1)} mi)`}))}catch(e){return[]}}},{path:'closestDealers.makes["{make}"]',async resolve(e,t){try{const a=e.make,i=await t.resolveValue("location",u.c),r=`/dealer/v5/find?dealerType=DEALERFRANCHISE&productFeatures.active=true&view=DEFAULT&pageSize=10&pageNum=1&make=${a}$&address.zip=${i.zipCode}&lat=${i.latitude}&lon=${i.longitude}&radius=500&sortBy=_geo:asc`,l=await Object(p.b)(d.c,t).fetchJson(r);return o()(l,"results",[]).map(e=>Object(s.a)({},e,{distanceLabel:`${e.name} (${n()(e.distance,1)} mi)`}))}catch(e){return[]}}},{path:"dealershipsSearchFilter"},{path:"dealershipsSearchResults",async resolve(e,t){try{const e=await t.resolveValue("dealershipsSearchFilter"),a=o()(e,"name",""),s=(await t.resolveValue("location",u.c)).zipCode;if(!a)return[];const i=`/dealer/v5/find?dealerType=DEALERFRANCHISE&name=${a}&address.zip=${s}&view=DEFAULT&radius=500&sortBy=_geo:asc`,n=await Object(p.b)(d.c,t).fetchJson(i);return o()(n,"results",[])}catch(e){return[]}}}])},"./engagement-handlers/calculator-engagement-handler/calculator-engagement-handler.js":function(e,t,a){"use strict";var s=a("../node_modules/@babel/runtime/helpers/esm/objectSpread.js"),i=a("../node_modules/lodash/get.js"),n=a.n(i),r=a("./utils/event-toolbox.js"),o=a("./tracking/constant.js"),l=a("./site-modules/shared/constants/calculator/calculator.js"),c=a("../node_modules/lodash/isNumber.js"),d=a.n(c),p=a("./site-modules/shared/utils/calculator/calculator-helper.js");function m(e){let t=e.payments,a=e.limitCriteria,s=e.inventory,i=e.type;const r=n()(s,"computedDisplayInfo.transparentPricingCompliance.bestDealPrice"),o=n()(s,"dealerInfo.address.zip"),c=n()(s,"prices",{}),m=c.tmv,u=c.displayPrice,h=c.partnerInvoicePrice,g=t.tradeIn,f=t.downPayment,b=t.fees,E=t.taxes,y=t.expDate,v=t.endDate,C=t.creditScore,S=t.term,T=t.numberOfMonths,I=t.totalTaxesAndFees,_=t.annualMileage,N=t.primaryIncentiveAmount,O=t.conditionalIncentiveAmount,P=t.financeRate,A=t.apr,x=t.monthly,k=t.monthlyWithTaxes,V=t.moneyFactor,w=t.residualPercentage,j=t.residual,R=t.dueAtSigning,M=t.totalLeaseCost,D=t.docFee,L=i===l.h,F=n()(b,"docFee")||D,U=n()(b,"combinedFees"),q=n()(E,"combinedSalesTax"),z=I||U+q||0,B=S||T,$=P||A,Y=w||j,H=y||v,Z=L?void 0:M||k*(S-1)+R,G=function(e){let t=e.limitCriteria,a=e.tradeIn,s=e.downPayment;const i=Object(p.d)({limitCriteria:t},"TRADE_IN"),n=Object(p.d)({limitCriteria:t},"DOWN_PAYMENT");return{appliedDownPayment:d()(n)?n:s,appliedTradeIn:d()(i)?i:a}}({limitCriteria:a,tradeIn:g,downPayment:f}),W=G.appliedTradeIn;return{pmt_msrp:u,pmt_tmv:m,pmt_dealer_price:h,pmt_esp:r,pmt_doc_fee:F,pmt_dealer_zip_code:o,pmt_type:i,pmt_credit_score:C,pmt_term:B,pmt_annual_mileage:L?void 0:_,pmt_down_payment:f,pmt_applied_down_payment:G.appliedDownPayment,pmt_tradein:g,pmt_applied_tradein:W,pmt_conditional_incentives:O,pmt_primary_incentives:N,pmt_finance_rate:$,pmt_apply_limits:!0,pmt_with_concrete_taxes_and_fees:!0,pmt_base_monthly_payment:x,pmt_monthly_payment_with_taxes_and_fees:k,pmt_total_taxes_and_fees:z,pmt_total_taxes:q,pmt_total_fees:U,pmt_money_factor:V,pmt_residual_value:Y&&u?Y*u:void 0,pmt_residual_percentage:Y,pmt_total_due_at_signing:R,pmt_total_cost_to_lessee:Z,pmt_expiration_date:H}}var u=a("./site-modules/shared/constants/calculator/events.js");function h(e){let t=e.detail;const a=t.value,s=t.calculatorType,i=t.field;r.a.fireTrackAction({event_type:"action_completed",event_data:{action_cause:"button_click",action_category:o.b.SYSTEM_ACTION_CATEGORY,action_name:o.b.ACTION_SHOW_CONTENT,creative_id:`edm-entry-${s}-payment-calculator`,subaction_name:o.b[`SHOW_${i}_LIMIT_ERROR`],value:a}})}a.d(t,"a",function(){return g});const g={init:e=>{let t=e.getState;r.a.on(u.a.CALCULATE_PAYMENT,e=>(function(e,t){let a=e.detail;const i=a.vin,c=a.type,d=a.creativeId,p=a.payments,u=a.limitCriteria,h=t(),g=n()(h,`inventory.vin.${i}`);r.a.fireTrackAction({event_type:"action_completed",event_data:Object(s.a)({action_name:o.b.CALCULATE_PAYMENT,subaction_name:c===l.h?o.b.EDIT_LOAN_PAYMENT:o.b.EDIT_LEASE_PAYMENT,action_category:o.b.SYSTEM_ACTION_CATEGORY,creative_id:d},m({payments:p,limitCriteria:u,inventory:g,type:c}))})})(e,t)),r.a.on(u.a.TRIGGER_LIMIT,h)}}},"./engagement-handlers/carousel-engagement-handler/carousel-engagement-handler.js":function(e,t,a){"use strict";a.d(t,"a",function(){return g});var s=a("../node_modules/@babel/runtime/helpers/esm/objectSpread.js"),i=a("../node_modules/lodash/get.js"),n=a.n(i),r=a("../node_modules/lodash/debounce.js"),o=a.n(r),l=a("../node_modules/@edmunds/react-dfp/lib/index.js"),c=a("./utils/event-toolbox.js"),d=a("./site-modules/shared/components/carousel/events.js"),p=a("./engagement-handlers/helper.js"),m=a("./actions/ads-refresh.js"),u=a("./site-modules/shared/components/ad-unit/utils/refresh-rules.js");const h="carousel";const g={init(e){let t=e.getState;c.a.on(d.a.SWIPE,function(e){const t=e.detail,a=t.target,i=t.data,n=void 0===i?{}:i,r=n.currentSlide,o=n.nextSlide,l=n.total,d=n.contentType,m=n.contentDetails,u=n.customEventData,h=void 0===u?{}:u,g=n.photoType,f=n.actionCause,b=a,E=b.querySelector(`.slick-slide[data-index="${o}"]`),y=E.querySelector("[data-carousel-tracking-value]"),v=E&&(y?y.innerText.toLowerCase():E.innerText.toLowerCase()),C=Object(p.c)(b),S=Object(s.a)({carousel_index:o+1,carousel_prev_index:r+1,carousel_total:l,value:v,creative_id:C,action_category:"user",action_name:`view_${d}`,subaction_name:`view_${m}`,action_cause:f||"swipe",photo_type:g},h);c.a.fireTrackAction({event_type:"action_completed",event_data:S})}),c.a.on(d.a.SWIPE,function(e,t){return o()(e=>{if(n()(e,"detail.data.noAdsRefresh")||!u.a.refreshOn.carousel.size||!Object(m.a)(h,t))return;const a=Array.from(u.a.refreshOn.carousel);l.DFPManager.refresh(...a)},e)}(500,t))}}},"./images/inline-svgs/edmunds-logo.jsx":function(e,t,a){"use strict";a.d(t,"a",function(){return n}),a.d(t,"b",function(){return r});var s=a("../node_modules/react/index.js"),i=a.n(s);const n=()=>i.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 117 78",width:117},i.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",fill:"#007EE5",d:"M62.2 59.5c-1.3 0.2-2.5 0.4-3.7 0.4 -1.2 0-2.5-0.2-3.7-0.4 -9-1.7-16-7.9-19-16 4.4 4.9 13 7.4 22.8 7.5 9.8-0.1 18.4-2.6 22.8-7.5C78.2 51.6 71.2 57.8 62.2 59.5L62.2 59.5zM28.2 17.5v5.7c0 0.6 0.2 1.2 0.6 1.8 -3.4 0.3-6.7 0.8-9.8 1.4 1.6-4.2 5.1-10.8 9.2-15 0.7-0.7 3.6-3.2 7.8-3.9C38.1 7.1 45.5 6 57 6h1.6 1.6c11.5 0 18.9 1.1 21 1.4 4.2 0.7 7.1 3.2 7.8 3.9 4.1 4.2 7.6 10.9 9.2 15 -6.5-1.4-14-1.9-22-2.1 -0.9 0-3.3-0.1-5.5-0.1h-2.2c-1.7 0-3.3 0-5 0h-4.9 -4.9c-1.7 0-3.4 0-5 0h-1.4c0.1-0.3 0.2-0.6 0.2-1v-5.7c0-1.9-2-3.5-4.4-3.5H32.6C30.2 14 28.2 15.5 28.2 17.5L28.2 17.5zM93.6 54.2c-3.4-0.3-6.1-3-6.4-6.4 -0.5-4.5 3.4-8.3 7.9-7.8 3.4 0.3 6.1 3 6.4 6.4C102 50.9 98.2 54.6 93.6 54.2L93.6 54.2zM22 54.2c-3.4-0.3-6.1-3-6.4-6.4 -0.5-4.5 3.4-8.3 7.9-7.8 3.4 0.3 6.1 3 6.4 6.4C30.4 50.9 26.6 54.6 22 54.2L22 54.2zM116.9 22.2c0-1.7-1.5-2.9-3.2-2.9l-6.7 0.2c-1.5 0-2.7 1.2-2.9 2.6 0 0.3-0.1 0.7-0.2 1l-0.8-1.5c-2.7-5-6.5-11-10.2-14.8h0c0 0-3.3-4-9.9-5.3 0 0 0 0 0 0C77.2 0.3 67.8-0.1 58.6 0 49.4-0.1 40 0.3 34.2 1.5c0 0 0 0 0 0 -6.6 1.3-9.9 5.3-9.9 5.3h0c-3.8 3.8-7.5 9.8-10.2 14.8l-0.8 1.7c-0.1-0.4-0.2-0.8-0.3-1.2 -0.2-1.4-1.4-2.6-2.9-2.6l-6.7-0.2c-1.7 0-3.1 1.2-3.2 2.9L0 25.5c0 1.7 1.3 3.1 2.9 3.1l7.1 0.8 0.1-0.1c-0.1 0.1-0.1 0.2-0.1 0.3 -2.4 2.7-3.8 5.8-4.2 8.3C5 40.5 4.6 43.8 4.6 48.1c0 6.1 1.7 14.4 2.1 18.4v6c0 3 2.5 5.4 5.5 5.4h7.5c3 0 5.5-2.4 5.5-5.4v-4.5c7.8-0.7 20.6-1 33.4-1 12.8 0 25.6 0.3 33.4 1v4.5c0 3 2.5 5.4 5.5 5.4h7.5c3 0 5.5-2.4 5.5-5.4v-6c0.4-4 2.1-12.4 2.1-18.4 0-9.4-3.5-16.1-5.4-18.5 0-0.1-0.1-0.1-0.1-0.2l7-0.8c1.7 0 3-1.5 2.9-3.1L116.9 22.2zM84.5 10h-11C71 10 69 11.7 69 13.7v6.1c0 0.4 0 0.8 0.2 1.2 2.3-2.8 5.9-4.7 9.8-4.7 2.9 0 7.5 1.8 9.8 4.6 0.1-0.3 0.2-0.7 0.2-1.1v-6.1C89 11.7 87 10 84.5 10"})),r=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return i.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 63 78",width:63,className:e},i.a.createElement("path",{fill:"#007EE5",d:"M62.8 59.4c-0.2 0-0.4 0.1-0.6 0.1 -1.3 0.2-2.5 0.4-3.7 0.4s-2.5-0.2-3.7-0.4c-9-1.7-16-7.9-19-16 4.4 4.9 13 7.4 22.8 7.5 1.4 0 2.9-0.1 4.2-0.2V24.1h-4.2 -4.9c-1.7 0-3.4 0-5 0h-1.4c0.1-0.3 0.2-0.6 0.2-1v-5.7c0-1.9-2-3.5-4.4-3.5H32.6c-2.4 0.1-4.4 1.6-4.4 3.6v5.7c0 0.6 0.2 1.2 0.6 1.8 -3.4 0.3-6.7 0.8-9.8 1.4 1.6-4.2 5.1-10.8 9.2-15 0.7-0.7 3.6-3.2 7.8-3.9C38.1 7.1 45.5 6 57 6h1.6 1.6c0.9 0 1.8 0 2.6 0V0c-1.4 0-2.8 0-4.2 0C49.4-0.1 40 0.3 34.2 1.5c-6.6 1.3-9.9 5.3-9.9 5.3 -3.8 3.8-7.5 9.8-10.2 14.8l-0.8 1.7c-0.1-0.4-0.2-0.8-0.3-1.2 -0.2-1.4-1.4-2.6-2.9-2.6l-6.7-0.2c-1.7 0-3.1 1.2-3.2 2.9L0 25.5c0 1.7 1.3 3.1 2.9 3.1l7.1 0.8 0.1-0.1C10 29.4 10 29.5 10 29.6c-2.4 2.7-3.8 5.8-4.2 8.3C5 40.5 4.6 43.8 4.6 48.1c0 6.1 1.7 14.4 2.1 18.4v6c0 3 2.5 5.4 5.5 5.4h7.5c3 0 5.5-2.4 5.5-5.4V68c7.8-0.7 20.6-1 33.4-1 1.4 0 2.8 0 4.2 0V59.4zM22 54.2c-3.4-0.3-6.1-3-6.4-6.4 -0.5-4.5 3.4-8.3 7.9-7.8 3.4 0.3 6.1 3 6.4 6.4C30.4 50.9 26.6 54.6 22 54.2z"}))}},"./images/kbb-logo/KBB_logo.svg":function(e,t,a){e.exports=a.p+"628baf0ba00bf2469d16952ddaa8b781.svg"},"./images/kbb-logo/KBB_logo_darkmode.svg":function(e,t,a){e.exports=a.p+"39d2653925caefd09c2375442985a15f.svg"},"./images/vin-masked-asset.svg":function(e,t,a){e.exports=a.p+"fbd2f729d34f5ffa10053fa1af18c50f.svg"},"./site-modules/inventory/components/digital-retail-entry/digital-retail-entry.scss":function(e,t,a){},"./site-modules/inventory/components/vdp-calculator/vdp-payment-calculator.jsx":function(e,t,a){"use strict";a.r(t);var s=a("../node_modules/@babel/runtime/helpers/esm/extends.js"),i=a("../node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js"),n=a("../node_modules/lodash/noop.js"),r=a.n(n),o=a("../node_modules/lodash/find.js"),l=a.n(o),c=a("../node_modules/lodash/compact.js"),d=a.n(c),p=a("../node_modules/lodash/get.js"),m=a.n(p),u=a("../node_modules/react/index.js"),h=a.n(u),g=a("../node_modules/react-redux/es/index.js"),f=a("../node_modules/prop-types/index.js"),b=a.n(f),E=a("./data/luckdragon/redux/react-binding.jsx"),y=a("./data/models/inventory.js"),v=a("./data/models/visitor.js"),C=a("./data/models/incentives.js"),S=a("./site-modules/shared/components/content-section/content-section.jsx"),T=a("./site-modules/shared/components/inventory/invoke-action/invoke-action.jsx"),I=a("./site-modules/shared/components/calculator/payment-calculator/payment-calculator.jsx"),_=a("./site-modules/shared/utils/inventory-utils/is-new.js"),N=a("./site-modules/shared/constants/calculator/calculator.js"),O=a("./site-modules/shared/utils/calculator/loan-helper.js"),P=a("./utils/event-toolbox.js"),A=a("./site-modules/inventory/components/utils/lead-form-ctas.js"),x=a("./site-modules/shared/constants/inventory/page-events.js"),k=a("./data/models/dealer-info.js"),V=(a("../node_modules/core-js/modules/es6.regexp.match.js"),a("../node_modules/lodash/capitalize.js")),w=a.n(V);const j={"carmax.com":"CarMax.com"};var R=a("./site-modules/shared/utils/car-buying/cbp-link-util.js"),M=a("./site-modules/shared/utils/inventory/contact-options.js"),D=a("./site-modules/shared/components/appraisal/appraisal-tabs-container/appraisal-tabs-container.jsx"),L=a("./engagement-handlers/inventory-engagement-handler/constants.js"),F=a("./site-modules/shared/utils/dealer-details-utils.js"),U=a("./data/models/page.js"),q=a("./data/models/version.js"),z=a("./site-modules/shared/components/logos/carmax-logo.jsx"),B=a("../node_modules/classnames/index.js"),$=a.n(B),Y=a("../node_modules/reactstrap/lib/Card.js"),H=a.n(Y),Z=a("../node_modules/reactstrap/lib/Button.js"),G=a.n(Z);a("./site-modules/inventory/components/digital-retail-entry/digital-retail-entry.scss");const W=[{title:"Customize Your Terms",description:"See Incentives, Taxes & Fees"},{title:"Prequalify",description:"With no impact to your credit score"},{title:"Send to Dealer",description:"Save time and know before you go"}];function Q(e){let t=e.link,a=e.isPurchase,s=e.isMobile;if(!t)return null;return h.a.createElement(u.Fragment,null,h.a.createElement("hr",{className:"mt-1_5 mb-2"}),h.a.createElement("div",{className:"digital-retail-entry-container"},h.a.createElement("div",{className:"mb-0_75 heading-4 font-weight-medium"},"Start your deal from home"),h.a.createElement(H.a,{className:$()({"flex-row":!s})},h.a.createElement("div",{className:"blue-block"}),h.a.createElement("div",{className:"px-0_75 px-md-1_5 py-1_5 py-md-1 w-100"},h.a.createElement("ul",{className:"steps d-flex flex-row p-0 m-0 justify-content-between mb-2 mb-md-0"},W.map((e,t)=>h.a.createElement("li",{key:`${t+1}_step`,className:"step d-flex flex-column align-items-start pos-r w-100"},h.a.createElement("div",{className:$()("step-index  d-flex align-items-center justify-content-center font-weight-bold",{"text-white bg-primary":s,"bg-white text-primary":!s})},t+1),h.a.createElement("div",{className:"step-info"},h.a.createElement("div",{className:"font-weight-bold mt-1 mt-md-0_5"},e.title),h.a.createElement("div",{className:"small description"},e.description))))),h.a.createElement(G.a,{className:"text-capitalize text-primary-darker font-weight-normal py-0_5 get-started-btn",size:"md",color:"primary",outline:!0,href:t,target:"_blank",onClick:()=>{P.a.fireCustomEvent(x.a.DIGITAL_RETAIL_ENTRY_OPEN_TED,{isPurchase:a})}},"Get Started")))))}Q.propTypes={link:b.a.string,isPurchase:b.a.bool,isMobile:b.a.bool},Q.defaultProps={link:null,isPurchase:!1,isMobile:!1};a("./site-modules/inventory/components/vdp-calculator/vdp-payment-calculator.scss");a.d(t,"VdpPaymentCalculatorUI",function(){return K}),a.d(t,"mapStateToProps",function(){return X}),a.d(t,"stateToPropsConfig",function(){return J}),a.d(t,"VdpPaymentCalculator",function(){return ee});class K extends u.Component{constructor(){super(...arguments),this.state={userZipCode:null,skipGetThisDealBtnSubCopy:!1},this.setZipToStorage=(e=>this.props.setModelValue("location",v.c,{zipCode:e}).then(()=>this.updateZipCode(e)).catch(()=>{this.updateZipCode(this.props.visitorZipCode)})),this.getCreditScoreText=((e,t,a)=>{if(e===N.g)return"Credit Score: Excellent 750 - 850";const s=Object(O.c)({apr:t,defaultApr:a});return`Credit Score: ${s} ${l()(N.k,{name:s}).rate}`}),this.getGetThisDealBtn=(e=>{let t=e.classes,a=void 0===t?"":t,n=e.openedForm,r=void 0===n?"pricing":n,o=Object(i.a)(e,["classes","openedForm"]);return h.a.createElement(T.a,Object(s.a)({icon:"icon-calculator",iconClassName:"heading-5 mb-0 mr-1",secondaryText:this.state.skipGetThisDealBtnSubCopy?"":"Send these terms to the dealer before you visit",secondaryTextClassName:"label font-weight-normal mb-0",primaryText:N.Q,primaryTextClassName:"display-lg mb-0 text-primary-darker action-title",arrowClassName:"display-lg text-primary-darker",dataTrackingId:`view_${r}_details`,dataTrackingValue:"get_this_deal",classes:`d-flex justify-content-between align-items-center mt-0_5 action-element font-weight-normal px-0_75 px-md-1 ${a}`},o))}),this.openLeadForm=(()=>{this.props.isCarcodeChatAvailable&&!this.props.isMobile||P.a.fireCustomEvent(x.a.OPEN_LEAD_FORM)}),this.generateCarCodeText=(()=>{const e=this.props,t=e.payments,a=e.openedForm,s=t[a];if(!s)return"";const i=s.monthlyPayment,n=s.term,r=s.numberOfMonths,o=s.tradeIn,l=s.downPayment,c=s.financeRate,p=s.defaultFinanceRate,m=n||r,u=d()([m&&`Term: ${m} mos`,o&&`Trade-In Value: $${o}`,l&&`Down Payment: $${l}`,this.getCreditScoreText(a,c,p),a===N.h&&c&&`Interest rate: ${c}%`]).join(", ");return i?`I'm interested in a ${a} payment of $${i} per month (${u})`:""}),this.updateZipCode=(e=>{this.setState({userZipCode:e})}),this.updateGetThisDealBtn=(e=>{this.setState({skipGetThisDealBtnSubCopy:e}),this.props.onLeadFormSubmitMethodUpdate(e)})}get zipCode(){return"string"==typeof this.state.userZipCode?this.state.userZipCode:this.props.visitorZipCode}get isDigitalRetailLeaseAvailable(){const e=this.props,t=e.openedForm,a=e.vinData;return Object(M.c)({showLease:t===N.g,ctas:m()(a,"computedDisplayInfo.ctas",[])})}render(){const e=this.props,t=e.vinData,a=e.isCarcodeChatAvailable,i=e.onPaymentsUpdate,n=e.onCalculatorToggle,r=e.dealerInfo,o=e.setModelValue,l=e.primaryIncentiveAmount,c=e.conditionalIncentiveAmount,d=e.isNonTMVDealer,p=e.price,g=e.openedForm,f=e.isOnlineEligible,b=e.useBestPaymentService,E=e.isMobile,y=e.radius,v=this.state.skipGetThisDealBtnSubCopy,C=t.vin,O=t.type,P=t.computedDisplayInfo,x=m()(t,"prices.displayPrice"),k=m()(t,"prices.tmv"),V=m()(t,"prices.estimateLeasePromise.capCost"),M=m()(t,"prices.estimateLeasePromise.endDate"),U=m()(t,"vehicleInfo.styleInfo.year"),q=m()(t,"vehicleInfo.styleInfo.styleId"),B=m()(t,"vehicleInfo.mileage"),$=Object(_.a)(O)?k||x:m()(t,"computedDisplayInfo.priceValidation.listPriceEstimate",x),Y=m()(t,"prices.docFee",null);if(!p)return null;const H={price:p,leasePrice:d?x:V,leasePromiseEndDate:M,type:O,year:U,vin:C,taxesAndFeesZipCode:this.zipCode,styleId:q,marketValue:$,primaryIncentiveAmount:l,conditionalIncentiveAmount:c,docFee:Y,mileage:B,tmv:k},Z=!!P&&P.ctas||[],G=Object(A.a)(Z)||a,W=m()(r,"sellYourCarUrl"),K=function(e){if(!e)return null;const t=e.match(/^https?:\/\/(?:www\.)?([a-z0-9]+\.com).*$/i),a=t&&t[1]||"";return j[a]||w()(a)}(W),X=m()(t,L.b.PARENT_DEALERSHIP_NAME,""),J=Object(F.g)(X),ee=!d&&f&&!v,te=W&&K&&h.a.createElement(T.a,{icon:"icon-price-tags2",arrowIcon:"icon-open_in_new",iconClassName:"heading-5 mb-0 mr-1",arrowClassName:"medium",primaryColor:"text-primary-darker",primaryText:`Sell your car on ${K}`,primaryTextClassName:"mb-0 action-title",dataTrackingId:"sell_your_car_clickout","data-allow-bubbling":"true",href:W,classes:"d-flex justify-content-between align-items-center mt-0_5 action-element px-0_75 px-md-1",newTab:!0}),ae=h.a.createElement("div",{className:"carmax-container rounded mt-1","data-tracking-parent":"edm-entry-partner-offer"},h.a.createElement("div",{className:"px-1 px-md-1_5"},h.a.createElement("div",{className:"mb-1 mb-md-2 pt-2"},h.a.createElement(z.a,{className:"partner-logo-lg"})),h.a.createElement("div",{className:"heading-4 mb-0_5"},"Get a CarMax offer on your car today"),h.a.createElement("div",{className:"size-14"},"Interested in buying a car at CarMax? Before you go, get a real CarMax offer on your car to trade-in!")),h.a.createElement(D.a,{isLicensePlateTabDefault:!0,ctaText:"Get Started",className:"vdp-appraisal-tabs-container mb-0_5 mt-0_5 mt-md-0",isMobile:E,isVdpEmbedded:!0}));return h.a.createElement(S.a,{className:"vdp-payment-calculator",sectionTitle:"Payment Calculator",dataTrackingParent:"edm-entry-payment-calculator",titleClassName:"section-title heading-4 mb-1_5"},h.a.createElement(I.a,Object(s.a)({},this.props,{onPaymentsUpdate:i,onCalculatorToggle:n,payments:H,wrapperClasses:"bg-gray-extra-light p-0",calculationClasses:"m-0",toggleBtnGroupClasses:"mx-0",sellYourCarConfig:{sellYourCarUrl:W,dealerDomainName:K},setModelValue:o,setZipToStorage:this.setZipToStorage,dealerZipCode:m()(t,"dealerInfo.address.zip",""),isLoanTaxesAndFeesEnabled:!0,isNonTMVDealer:d,openedForm:g,useBestPaymentService:b,updateGetThisDealBtn:this.updateGetThisDealBtn})),ee?h.a.createElement(u.Fragment,null,J?ae:te,h.a.createElement(Q,{link:Object(R.a)(C,this.isDigitalRetailLeaseAvailable,"",{radius:y}),isPurchase:g===N.h,isMobile:E})):h.a.createElement(u.Fragment,null,G&&this.getGetThisDealBtn({onClick:this.openLeadForm,"data-text":this.generateCarCodeText(),"data-allow-bubbling":!0,"data-widget":"sms",classes:"sms-button"}),J?ae:te))}}K.propTypes={vinData:y.b.InventoryVin,isCarcodeChatAvailable:b.a.bool,onPaymentsUpdate:b.a.func.isRequired,onCalculatorToggle:b.a.func.isRequired,payments:b.a.shape({}),openedForm:b.a.string,dealerInfo:k.a.DealerInfo,setModelValue:b.a.func.isRequired,baseAPR:b.a.number,baseTermMonths:b.a.number,primaryIncentiveAmount:b.a.number,conditionalIncentiveAmount:b.a.number,baseCreditScore:b.a.string,appliedIncentives:b.a.oneOfType([b.a.arrayOf(C.b.Incentive),b.a.arrayOf(y.b.Incentive)]),visitorZipCode:b.a.string,isNonTMVDealer:b.a.bool,price:b.a.number,unselectFinancingPromotions:b.a.func,isOnlineEligible:b.a.bool,useBestPaymentService:b.a.bool,isMobile:b.a.bool,venomVersion:b.a.string,pageName:b.a.string,onLeadFormSubmitMethodUpdate:b.a.func,radius:b.a.number},K.defaultProps={vinData:{},payments:{},openedForm:"",isCarcodeChatAvailable:!1,dealerInfo:{},baseAPR:null,baseTermMonths:null,baseCreditScore:null,appliedIncentives:[],visitorZipCode:"",primaryIncentiveAmount:0,conditionalIncentiveAmount:0,isNonTMVDealer:!1,price:null,unselectFinancingPromotions:null,isOnlineEligible:!1,useBestPaymentService:!1,isMobile:!1,venomVersion:"",pageName:"",onLeadFormSubmitMethodUpdate:r.a,radius:null};const X=e=>({isMobile:e.mobile}),J={dealerInfo:Object(E.a)(e=>{let t=e.vinData;return Object(k.c)(t)},k.b),visitorZipCode:Object(E.a)("location.zipCode",v.c),pageName:Object(E.a)("page.name",U.a),venomVersion:Object(E.a)("version",q.a)},ee=Object(g.c)(X)(Object(E.b)(K,J))},"./site-modules/inventory/components/vdp-calculator/vdp-payment-calculator.scss":function(e,t,a){},"./site-modules/shared/components/appraisal/appraisal-partner-offer-value-props/appraisal-partner-offer-value-props.scss":function(e,t,a){},"./site-modules/shared/components/appraisal/appraisal-report-price-title/appraisal-report-price-title.scss":function(e,t,a){},"./site-modules/shared/components/appraisal/appraisal-report-toggle-btn/appraisal-report-toggle-btn.scss":function(e,t,a){},"./site-modules/shared/components/appraisal/appraisal-tabs-container/appraisal-tabs-container.scss":function(e,t,a){},"./site-modules/shared/components/appraisal/appraisal-tabs/license-plate-tab-content/license-plate-tab-content.scss":function(e,t,a){},"./site-modules/shared/components/appraisal/trade-in-appraiser-steps/appraisal-report-step-extended/appraisal-report-extended-detailed.scss":function(e,t,a){},"./site-modules/shared/components/appraisal/trade-in-appraiser-steps/appraisal-report-step/appraisal-report-error-message.scss":function(e,t,a){},"./site-modules/shared/components/appraisal/trade-in-appraiser-steps/appraisal-report-step/appraisal-report-step-bar-chart.scss":function(e,t,a){},"./site-modules/shared/components/appraisal/trade-in-appraiser-steps/appraisal-report-step/appraisal-report-step-condition-dropdown.scss":function(e,t,a){},"./site-modules/shared/components/appraisal/trade-in-appraiser-steps/appraisal-report-step/appraisal-report-step-head.scss":function(e,t,a){},"./site-modules/shared/components/appraisal/trade-in-appraiser-steps/appraisal-report-step/appraisal-report-step-user-testimonials.scss":function(e,t,a){},"./site-modules/shared/components/appraisal/trade-in-appraiser-steps/appraisal-report-step/appraisal-report-step.scss":function(e,t,a){},"./site-modules/shared/components/appraisal/trade-in-appraiser-steps/colors-and-options-step/colors-and-options-step.scss":function(e,t,a){},"./site-modules/shared/components/appraisal/trade-in-appraiser-steps/condition-and-mileage-step/condition-and-mileage-step.scss":function(e,t,a){},"./site-modules/shared/components/appraisal/trade-in-appraiser-steps/epo-processing/epo-processing.scss":function(e,t,a){},"./site-modules/shared/components/appraisal/trade-in-appraiser-steps/instant-offer-step/dealer-locator/dealer-locator.scss":function(e,t,a){},"./site-modules/shared/components/appraisal/trade-in-appraiser-steps/instant-offer-step/instant-offer-partner-offer/instant-offer-partner-offer.scss":function(e,t,a){},"./site-modules/shared/components/appraisal/trade-in-appraiser-steps/instant-offer-step/instant-offer-send-to-phone/instant-offer-send-to-phone.scss":function(e,t,a){},"./site-modules/shared/components/appraisal/trade-in-appraiser-steps/instant-offer-step/instant-offer-step.scss":function(e,t,a){},"./site-modules/shared/components/appraisal/trade-in-appraiser-steps/instant-offer-step/multi-offer-cards/multi-offer-cards.scss":function(e,t,a){},"./site-modules/shared/components/appraisal/trade-in-appraiser-steps/instant-offer-step/nearest-stores/nearest-stores.scss":function(e,t,a){},"./site-modules/shared/components/appraisal/trade-in-appraiser-steps/instant-offer-step/offer-overlay/offer-overlay.scss":function(e,t,a){},"./site-modules/shared/components/appraisal/trade-in-appraiser-steps/instant-offer-step/schedule-appointment-drawer/schedule-appointment.scss":function(e,t,a){},"./site-modules/shared/components/appraisal/trade-in-appraiser-steps/license-plate-and-vin-step/epo-vin-tab-content.scss":function(e,t,a){},"./site-modules/shared/components/appraisal/trade-in-appraiser-steps/license-plate-and-vin-step/license-plate-and-vin-step.scss":function(e,t,a){},"./site-modules/shared/components/appraisal/trade-in-appraiser-steps/location-and-style-step/location-and-style-step.scss":function(e,t,a){},"./site-modules/shared/components/appraisal/trade-in-appraiser-steps/offer-conditions-step/checkbox-list/checkbox-list.scss":function(e,t,a){},"./site-modules/shared/components/appraisal/trade-in-appraiser-steps/offer-conditions-step/offer-conditions-step.scss":function(e,t,a){},"./site-modules/shared/components/appraisal/trade-in-appraiser-steps/offer-conditions-step/radio-group/radio-group.scss":function(e,t,a){},"./site-modules/shared/components/appraisal/trade-in-appraiser/trade-in-appraiser-async.jsx":function(e,t,a){"use strict";a.d(t,"a",function(){return i});var s=a("./site-modules/shared/components/lazy-load/lazy-load.jsx");const i=Object(s.a)({loader:()=>Promise.all([a.e(4),a.e(5),a.e(16),a.e(17),a.e(19),a.e(24),a.e(6),a.e(13),a.e(26),a.e("trade-in-appraiser")]).then(a.bind(null,"./site-modules/shared/components/appraisal/trade-in-appraiser/trade-in-appraiser.jsx")),componentName:"TradeInAppraiser"})},"./site-modules/shared/components/appraisal/trade-in-appraiser/trade-in-appraiser-drawer.jsx":function(e,t,a){"use strict";a.d(t,"a",function(){return u});var s=a("../node_modules/react/index.js"),i=a.n(s),n=a("../node_modules/prop-types/index.js"),r=a.n(n),o=a("../node_modules/reactstrap/lib/Container.js"),l=a.n(o),c=a("./site-modules/shared/components/drawer/drawer.jsx"),d=a("./site-modules/shared/components/drawer/drawer-close-button/drawer-close-button.jsx"),p=a("./data/models/dealer-info.js"),m=a("./site-modules/shared/components/appraisal/trade-in-appraiser/trade-in-appraiser-async.jsx");class u extends s.Component{constructor(){super(...arguments),this.state={isDrawerComponentLoaded:!1}}static getDerivedStateFromProps(e,t){return e.isOpen&&!t.isDrawerComponentLoaded?{isDrawerComponentLoaded:!0}:null}render(){const e=this.props,t=e.isOpen,a=e.onToggle,s=e.onTradeInUpdate,n=e.onVehicleUpdate,r=e.trackingParent,o=e.sellYourCarConfig,p=e.anonymousSignInCreativeId,u=e.drawerClassNames,h=e.isPurchase,g=e.sellingPrice,f=e.msrp,b=e.residualValue,E=e.isUsed,y=e.dataTest,v=this.state.isDrawerComponentLoaded;return i.a.createElement(c.a,{side:"right","data-tracking-parent":r,classNames:{drawerContent:"px-0_5",drawer:u},toggle:a,isOpen:t,"data-test":y},i.a.createElement(d.a,{onClick:a,className:"mb-0 mb-md-2_5 d-block px-md-2 px-lg-3_5 text-right text-md-left",lgBtnClass:"pl-0",smBtnClass:"d-inline-block",trackingId:"close_report",trackingValue:"x upper right"}),v&&i.a.createElement(l.a,{className:"mx-0 px-0"},i.a.createElement(m.a,{onDone:a,onTradeInUpdate:s,onVehicleUpdate:n,className:"px-1 px-md-2 px-lg-3_5",sellYourCarConfig:o,anonymousSignInCreativeId:p,isPurchase:h,sellingPrice:g,msrp:f,residualValue:b,isUsed:E,drawerCreativeId:r})))}}u.propTypes={isOpen:r.a.bool.isRequired,onToggle:r.a.func.isRequired,onTradeInUpdate:r.a.func,onVehicleUpdate:r.a.func,trackingParent:r.a.string.isRequired,anonymousSignInCreativeId:r.a.string,sellYourCarConfig:p.e,drawerClassNames:r.a.string,isPurchase:r.a.bool,sellingPrice:r.a.number,msrp:r.a.number,residualValue:r.a.number,isUsed:r.a.bool,dataTest:r.a.string},u.defaultProps={onTradeInUpdate:null,onVehicleUpdate:null,sellYourCarConfig:{},anonymousSignInCreativeId:void 0,drawerClassNames:null,isPurchase:!1,sellingPrice:0,msrp:0,residualValue:0,isUsed:!1,dataTest:""}},"./site-modules/shared/components/appraisal/trade-in-appraiser/trade-in-appraiser.jsx":function(e,t,a){"use strict";a.r(t);var s=a("../node_modules/@babel/runtime/helpers/esm/extends.js"),i=a("../node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),n=(a("../node_modules/core-js/modules/es6.regexp.split.js"),a("../node_modules/core-js/modules/es6.regexp.to-string.js"),a("../node_modules/@babel/runtime/helpers/esm/objectSpread.js")),r=a("../node_modules/lodash/pickBy.js"),o=a.n(r),l=a("../node_modules/lodash/isNil.js"),c=a.n(l),d=a("../node_modules/lodash/uniq.js"),p=a.n(d),m=a("../node_modules/lodash/isEqual.js"),u=a.n(m),h=a("../node_modules/lodash/isNull.js"),g=a.n(h),f=a("../node_modules/lodash/noop.js"),b=a.n(f),E=a("../node_modules/lodash/has.js"),y=a.n(E),v=a("../node_modules/lodash/isEmpty.js"),C=a.n(v),S=a("../node_modules/lodash/get.js"),T=a.n(S),I=a("../node_modules/lodash/debounce.js"),_=a.n(I),N=a("../node_modules/lodash/includes.js"),O=a.n(N),P=a("../node_modules/lodash/findIndex.js"),A=a.n(P),x=a("../node_modules/react/index.js"),k=a.n(x),V=a("../node_modules/prop-types/index.js"),w=a.n(V),j=a("../node_modules/uuid/v4.js"),R=a.n(j),M=a("../node_modules/uuid/v5.js"),D=a.n(M),L=a("../node_modules/reactstrap/lib/Row.js"),F=a.n(L),U=a("../node_modules/reactstrap/lib/Col.js"),q=a.n(U),z=a("../node_modules/react-redux/es/index.js"),B=a("./utils/isomorphic-logger.js"),$=a("./data/luckdragon/redux/react-binding.jsx"),Y=a("./data/models/visitor.js"),H=a("./site-modules/shared/components/profile/insider-methods.jsx"),Z=a("./utils/experiment/experiment-util.js"),G=a("./site-modules/shared/constants/appraisal/appraisal.js"),W=a("./site-modules/shared/constants/car-buying/index.js"),Q=a("./site-modules/shared/utils/storage.js"),K=a("./configuration.js"),X=a("./site-modules/shared/constants/calculator/calculator.js"),J=a("./tracking/constant.js"),ee=a("./utils/event-toolbox.js"),te=a("./data/models/vehicle.js"),ae=a("./data/models/vehicle-vin.js"),se=a("./data/models/partner-offer-model.js"),ie=a("./site-modules/shared/components/profile/profile-screen.js"),ne=a("./engagement-handlers/profile-engagement-handler/profile-engagement-handler.js"),re=a("./actions/profile.js"),oe=a("./data/utils/marketo-service.js"),le=a("./data/models/dealer-info.js"),ce=a("./site-modules/shared/utils/appraiser/appraiser-validation-helper.js"),de=a("../node_modules/lodash/isEqualWith.js"),pe=a.n(de);const me=(e,t)=>{if(e&&t&&e.id&&t.id)return u()(e.id,t.id)};function ue(e,t){return pe()(e,t,me)}const he={300:{v1Key:"exterior--paint-body-work",v1ValueByV2AnswerId:{1:"0",2:"1",3:"2",4:"3"}},410:{v1Key:"interior--broken-parts",v1ValueByV2AnswerId:{1:"0",2:"1",3:"2",4:"3"}},420:{v1Key:"interior--fabric-issues",v1ValueByV2AnswerId:{1:"0",2:"1",3:"2",4:"3"}},500:{v1Key:"tires",v1ValueByV2AnswerId:{1:"0",2:"2",3:"4"}},600:{v1Key:"keys",v1ValueByV2AnswerId:{1:"2",2:"1"}},1000:{v1Key:"mechanical--odometer-untrusted",v1ValueByV2AnswerId:{1:"false",2:"true"}},110:{v1Key:"accidents--minor",v1ValueByV2AnswerId:{1:"0",2:"1",3:"2"}},120:{v1Key:"accidents--major",v1ValueByV2AnswerId:{1:"0",2:"1",3:"2"}},210:{v1Key:"mechanical--inoperable",v1ValueByV2AnswerId:{1:"false",2:"true"}},220:{v1Key:"mechanical--engine",v1ValueByV2AnswerId:{1:"false",2:"true"}},230:{v1Key:"mechanical--transmission",v1ValueByV2AnswerId:{1:"false",2:"true"}},710:{v1Key:"after-market--suspension",v1ValueByV2AnswerId:{1:"false",2:"true"}},720:{v1Key:"after-market--engine",v1ValueByV2AnswerId:{1:"false",2:"true"}},810:{v1Key:"other--convertible-top",v1ValueByV2AnswerId:{1:"false",2:"true"}},820:{v1Key:"other--air-conditioning",v1ValueByV2AnswerId:{1:"false",2:"true"}},830:{v1Key:"other--odor",v1ValueByV2AnswerId:{1:"false",2:"true"}},840:{v1Key:"other--missing-standard-equipment",v1ValueByV2AnswerId:{1:"false",2:"true"}},910:{v1Key:"frame-damage",v1ValueByV2AnswerId:{1:"false",2:"true"}},920:{v1Key:"flood-damage",v1ValueByV2AnswerId:{1:"false",2:"true"}},240:[{v1Key:"mechanical--check-engine-light",v1ValueByV2AnswerId:{1:"true"}},{v1Key:"mechanical--4x4-service",v1ValueByV2AnswerId:{2:"true"}},{v1Key:"mechanical--check-brakes-light",v1ValueByV2AnswerId:{3:"true"}},{v1Key:"mechanical--other-warning-light",v1ValueByV2AnswerId:{4:"true"}}],251:[{v1Key:"mechanical--brakes",v1ValueByV2AnswerId:{1:"true"}},{v1Key:"mechanical--steering",v1ValueByV2AnswerId:{2:"true"}},{v1Key:"mechanical--suspension",v1ValueByV2AnswerId:{3:"true"}},{v1Key:"mechanical--other",v1ValueByV2AnswerId:{4:"true"}}]};var ge=a("./site-modules/shared/components/profile/attributes/financing.js"),fe=a("./tracking/handler.js"),be=a("./engagement-handlers/helper.js"),Ee=a("./utils/location.js"),ye=a("./utils/session-recorder/session-recorder.js"),ve=a("./site-modules/shared/utils/location.js"),Ce=a("../node_modules/lodash/set.js"),Se=a.n(Ce);const Te=e=>{const t={};return Object.keys(e).forEach(a=>{t[a.toLowerCase()]=T()(e,`${a}.Current.totalWithOptions.usedTradeIn`)}),t},Ie=e=>{const t=e||{},a=t.usedTradeIn,s=t.usedPrivateParty,i=t.usedTmvRetail;return a||s||i?{[G.kb]:a,[G.Z]:s,[G.s]:i}:{}},_e=(e,t,a)=>{const s=e.toUpperCase(),i=T()(t,`${s}.Current.nationalBasePrice`),n=T()(t,`${s}.Current.regionalAdjustment`),r=T()(t,`${s}.Current.totalWithOptions`),o=T()(t,`${s}.Current.mileageAdjustment`),l=T()(t,`${s}.Current.colorAdjustment`),c=T()(t,`${s}.Current.optionTMVPrices`,{}),d=T()(t,`${s}.Current.conditionAdjustment`),p=T()(t,`${s}.Current.certifiedUsedPrice`);return{nationalPrices:Ie(i),regionalPrices:Ie(n),totalPrices:Ie(r),mileagePrices:Ie(o),colorPrices:Ie(l),optionalPrices:Ie((e=>G.Y.reduce((t,a)=>{const s=e.reduce((e,t)=>e+T()(t,`${a}`,0),0);return Se()(t,a,s)},{}))(Object.values(c))),optionalPricesValues:a&&a.map(e=>{let t=e.id;return{id:t,name:e.name,price:Ie(c[t])}}),conditionPrices:Ie(d),conditionPricing:Te(t),certifiedUsedPrice:Ie(p)}},Ne=(e,t)=>{const a={};return Object.keys(e).forEach(s=>{a[s.toLowerCase()]=_e(s,e,t)}),a},Oe=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t={};return Object.keys(e).forEach(a=>{t[a]=e[a]&&e[a].totalPrices}),t};var Pe=a("./site-modules/shared/components/profile/smart-sign/constants.js"),Ae=a("./site-modules/shared/components/experiment/index.jsx"),xe=a("./utils/bootstrap.js"),ke=a("./site-modules/shared/components/rating-stars/rating-stars.jsx"),Ve=a("./site-modules/shared/components/carousel/carousel.jsx"),we=a("./data/models/cms.js"),je=a("./data/cms/content.js"),Re=a("../node_modules/classnames/index.js"),Me=a.n(Re);a("./site-modules/shared/components/appraisal/trade-in-appraiser-steps/appraisal-report-step/appraisal-report-step-user-testimonials.scss");const De=[{breakpoint:xe.a.sm,settings:{slidesToShow:1,slidesToScroll:1}},{breakpoint:xe.a.lg,settings:{slidesToShow:3,slidesToScroll:3}}],Le={slidesToShow:1},Fe={slidesToShow:3,slidesToScroll:3};class Ue extends x.PureComponent{constructor(){super(...arguments),this.state={inViewPort:!1},this.isInViewport=(e=>{if(!e)return!1;const t=e.getBoundingClientRect();return t.top>=0&&t.top<=e.clientHeight}),this.fireWidgetView=(()=>{const e=this.isInViewport(document.querySelector(".appraisal-report-step-user-testimonials"));e&&!this.state.inViewPort&&ee.a.fireTrackAction({event_type:J.b.ACTION_WIDGET_VIEW,event_data:{action_cause:J.b.ACTION_CAUSE_SCROLL,creative_id:"edm-entry-epo-testimonials"}}),this.setState({inViewPort:e})}),this.createUserTestimonialCard=(e=>{let t=e.testimonialTitle,a=e.testimonialText,s=e.starRating,i=e.date,n=e.name,r=e.location,o=e.verifiedSeller;return k.a.createElement("div",{className:"user-testimonial-card rounded d-flex flex-column justify-content-between text-gray-darker size-14 p-1"},k.a.createElement("div",null,k.a.createElement("div",{className:"testimonial-header heading-5 mb-0_5"},t),k.a.createElement(ke.a,{starClass:"text-primary-darker mr-0_25",rating:parseFloat(s)}),k.a.createElement("span",{className:"heading-6 ml-1_5"},parseFloat(s).toFixed(1)),k.a.createElement("div",{className:"mt-0_5 mb-0_75"},a)),k.a.createElement("div",{className:"user-info size-12"},k.a.createElement("span",null,n),o&&k.a.createElement("span",{className:"font-italic ml-0_5"},"Verified Seller"),k.a.createElement("div",null,r),k.a.createElement("div",{className:"testimonial-date"},i)))})}componentDidMount(){ee.a.on("scroll",this.fireWidgetView,!0)}componentWillUnmount(){ee.a.off("scroll",this.fireWidgetView,!0)}testimonialSlides(e){return e.map(e=>k.a.createElement("div",{className:"p-1 h-100",key:e.testimonialTitle},this.createUserTestimonialCard(e)))}render(){const e=this.props,t=e.isMobile,a=e.testimonials,i=e.className,n=t?Le:Fe,r=a.children().map(e=>e.getAllMetadata());return r.length?k.a.createElement("div",{"data-tracking-parent":"edm-entry-epo-testimonials",className:Me()("appraisal-report-step-user-testimonials",i)},k.a.createElement("div",{className:"heading-3 mb-0_75"},"What Our Customers Are Saying"),k.a.createElement("div",{className:"size-14 text-gray-darker mb-0_75"},"Join thousands of happy customers who redeemed a CarMax offer last month."),k.a.createElement("div",{className:"d-flex justify-content-center"},k.a.createElement("div",{className:"testimonial-carousel-container"},k.a.createElement(Ve.a,Object(s.a)({swipe:t,arrows:!t,infinite:!1,responsive:De,dots:!0,dotsClass:"slick-dots gray",speed:500,cssEase:"ease-in-out",className:"testimonial-carousel",customEventData:{subaction_name:"view_testimonial",action_cause:"link_click",value:""}},n),this.testimonialSlides(r))))):null}}Ue.propTypes={isMobile:w.a.bool,testimonials:we.a.Content,className:w.a.string},Ue.defaultProps={isMobile:!1,testimonials:je.a,className:""};const qe={testimonials:Object(we.d)("editorial/includes/carmax/testimonials","testimonials")},ze=Object($.b)(Ue,qe);var Be=a("../node_modules/lodash/startCase.js"),$e=a.n(Be),Ye=a("../node_modules/dateformat/lib/dateformat.js"),He=a.n(Ye),Ze=a("./utils/image-helpers.js"),Ge=a("./site-modules/shared/utils/vehicle-link-constructor.js"),We=a("./site-modules/shared/utils/price-utils.js"),Qe=a("./site-modules/shared/utils/string.js"),Ke=a("./utils/environment.js"),Xe=a("./site-modules/shared/components/form-validation/validation-async.js"),Je=a("./site-modules/shared/components/form-validation/validation.js");function et(e){const t=new Date;return e&&t.setDate(t.getDate()+e),t.toISOString()}const tt=e=>`#/vehicles/appraisalHistory/${e}`;function at(e,t,a,s){let i=e.vehicle,r=e.condition,o=e.mileage,l=e.options,c=e.color,d=e.zipCode,p=e.payoffAmount,m=e.isPartnerOfferEligible,u=e.isPartnerOfferEligibleVin,h=e.isActiveInventory,g=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;const f=i.style,b=f.year,E=f.id,y=f.name,v=f.makeName,C=f.modelName,S=f.makeNiceName,I=f.modelNiceName,_=f.submodels.slug,N=f.trimName,O=m&&!1!==u&&!h&&(null===g||g>0);return{vehicles:{appraisalHistory:{[t]:Object(n.a)({make:v,model:C,savedTs:et(),styleId:E,condition:r,options:function(e){return e.map(e=>({optionCode:e.id,optionName:e.name}))}(l),colors:{exterior:c.id},styleName:y,isTradeIn:!0,year:Number(b),mileage:Number(o),appraisalMakeNiceName:S,appraisalModelNiceName:I,appraisalSubmodel:_,appraisalTrim:N,postalCode:d,milesPerYear:function(e,t){const a=He()(Date.now(),"yyyy")-e;return a>0?parseInt(t/a,10):parseInt(t,10)}(b,o),tradeInValue:a[G.kb],dealerRetailValue:a[G.s],privatePartyValue:a[G.Z],offerEligibility:`${O}`,offerEligibilityExpiryTs:et(O?30:0),payoffAmount:p},function(e){const t={};return Object.keys(G.n).filter(e=>"DAMAGED"!==e).forEach(a=>{const s=G.n[a],i=s.toLowerCase();t[`${G.kb}Value${s}`]=T()(e,[i,G.kb]),t[`${G.Z}Value${s}`]=T()(e,[i,G.Z]),t[`${G.s}Value${s}`]=T()(e,[i,G.s])}),t}(s))},latestAppraisalRef:tt(t)}}}function st(e,t){return{[`${e}TradeIn`]:Object(Qe.c)(T()(t,"tradeIn",0)),[`${e}PrivateParty`]:Object(Qe.c)(T()(t,"privateParty",0)),[`${e}TmvRetail`]:Object(Qe.c)(T()(t,"dealerRetail",0))}}function it(e){let t=e.mileage,a=e.color.name,s=e.condition,r=e.zipCode,o=e.vehicle,l=e.appraisalEmailData,c=e.partnerOfferEmailData;const d=o.style,p=d.year,m=d.makeName,u=d.modelName,h=d.name,g=d.trimName,f=d.makeSlug,b=d.modelSlug,E=l.tmvConditions,y=l.colorPrices,v=l.conditionPrices,C=l.mileagePrices,S=l.nationalPrices,I=l.optionalPrices,_=l.regionalPrices,N=l.totalPrices,O=l.certifiedUsedPrice,P=l.vehiclePhoto,A=c||{},x=A.offerVin,k=A.offerCode,V=A.offerExpiredDate,w=A.offerExpiredTs,j=A.offerStoreName,R=A.offerStoreAddressLine1,M=A.offerStoreAddressLine2,D=A.redemptionCertificateUri,L=A.appointmentUri,F=`${Ke.a}${Object(Ge.h)({makeSlug:f,modelSlug:b,year:p})}`;return Object(n.a)({carImagePath:Object(Ze.k)(P,void 0,Ze.d.MEDIA)},(U=E,Object.entries(U).reduce((e,t)=>{let a=Object(i.a)(t,2),s=a[0],n=a[1];const r=T()(n,"Current.totalWithOptions",{}),o=r.usedTradeIn,l=r.usedPrivateParty,c=$e()(s.toLowerCase());return Se()(e,`${G.Z}${c}`,Object(We.c)(l)),Se()(e,`${G.kb}${c}`,Object(We.c)(o)),e},{})),st("colorAdj",y),st("condition",v),st("mileage",C),st("nationalBase",S),st("regional",_),st("totalOptional",I),st("total",N),{color:a,condition:s,selectedCondition:s.toLowerCase(),mileage:t,vehicleFullName:`${p} ${m} ${u} ${h}`,make:m,model:u,year:p,trim:g,certifiedUsedPrice:O,corePagePath:F,zip:r,redemptionCertificateUri:D,appointmentUri:L,offerValuation:Object(Qe.c)(T()(c,"offerValuation",0),0),offerVin:x,offerCode:k,offerExpiredDate:V,offerExpiredTs:w,offerStoreName:j,offerStoreAddressLine1:R,offerStoreAddressLine2:M});var U}const nt={email:{test:Je.a.validateEmail,asyncTest:(e,t)=>Xe.a.fetchEmailValidation(Object(n.a)({},e,{id:"insider"}),t),errorText:"Please enter a valid email address."}},rt=async e=>{let t=e.isAuthenticated,a=e.doesNotHaveEmail,s=e.isValid,i=e.emailField,n=e.updateIdmData,r=e.validateEmailAsync,o=e.fetchSignInMethodsForEmail,l=e.fireValidExistingEmailCustomEvent;const c=await r();if(!s||!c.isEmailValid)return;const d=(0,i.value)(),p=await o(d);if(t&&a&&p&&0===p.length){const e={identifiers:{email:[d]}};await n(e)}l(d)};function ot(e){let t=e.headerText,a=e.subHeaderText;return e.isExtendedReport?null:k.a.createElement(F.a,{className:"mb-2"},k.a.createElement(q.a,{xs:12,className:"text-gray-darker",name:G.hb},k.a.createElement("h2",{className:"mb-0"},t),k.a.createElement("div",{className:"font-weight-normal mb-0"},a)))}ot.propTypes={headerText:w.a.string,subHeaderText:w.a.string,isExtendedReport:w.a.bool},ot.defaultProps={headerText:"",subHeaderText:"",isExtendedReport:!1};var lt=a("../node_modules/reactstrap/lib/Button.js"),ct=a.n(lt),dt=a("../node_modules/reactstrap/lib/Collapse.js"),pt=a.n(dt),mt=a("../node_modules/reactstrap/lib/Form.js"),ut=a.n(mt),ht=a("../node_modules/react-scroll/lib/modules/index.js"),gt=a("./site-modules/shared/components/spinner/spinner.jsx");const ft=-48,bt=[G.ab,G.A,G.F];class Et extends x.Component{constructor(){super(...arguments),this.state={isLoaded:!1},this.setLoaded=(()=>this.setState({isLoaded:!0})),this.handleSubmit=(e=>{e.preventDefault(),e.stopPropagation()})}componentDidMount(){ee.a.domReady(this.setLoaded)}render(){const e=this.props,t=e.id,a=e.nextId,s=e.stepCounter,i=e.title,n=e.children,r=e.isActive,o=e.isDone,l=e.isFinal,c=e.hasTotalPayment,d=e.onDone,p=e.onSave,m=e.isExtendedReport,u=e.onContinue,h=e.trackingParentId,g=e.appliedTradeIn,f=e.predefinedVin,b=e.isQueryPredefinedVin,E=e.styleIds,y=e.isEscapeHatch,v=e.isLoadingColorsAndOptions,C=e.isMobile,S=this.state.isLoaded,T=l?!c:!o,I=o&&!r,_=!o,N=l&&r,O=Me()({secondary:T,success:!T}),P={"btn-secondary disabled":T,"btn-success":!T},A=k.a.createElement(q.a,{xs:12,md:7},k.a.createElement(ht.Button,{to:X.ib,type:"submit",value:`Apply ${Object(We.a)(g)} to my deal`,tabIndex:0,offset:ft,onClick:p,"data-tracking-id":G.i[t],color:O,className:Me()("with-vertical-top-line form-button pos-r d-block w-100 btn",P),smooth:!0})),V=k.a.createElement(q.a,{xs:12,md:5},k.a.createElement(ct.a,{color:"link",onClick:d,"data-tracking-id":"close_report","data-tracking-value":"close button",block:!0,className:"text-decoration-none text-center text-md-left pl-md-1 text-primary-darker"},"Close")),w=S?"Continue":"Loading...",j=k.a.createElement(q.a,{xs:12,md:4,className:"px-0"},k.a.createElement(ct.a,{type:"submit",onClick:u,"data-index":a,"data-tracking-id":G.i[t],color:"success",className:Me()("heading-5 text-white py-0_5 form-button text-transform-none pos-r d-block w-100",G.r),disabled:!S||v},v&&k.a.createElement("span",{className:"pr-0_5"},k.a.createElement(gt.a,{size:14,thickness:1,color:"white"})),w)),R=b&&f&&(e=>!e||1===e.split(",").length)(E),M=t===G.F&&(!m||R&&!C),D=!l&&!bt.includes(t)||M,L=()=>k.a.createElement(F.a,{className:Me()("mt-2",{"mt-md-2_5":t===G.F&&m})},j),U=!(t===G.A||t===G.x);let z=[G.F,G.p,G.N,G.A].includes(t)?10:12;return t===G.x&&(z=11),k.a.createElement(ut.a,{tag:U?"form":"div",action:U?"javascript:void(0);":void 0,onSubmit:this.handleSubmit,className:Me()("pos-r",G.ib,t,{"pb-1_5":!l,"mb-1_5":l,done:I,active:r,invisible:!r&&!o}),autoComplete:U?"off":void 0},k.a.createElement("div",{className:"form-content pos-r bg-white rounded mt-0_75"},k.a.createElement(ct.a,{"data-index":t,"data-tracking-id":G.j,onClick:u,disabled:_,className:"step-header d-flex align-items-center bg-white text-decoration-none border-0 p-0 ml-1 ml-md-1_5 pr-1_25 size-16"},k.a.createElement("span",{"data-index":t,className:Me()("step-counter rounded-circle d-inline-flex align-items-center justify-content-center mr-1 size-14 font-weight-bold",{"bg-primary-darker text-white":r,"icon-done text-success":I})},!I&&s),k.a.createElement("span",{"data-index":t,className:"step-label"},i())),k.a.createElement(pt.a,{isOpen:r,"data-tracking-parent":h},k.a.createElement("div",{className:Me()("pos-r mt-1_5 px-1_5 px-md-3",{"pb-3":t!==G.x})},m?k.a.createElement(x.Fragment,null,k.a.createElement(F.a,null,k.a.createElement(q.a,{xs:12,xl:z,className:Me()({"mx-xl-auto":t===G.x,"px-xl-0":t===G.x&&y})},n)),D&&k.a.createElement(F.a,null,k.a.createElement(q.a,{xs:12,xl:10},L()))):k.a.createElement(x.Fragment,null,k.a.createElement(F.a,null,k.a.createElement(q.a,{xs:12},n)),D&&L())))),!m&&N&&k.a.createElement(F.a,{className:"mt-1_5"},A,V))}}Et.propTypes={title:w.a.func.isRequired,id:w.a.string.isRequired,children:w.a.node.isRequired,nextId:w.a.string,stepCounter:w.a.number.isRequired,onDone:w.a.func,onContinue:w.a.func,onSave:w.a.func,isDone:w.a.bool,isActive:w.a.bool,isFinal:w.a.bool,hasTotalPayment:w.a.bool,isExtendedReport:w.a.bool,trackingParentId:w.a.string,appliedTradeIn:w.a.number,predefinedVin:w.a.string,isQueryPredefinedVin:w.a.bool,styleIds:w.a.string,isEscapeHatch:w.a.bool,isLoadingColorsAndOptions:w.a.bool,isMobile:w.a.bool},Et.defaultProps={nextId:"",isDone:!1,isFinal:!1,isActive:!1,hasTotalPayment:!1,onDone:null,onContinue:null,onSave:null,isExtendedReport:!1,trackingParentId:null,appliedTradeIn:0,predefinedVin:"",isQueryPredefinedVin:!1,styleIds:"",isEscapeHatch:!1,isLoadingColorsAndOptions:!1,isMobile:!1};var yt=a("./site-modules/shared/components/vehicle-dropdowns/vehicle-dropdowns.jsx"),vt=a("./site-modules/shared/components/appraisal/zip-field/zip-field.jsx");a("./site-modules/shared/components/appraisal/trade-in-appraiser-steps/location-and-style-step/location-and-style-step.scss");class Ct extends x.Component{constructor(){super(...arguments),this.state={isLoaded:!1},this.onSelect=((e,t,a,s,i)=>{const n=this.props,r=n.onDropdownsSelect,o=n.vin,l=n.vinStyles,c=n.checkVinMismatchError;r(e,t,a,s,i),o&&c(l)}),this.setLoaded=(()=>{this.setState(()=>({isLoaded:!0}))}),this.vehicleDropdownRender=(e=>{const t=this.props,a=t.selectStyle,i=t.estimatedVehicle,n=t.errorMap,r=t.updateStepsState,o=t.isMobile,l=this.state.isLoaded,c=!!i,d=n.get(ce.f),p=n.get(ce.h),m=n.get(ce.l),u=n.get(ce.j);return k.a.createElement(F.a,null,k.a.createElement(q.a,{xs:12,className:"px-0"},k.a.createElement(yt.a,Object(s.a)({tag:"div",showAllSubmodels:c,hasModel:!0,hasYear:!0,hasStyle:!0,vehicle:i,selectStyle:a,hasOptionTruncate:!1,inputClasses:"form-control pr-2 w-100 mmy-select input-content",makeLabel:"Make",modelLabel:"Model",yearLabel:"Year",styleLabel:"Style",labelClassName:"small mb-0_25",buttonGroupClassNames:"d-none",errorMake:d,errorModel:p,errorYear:m,errorStyle:u,pubStatesYears:G.a,isStyleIdQueryParamEnabled:!0,isMobile:o,updateStepsState:r,disabled:!l,enableSpinner:!0},e))))}),this.renderLayout=(()=>{const e=this.props,t=e.isZipCodeValid,a=e.onZipCodeChange,s=e.onDropdownsSelect,i=e.zipCode,n=e.errorMap,r=this.state.isLoaded;return k.a.createElement(x.Fragment,null,k.a.createElement(F.a,null,k.a.createElement(q.a,{xs:12,md:6,className:"px-0"},k.a.createElement(vt.a,{isZipCodeValid:t,onZipCodeChange:a,zipCode:i,zipClassName:"pr-md-1",errorMap:n,disabled:!r,zipWrapperClassName:"mb-1"}))),this.vehicleDropdownRender({makeDropdownClassNames:"has-right-padding mb-1 p-0 pr-md-0_75 pr-lg-1",modelDropdownClassNames:"mb-1 p-0 pl-md-0_75 pl-lg-1",submodelDropdownClassNames:"mb-1 p-0 pl-md-0_75 pl-lg-1",yearDropdownClassNames:"has-right-padding mb-1 mb-md-0 p-0 pr-md-0_75 pr-lg-1",styleDropdownClassNames:"mb-0 p-0 pl-lg-1 pl-md-0_75 pos-r",isStyledSelects:!0,onDropdownsSelect:s}))}),this.renderExtendedLayout=(()=>{const e=this.props,t=e.isZipCodeValid,a=e.onZipCodeChange,s=e.zipCode,i=e.errorMap,n=e.isMobile,r=e.changeStep,o=e.isLoadingColorsAndOptions,l=this.state.isLoaded;return n?k.a.createElement(x.Fragment,null,this.vehicleDropdownRender({makeDropdownClassNames:"custom-select-arrow has-right-padding mb-1 p-0 pr-md-0_75 pr-lg-1",modelDropdownClassNames:"custom-select-arrow mb-1 p-0 pl-md-0_75 pl-lg-1",submodelDropdownClassNames:"custom-select-arrow mb-1 p-0 pl-md-0_75 pl-lg-1",yearDropdownClassNames:"custom-select-arrow has-right-padding mb-1 mb-md-0 p-0 pr-md-0_75 pr-lg-1",styleDropdownClassNames:"custom-select-arrow mb-0 p-0 pl-lg-1 pl-md-0_75 pos-r",onDropdownsSelect:this.onSelect,showFindStyleLink:!0}),k.a.createElement(F.a,null,k.a.createElement(q.a,{xs:4,md:6,className:"px-0 mt-2 mt-md-3"},k.a.createElement(vt.a,{isZipCodeValid:t,onZipCodeChange:a,zipCode:s,zipClassName:"pr-md-0_75",errorMap:i,disabled:!l,labelClassName:"icon-location text-primary-darker ml-0_75",inputClassName:"pl-2",isMobile:!0})),k.a.createElement(q.a,{xs:7,md:6,lg:4,className:"px-0 mt-2 mt-md-3 ml-auto pl-md-0_75"},k.a.createElement(ct.a,{type:"submit",onClick:r,"data-index":G.m,"data-tracking-id":G.i[G.F],color:"success",className:Me()("heading-5 text-white py-0_5 form-button text-transform-none pos-r d-block w-100",G.r),disabled:!l||o},o&&k.a.createElement("span",{className:"pr-0_5"},k.a.createElement(gt.a,{size:14,thickness:1,color:"white"})),"Continue")))):k.a.createElement(x.Fragment,null,this.vehicleDropdownRender({errorMessageClassNames:"mt-0_5",makeDropdownClassNames:"has-right-padding mb-1 p-0 pr-md-0_75 pr-lg-1",modelDropdownClassNames:"mb-1 p-0 pl-md-0_75 pl-lg-1",submodelDropdownClassNames:"mb-1 p-0 pl-md-0_75 pl-lg-1",yearDropdownClassNames:"has-right-padding mb-1 mb-md-0 p-0 pr-md-0_75 pr-lg-1",styleDropdownClassNames:"mb-0 p-0 pl-lg-1 pl-md-0_75 pos-r style-dropdown-error-gutter",isStyledSelects:!0,onDropdownsSelect:this.onSelect,showFindStyleLink:!0}),k.a.createElement(F.a,null,k.a.createElement(q.a,{xs:12,md:6,className:"px-0 mt-1"},k.a.createElement(vt.a,{isZipCodeValid:t,onZipCodeChange:a,zipCode:s,zipClassName:"pr-md-1 mb-0 mmy-zip-code",errorMap:i,disabled:!l}))))})}componentDidMount(){ee.a.domReady(()=>this.setLoaded())}componentDidUpdate(e){const t=this.props,a=t.vinStyles,s=t.checkVinMismatchError,i=t.isProfileOfferVinPrepopulationEnabled;a&&!u()(e.vinStyles,a)&&i&&s(a)}render(){const e=this.props.isExtendedReport;return k.a.createElement("div",{className:"location-and-style-step"},e?this.renderExtendedLayout():this.renderLayout())}}Ct.propTypes={isZipCodeValid:w.a.bool.isRequired,onZipCodeChange:w.a.func.isRequired,onDropdownsSelect:w.a.func.isRequired,updateStepsState:w.a.func,selectStyle:w.a.bool,isExtendedReport:w.a.bool,isMobile:w.a.bool,zipCode:w.a.string,estimatedVehicle:te.b.StyleWithoutSubmodels,errorMap:w.a.objectOf(w.a.string),changeStep:w.a.func,isLoadingColorsAndOptions:w.a.bool,vehicle:w.a.shape({}),vin:w.a.string,checkVinMismatchError:w.a.func,isProfileOfferVinPrepopulationEnabled:w.a.bool,vinStyles:w.a.arrayOf(w.a.shape({}))},Ct.defaultProps={updateStepsState:b.a,selectStyle:!1,isExtendedReport:!1,isMobile:!1,zipCode:"",estimatedVehicle:null,errorMap:new Map,changeStep:b.a,isLoadingColorsAndOptions:!1,vehicle:{},vin:"",checkVinMismatchError:b.a,isProfileOfferVinPrepopulationEnabled:!1,vinStyles:null};const St={vinStyles:Object($.a)(e=>Object(ae.d)(e),ae.b)},Tt=Object($.b)(Ct,St);var It=a("../node_modules/reactstrap/lib/ButtonGroup.js"),_t=a.n(It),Nt=a("./site-modules/shared/components/appraisal/appraisal-tabs/appraise-by-tabs-header-item.jsx"),Ot=a("./site-modules/shared/components/appraisal/appraisal-tabs/appraisal-tab-link/appraisal-tab-link.jsx"),Pt=a("../node_modules/reactstrap/lib/TabContent.js"),At=a.n(Pt),xt=a("../node_modules/reactstrap/lib/TabPane.js"),kt=a.n(xt),Vt=a("./site-modules/shared/components/error-boundary/error-boundary.jsx"),wt=a("./data/models/states.js"),jt=a("./data/models/vehicle-v2.js"),Rt=a("./site-modules/shared/components/appraisal/appraisal-tabs/license-plate-tab-content/license-plate-tab-content.jsx"),Mt=(a("../node_modules/core-js/modules/es6.regexp.replace.js"),a("../node_modules/reactstrap/lib/FormGroup.js")),Dt=a.n(Mt),Lt=a("../node_modules/reactstrap/lib/Label.js"),Ft=a.n(Lt),Ut=a("../node_modules/reactstrap/lib/Input.js"),qt=a.n(Ut),zt=a("./utils/seed-randomizers.js"),Bt=a("../node_modules/react-input-mask/index.js"),$t=a.n(Bt),Yt=a("./site-modules/shared/components/field-error/field-error.jsx"),Ht=a("./site-modules/shared/components/find-vin-modal/find-vin-modal.jsx"),Zt=a("./site-modules/shared/components/appraisal/trade-in-appraiser-steps/license-plate-and-vin-step/epo-tab-content-form-wrapper.jsx"),Gt=a("./site-modules/shared/components/appraisal/trade-in-appraiser-steps/license-plate-and-vin-step/let-us-know-wufoo.jsx");a("./site-modules/shared/components/appraisal/trade-in-appraiser-steps/license-plate-and-vin-step/epo-vin-tab-content.scss");const Wt="*****************";class Qt extends x.Component{constructor(){super(...arguments),this.state={vin:"",isSubmitted:!1,isSubmitting:!1,errorMap:new Map},this.onVinChange=(e=>{const t=e.target.value;return this.setState(e=>{let a=e.errorMap;return a.has(ce.d)&&a.delete(ce.d),{vin:Object(ce.q)(t),errorMap:a,isSubmitted:!1}},()=>{this.props.updateStepsState("isAllowedToPredefineVin",!1),this.props.onValueChange()})}),this.getShortSquishVin=(()=>this.props.squishVins.length?this.props.squishVins[0].slice(0,-2):""),this.getVinInputId=(()=>`vin${this.uniqInputId}`),this.setVinError=((e,t)=>this.setState(a=>{let s=a.errorMap;if(e)s.delete(ce.d);else{const e=t?k.a.createElement(x.Fragment,null,ce.e.get(ce.d)," ",k.a.createElement(Gt.a,null)):k.a.createElement(x.Fragment,null,G.tb," ",k.a.createElement(Gt.a,null));s.set(ce.d,e)}return{errorMap:s}})),this.uniqInputId="",this.handleFocus=(e=>{e.target.value.replace(/[_x]/gi,"").length||this.setState({vin:this.getShortSquishVin()})}),this.handlePaste=(e=>{const t=e.clipboardData.getData("text");17===t.length&&(e.preventDefault(),this.onVinChange({target:{value:t}}))}),this.vinLabel=(()=>k.a.createElement("div",{className:"d-flex align-items-center"},k.a.createElement("div",{className:"mr-0_5"},"Enter VIN"),!this.props.isEscapeHatchDrawer&&k.a.createElement(Ht.a,{className:"text-decoration-none p-0 border-0 text-primary-darker text-transform-none size-16 find-vin-modal-open-btn",creativeId:`${this.props.creativeId}-popup`,isInfoIcon:!0}))),this.handleSubmit=(async e=>{e.preventDefault(),await this.props.clearVin(),this.setState({isSubmitted:!0}),this.toggleSubmit(this.validateAndSubmit)}),this.toggleSubmit=(e=>this.setState(e=>({isSubmitting:!e.isSubmitting}),e)),this.validate=(()=>{const e=this.state.vin,t=Object(ce.s)(e),a=Je.a.validateVinLength(e.replace(/_/gim,""));return this.setVinError(t,a),t}),this.validateAndSubmit=(()=>{const e=this.props,t=e.setVin,a=e.onValidationError,s=e.creativeId,i=e.setModelValue,n=this.state.vin;if(this.validate())return t(n),void i("eligibilityCreativeIds",se.b,{[n]:s});ee.a.fireTrackAction({event_type:J.b.EVENT_TYPE_ACTION_PROGRESS,event_data:{action_name:J.b.ACTION_APPRAISE_VEHICLE,action_category:J.b.USER_ACTION_CATEGORY,action_cause:J.b.ACTION_CAUSE_USER_INPUT,subaction_name:J.b.SUBACTION_VIN_VALIDATION,creative_id:s,value:J.b.VIN_FORMAT_INVALID}}),ee.a.fireTrackAction({event_type:J.b.EVENT_TYPE_ACTION_PROGRESS,event_data:{action_name:J.b.ACTION_APPRAISE_VEHICLE,action_category:J.b.USER_ACTION_CATEGORY,action_cause:J.b.ACTION_CAUSE_USER_INPUT,subaction_name:J.b.SUBACTION_VIN_ERROR,creative_id:s,value:`${n}_${J.b.SUBACTION_VIN_VALIDATION}_${J.b.VIN_FORMAT_INVALID}`}}),this.toggleSubmit(a)}),this.errorMessages=(()=>{const e=this.state,t=e.isSubmitted,a=e.isSubmitting,s=e.errorMap,i=this.props,n=i.squishVinError,r=i.forceError,o=s.get(ce.d),l=`${ce.d}-error-${Object(zt.c)()}`,c=t&&!a&&o,d=(t&&!a||r)&&!s.has(ce.d)&&n;return k.a.createElement(x.Fragment,null,k.a.createElement(Yt.a,{classes:"mt-0_5",id:l,error:c}),k.a.createElement(Yt.a,{classes:"mt-0_5",id:l,error:d}))}),this.renderDefaultVinInput=(()=>{const e=this.state.vin;return k.a.createElement(qt.a,{className:"vin-input text-uppercase size-16",id:this.getVinInputId(),value:e,onChange:this.onVinChange,maxLength:17,minLength:17})}),this.renderMaskedVinInput=(e=>k.a.createElement(qt.a,Object(s.a)({},e,{className:"vin-input text-uppercase size-16 masked-input",id:this.getVinInputId()})))}componentDidMount(){const e=this.props,t=e.queryVin,a=e.useUniqId;e.isAllowedToPredefineVin&&t&&this.onVinChange({target:{value:t}}),a&&(this.uniqInputId=Object(zt.c)())}componentDidUpdate(e){const t=this.props,a=t.vinEligibility,s=t.onCompleteCallback,i=t.onValidationError,n=t.isVinFromDrawer,r=t.isAllowedToPredefineVin,o=t.queryVin,l=t.vin,c=this.state,d=c.isSubmitting,p=c.vin;if(l&&!u()(e.vin,l)&&n&&(p&&u()(p,this.props.vin)||this.onVinChange({target:{value:l}})),r&&o&&!u()(e.queryVin,o)&&this.onVinChange({target:{value:o}}),!u()(a,e.vinEligibility)&&!C()(a)){const e=a.isCheckDigitValid;d?e?this.toggleSubmit(s(p,a)):(this.setVinError(e,!0),this.toggleSubmit(i)):r&&o&&e&&s(p,a)}}render(){const e=this.props,t=e.tabContentModal,a=e.squishVinError,s=e.queryVin,i=e.ctaText,n=e.isSecondary,r=e.isEscapeHatch,o=e.isVinFromDrawer,l=e.isEscapeHatchDrawer,c=e.isLocationStyleStep,d=e.hideVinLicensePlateBtn,p=e.isAddressToVinEnabled,m=this.state,u=m.vin,h=m.isSubmitted,g=m.isSubmitting,f=m.errorMap.get(ce.d)||a,b=t&&!s&&!o,E=this.getShortSquishVin();let y=8,v=10,C=l?7:6;return C=c?8:C,(r||l||c)&&(y=12,v=12),k.a.createElement(Zt.a,{isEscapeHatch:r,isEscapeHatchDrawer:l,isLocationStyleStep:c},k.a.createElement(ut.a,{onSubmit:this.handleSubmit},k.a.createElement(F.a,{className:Me()("epo-vin-tab",{"mt-1":l,"mt-0_25":c})},!E||s||o||!(!l||l&&p)||c?k.a.createElement(q.a,{xs:12,md:v,lg:y},k.a.createElement(Dt.a,{className:Me()({"has-danger":f,"has-success":h&&!f,"pr-md-1":c})},c?k.a.createElement(Ft.a,{className:"small mb-0_25 d-flex justify-content-between",for:this.getVinInputId()},k.a.createElement("span",null,"Enter VIN"),k.a.createElement(Ht.a,{className:"p-0 border-0 text-primary-darker text-transform-none small find-vin-modal-open-btn",creativeId:G.e})):k.a.createElement(Ft.a,{className:"font-weight-bold",for:this.getVinInputId()},this.vinLabel()),this.renderDefaultVinInput(),this.errorMessages())):k.a.createElement(q.a,{xs:12,md:v,lg:y},k.a.createElement(Dt.a,{className:Me()("mb-1_5",{"has-danger":f,"has-success":h&&!f})},k.a.createElement(Ft.a,{for:this.getVinInputId(),className:"text-gray-darker size-14"},"Enter last 9 digits of your VIN",k.a.createElement(Ht.a,{className:"text-decoration-none ml-0_25 text-gray-darker p-0 border-0 text-transform-none find-vin-modal-open-btn size-16",creativeId:`${this.props.creativeId}-popup`,isInfoIcon:!0})),k.a.createElement($t.a,{mask:Wt,maskChar:"_",alwaysShowMask:!1,formatChars:{"*":"[A-Za-z0-9]"},value:u,onChange:this.onVinChange,onFocus:this.handleFocus,onPaste:this.handlePaste},this.renderMaskedVinInput),this.errorMessages()))),!d&&k.a.createElement(F.a,{className:Me()("align-items-center",{"mt-0_5":c||l})},k.a.createElement(q.a,{xs:12,md:r?12:C},k.a.createElement(ct.a,{color:l&&!p?"primary-b":"success",block:!0,className:Me()("epo-vin-continue-btn text-transform-none",{"py-1":r,"py-0_5":!r}),onClick:this.handleSubmit,disabled:g,"data-tracking-id":"epo_submit_vin","data-tracking-value":n?`${i} 2`:i},g&&k.a.createElement("span",{className:"pr-0_5"},k.a.createElement(gt.a,{size:14,thickness:1,color:"white"})),k.a.createElement("span",{className:"size-16"},i))),b&&k.a.createElement(q.a,{xs:12,md:r?12:6,className:Me()("mt-1 text-center",{"text-md-left mt-md-0":!r})},t))))}}Qt.propTypes={setVin:w.a.func.isRequired,clearVin:w.a.func.isRequired,onCompleteCallback:w.a.func.isRequired,onValidationError:w.a.func.isRequired,vinEligibility:se.a.VinEligibility,vin:w.a.string,queryVin:w.a.string,creativeId:w.a.string,tabContentModal:w.a.oneOfType([w.a.node,w.a.func]),squishVinError:w.a.oneOfType([w.a.string,w.a.node,w.a.func]),onValueChange:w.a.func,setModelValue:w.a.func,ctaText:w.a.string,isSecondary:w.a.bool,squishVins:w.a.arrayOf(w.a.string),isEscapeHatch:w.a.bool,isVinFromDrawer:w.a.bool,isEscapeHatchDrawer:w.a.bool,isLocationStyleStep:w.a.bool,useUniqId:w.a.bool,forceError:w.a.bool,hideVinLicensePlateBtn:w.a.bool,isAddressToVinEnabled:w.a.bool,isMobile:w.a.bool,isAllowedToPredefineVin:w.a.bool,updateStepsState:w.a.func},Qt.defaultProps={vinEligibility:null,vin:"",squishVins:[],queryVin:"",creativeId:G.B,tabContentModal:null,squishVinError:null,onValueChange:b.a,setModelValue:b.a,ctaText:"Continue",isSecondary:!1,isEscapeHatch:!1,isVinFromDrawer:!1,isEscapeHatchDrawer:!1,isLocationStyleStep:!1,useUniqId:!0,forceError:!1,hideVinLicensePlateBtn:!1,isAddressToVinEnabled:!1,isMobile:!1,isAllowedToPredefineVin:!0,updateStepsState:b.a};const Kt={LICENSE_PLATE:"LICENSE_PLATE",VIN:"VIN"},Xt={SQUISH_VIN:"SQUISH_VIN",VIN_ELIGIBILITY:"VIN_ELIGIBILITY"},Jt={stateCodes:Object($.a)("allStateCodes",wt.b),vinEligibility:Object($.a)(e=>{let t=e.vehicle,a=t.make,s=t.model,i=t.year,n=e.vin,r=e.isEligibleHardcodeYmmBypass,o=e.creativeId;return e.isStepActive&&a&&s&&i?Object(se.f)({vin:n,make:a.name,model:s.name,year:i.year,isEligibleHardcodeYmmBypass:r,trackingCreativeId:o}):null},se.b),vinFromLicensePlate:Object($.a)(e=>{let t=e.licensePlate,a=e.stateCode;return Object(se.d)({licensePlate:t,stateCode:a})},se.b),squishVins:Object($.a)(e=>{let t=e.vehicle.style;return C()(t)?"":`styles["${t.id}"].squishVin`},jt.d)},ea=Object(z.c)(e=>({licensePlateLookupError:Object(se.h)(e)}))(Object($.b)(Rt.a,Jt)),ta=Object($.b)(Qt,Jt),aa={[Kt.LICENSE_PLATE]:ea,[Kt.VIN]:ta};class sa extends x.PureComponent{constructor(){super(...arguments),this.state={vin:"",licensePlate:"",stateCode:""},this.onValidationError=(()=>this.props.triggerEpoVinError()),this.setVin=(e=>this.setState({vin:e})),this.setLicensePlateAndStateCode=(e=>{let t=e.licensePlate,a=e.stateCode;this.setState({licensePlate:t,stateCode:a})}),this.clearVin=(()=>this.setState({vin:"",licensePlate:null,stateCode:null},()=>{this.props.clearVin()}))}componentDidUpdate(e){const t=this.props,a=t.isVinFromDrawer,s=t.vin,i=t.queryVin;e.vin||u()(e.vin,s)||!a&&!i||this.setVin(s)}render(){const e=this.props,t=e.tabId,a=e.isMobile,s=e.creativeId,i=e.vehicle,n=e.tabContentModal,r=e.errors,o=e.queryVin,l=e.setVinTabActive,c=e.onValueChange,d=e.ctaText,p=e.useUniqId,m=e.vinTabLink,u=e.isSecondary,h=e.isEligibleHardcodeYmmBypass,g=e.isStepActive,f=e.isEscapeHatch,b=e.isVinFromDrawer,E=e.forceError,y=e.isEscapeHatchDrawer,v=e.isLocationStyleStep,C=e.isFullWidth,S=e.hideVinLicensePlateBtn,T=e.isAddressToVinEnabled,I=e.updateStepsState,_=e.isAllowedToPredefineVin,N=this.state,O=N.licensePlate,P=N.stateCode,A=aa[t],x=r.get(`${t}_${Xt.SQUISH_VIN}`);return k.a.createElement(A,{isAppraisalValuePage:!0,vin:this.state.vin,setVin:this.setVin,clearVin:this.clearVin,vehicle:i,onCompleteCallback:this.props.onCompleteCallback,isMobile:a,creativeId:s,tabContentModal:n,squishVinError:x,onValidationError:this.onValidationError,onValueChange:c,useUniqId:p,isSecondary:u,isEligibleHardcodeYmmBypass:h,isEscapeHatch:f,initialStateCode:f?"CA":void 0,queryVin:o,setVinTabActive:l,ctaText:d,isStepActive:g,isVinFromDrawer:b,setLicensePlateAndStateCode:this.setLicensePlateAndStateCode,licensePlate:O,stateCode:P,vinTabLink:m,forceError:E,isEscapeHatchDrawer:y,isLocationStyleStep:v,isFullWidth:C,hideVinLicensePlateBtn:S,isAddressToVinEnabled:T,updateStepsState:I,isAllowedToPredefineVin:_})}}sa.propTypes={tabId:w.a.string.isRequired,vehicle:w.a.shape({make:w.a.shape({name:w.a.string}),model:w.a.shape({name:w.a.string}),year:w.a.shape({year:w.a.string}),style:w.a.shape({id:w.a.number})}).isRequired,onCompleteCallback:w.a.func.isRequired,clearVin:w.a.func.isRequired,triggerEpoVinError:w.a.func.isRequired,isMobile:w.a.bool,creativeId:w.a.string,tabContentModal:w.a.oneOfType([w.a.func,w.a.node]),errors:w.a.oneOfType([w.a.func,w.a.node]),queryVin:w.a.string,setVinTabActive:w.a.func,onValueChange:w.a.func,ctaText:w.a.string,vin:w.a.string,useUniqId:w.a.bool,vinTabLink:w.a.oneOfType([w.a.node,w.a.func]),isSecondary:w.a.bool,isEligibleHardcodeYmmBypass:w.a.bool,isStepActive:w.a.bool,isEscapeHatch:w.a.bool,isVinFromDrawer:w.a.bool,forceError:w.a.bool,isEscapeHatchDrawer:w.a.bool,isLocationStyleStep:w.a.bool,isFullWidth:w.a.bool,hideVinLicensePlateBtn:w.a.bool,isAddressToVinEnabled:w.a.bool,isAllowedToPredefineVin:w.a.bool,updateStepsState:w.a.func},sa.defaultProps={isMobile:!1,creativeId:null,tabContentModal:null,errors:new Map,queryVin:"",vin:"",setVinTabActive:null,onValueChange:void 0,ctaText:"Continue",useUniqId:!0,vinTabLink:null,isSecondary:!1,isEligibleHardcodeYmmBypass:!1,isStepActive:!1,isEscapeHatch:!1,isVinFromDrawer:!1,forceError:!1,isEscapeHatchDrawer:!1,isLocationStyleStep:!1,isFullWidth:!1,hideVinLicensePlateBtn:!1,isAddressToVinEnabled:!1,isAllowedToPredefineVin:!0,updateStepsState:b.a};var ia=a("./site-modules/shared/utils/appraisal/check-vin-inventory.js"),na=a("./site-modules/shared/components/drawer/drawer.jsx"),ra=a("./site-modules/shared/components/form-field/form-field.jsx"),oa=a("./site-modules/shared/components/styled-select/styled-select.jsx"),la=a("./site-modules/shared/components/form-validation/form-validation.jsx"),ca=a("./site-modules/shared/components/zip-input/zip-input.jsx"),da=a("./site-modules/shared/components/radio-list/radio-list-item.jsx");const pa={OFFER:"Get My Offer",APPRAISE:"No thanks. I just want an appraisal"},ma={licensePlate:"Don't have your license plate?",vin:"Don't have your VIN?"},ua={SINGLE_VIN:"We found a VIN using the address you provided.",MULTIPLE_VINS:"We found these vehicles based on the address you provided. Please select the correct one."};a("./site-modules/shared/components/find-vin-by-address/find-vin-by-address.scss");const ha={firstName:{test:Je.a.validateFirstName,errorText:"Please correct your first name. First name cannot be empty."},lastName:{test:Je.a.validateName,errorText:"Please correct your last name. Last name cannot be empty."},address:{test:Je.a.validateAddress,errorText:"Please enter a valid street address. Street address cannot be empty."},city:{test:Je.a.validateCity,errorText:"Please enter a valid city. City cannot be empty."},state:{test:Je.a.validateValue,errorText:"Please select a state. State cannot be empty."}};function ga(e){const t=(new Date).toISOString();return{stateCode:e.addressStateCode,isSubmitted:!1,isSubmitting:!1,isSubmittingVin:!1,isZipChangeInProgress:!1,stateCodeError:"",city:e.addressCity,vehicles:null,selectedVin:null,quotebackId:D()(`${t}`,G.v).slice(0,20)}}class fa extends x.Component{constructor(){super(...arguments),this.state=ga(this.props),this.onStateCodeChange=(e=>{let t=e.stateCode;this.setState({stateCode:t,stateCodeError:""})}),this.setZipCodeFromPage=(()=>{this.props.setModelValue("location.address",Y.c,this.props.location)}),this.setDefaultState=(()=>{this.setState(ga(this.props))}),this.setCity=(e=>this.setState(()=>({city:e}))),this.getVins=(async()=>{const e=this.props,t=e.vehicle,a=e.fields,s=a.firstName,i=a.lastName,n=a.address,r=a.apartment,o=a.city,l=e.addressZipCode,c=this.state,d=c.quotebackId,p=c.stateCode,m={quotebackId:d,firstName:s.value(),surname:i.value(),streetAddress:`${n.value()} ${r.value()}`,city:o.value(),state:p,zipCode:l,make:T()(t,"make.name",""),year:T()(t,"year.year","")};return Object(se.j)(m)}),this.updateVinAndContinue=(e=>{const t=this.props,a=t.updateStepsState,s=t.updateVinAndContinue,i=this.state.selectedVin;this.setState({isSubmittingVin:!1},()=>{s(i,e),a("isVinFromDrawer",!0),ee.a.fireCustomEvent(ya,{})})}),this.uniqId=this.props.useUniqId?`-${Object(zt.c)()}`:"",this.checkVinMismatchError=(e=>{const t=this.props,a=t.vehicle,s=t.updateStepsState,i=t.setVinFromDrawerSquishStyles,n=T()(e,"[0]",{}),r=n.makeNiceId,o=n.modelNiceId,l=n.year,c=T()(a,"make.slug",""),d=T()(a,"model.slug",""),m=T()(a,"year.year",""),u=3!==p()([r,c,o,d,`${l}`,m]).length;i(e),s("hasVinMismatchError",u),this.updateVinAndContinue(u)}),this.trackFindVinByAddressEvent=((e,t,a)=>ee.a.fireTrackAction({event_type:J.b.EVENT_TYPE_ACTION_PROGRESS,event_data:{action_name:J.b.ACTION_RECEIVE_EPO,action_category:J.b.USER_ACTION_CATEGORY,action_cause:J.b.ACTION_CAUSE_BUTTON_CLICK,subaction_name:e,creative_id:a,value:t}})),this.handleSubmit=(e=>{e.preventDefault(),e.stopPropagation(),this.setState({isSubmitting:!0},async()=>{const e=this.props,t=e.validate,a=e.vehicle,s=e.creativeId,i=e.toggleVinLpForm,n=this.state.stateCode,r=T()(a,"make.name",""),o=T()(a,"model.name",""),l=T()(a,"year.year","");let c=t();if(ha.state.test(n)||(this.setState({stateCodeError:ha.state.errorText}),c=!1),c){this.trackFindVinByAddressEvent(J.b.SUBMIT_ADDRESS_LOOKUP,"Look up my VIN",s),this.trackFindVinByAddressEvent(J.b.CUSTOMER_CONSENT_FOR_ADDRESS_LOOKUP,`quotebackId_${this.state.quotebackId}`,s),this.trackFindVinByAddressEvent(J.b.SUBMIT_ADDRESS_STATE,n,s);const e=(await this.getVins()).vehicles;let t=e.filter(e=>`${e.modelYear} ${e.make} ${e.modelDesc}`.toUpperCase()===`${l} ${r} ${o}`.toUpperCase());t.length||(t=e.filter(e=>`${e.modelYear} ${e.make}`.toUpperCase()===`${l} ${r}`.toUpperCase())),e.length?this.trackFindVinByAddressEvent(J.b.ADDRESS_LOOKUP,J.b.VIN_FOUND,s):this.trackFindVinByAddressEvent(J.b.ADDRESS_LOOKUP,J.b.VIN_NOT_FOUND,s),t.length?this.trackFindVinByAddressEvent(J.b.ADDRESS_LOOKUP_DISPLAY_RESULT,J.b.VIN_SHOWN,s):(this.trackFindVinByAddressEvent(J.b.ADDRESS_LOOKUP_DISPLAY_RESULT,J.b.VIN_NOT_SHOWN,s),i()),this.setState(()=>({isSubmitted:!0,isSubmitting:!1,vehicles:t,selectedVin:(t[0]||{}).vin}))}else this.setState({isSubmitting:!1})})}),this.resetState=(()=>{this.setState(()=>({isSubmitted:!1,isSubmitting:!1,vehicles:null,selectedVin:null}))}),this.inputRef=(e=>{if(e)return this.props.fieldRef(e.props.name,e)}),this.selectVehicle=(e=>{let t=e.target.value;this.setState({selectedVin:t})}),this.continueWithSelectedVehicle=(e=>{e.persist();const t=this.props,a=t.creativeId,s=t.setVinForEligibility,i=this.state.selectedVin;ee.a.fireTrackAction({event_type:J.b.EVENT_TYPE_ACTION_PROGRESS,event_data:{action_name:J.b.ACTION_APPRAISE_VEHICLE,action_category:J.b.USER_ACTION_CATEGORY,action_cause:J.b.ACTION_CAUSE_BUTTON_CLICK,subaction_name:J.b.SUBMIT_VIN,creative_id:a,value:"Continue with this vehicle"}}),this.setState(()=>({isSubmittingVin:!0}),()=>s(i))}),this.handleZipCodeChangeProgress=(e=>{this.setState({isZipChangeInProgress:e.isZipChangeInProgress})}),this.renderHeader=(()=>k.a.createElement("header",{className:"mb-1 pos-r text-gray-darker mt-1_5"},k.a.createElement("h4",{className:"size-24"},"Don't have your VIN or License Plate?"),k.a.createElement("div",null,"We can help you look up your VIN by using your address. This will only be used to look up your VIN, nothing else."))),this.renderFirstNameField=((e,t)=>k.a.createElement("div",null,k.a.createElement(ra.a,{id:`first-name${this.uniqId}`,maxLength:255,name:"firstName",type:"text",label:"First Name",labelClassName:"small mb-0_5",inputClassName:Me()({"size-16":e}),ref:this.inputRef,isValid:!t,required:!0,onBlur:this.props.validate,onChange:this.props.validate}),k.a.createElement(Yt.a,{id:`first-name-error${this.uniqId}`,error:t,classes:"mb-1"}))),this.renderLastNameField=((e,t)=>k.a.createElement("div",null,k.a.createElement(ra.a,{id:`last-name${this.uniqId}`,maxLength:255,name:"lastName",type:"text",label:"Last Name",labelClassName:"small mb-0_5",inputClassName:Me()({"size-16":e}),ref:this.inputRef,isValid:!t,required:!0,onBlur:this.props.validate,onChange:this.props.validate}),k.a.createElement(Yt.a,{id:`last-name-error${this.uniqId}`,error:t,classes:"mb-1"}))),this.renderAddressField=((e,t)=>k.a.createElement("div",null,k.a.createElement(ra.a,{id:`address${this.uniqId}`,maxLength:255,name:"address",type:"text",label:"Street address",labelClassName:"small mb-0_5",inputClassName:Me()({"size-16":e}),ref:this.inputRef,isValid:!t,placeholder:"Enter street address",required:!0,onBlur:this.props.validate,onChange:this.props.validate}),k.a.createElement(Yt.a,{id:`address-error${this.uniqId}`,error:t,classes:"mb-1"}))),this.renderApartmentField=((e,t)=>k.a.createElement(ra.a,{id:`apartment${this.uniqId}`,maxLength:255,name:"apartment",type:"text",label:"Apartment, suite, etc.",labelClassName:"small mb-0_5",inputClassName:Me()({"size-16":e}),ref:this.inputRef,isValid:!t,placeholder:"Enter apartment, suite, etc.",isOptional:!0})),this.renderCityField=((e,t,a)=>k.a.createElement("div",null,k.a.createElement(ra.a,{id:`city${this.uniqId}`,maxLength:255,defaultValue:e,name:"city",type:"text",label:"City",labelClassName:"small mb-0_5",inputClassName:Me()({"size-16":t}),ref:this.inputRef,isValid:!a,required:!0,onBlur:this.props.validate,onChange:this.props.validate}),k.a.createElement(Yt.a,{id:`city-error${this.uniqId}`,error:a,classes:"mb-1"}))),this.renderStateField=((e,t,a)=>k.a.createElement(Dt.a,{className:Me()({"has-danger":a})},k.a.createElement(oa.a,{name:"state",labelText:"State",labelClassName:"small mb-0_5",toggle:"Select State",labelKey:"stateCode",valueKey:"stateCode",options:t,value:e,onChange:this.onStateCodeChange}),k.a.createElement(Yt.a,{id:`state-code-error${this.uniqId}`,error:a,classes:"mt-0_5"}))),this.renderZipField=(e=>k.a.createElement(ca.a,{label:"Zip",onValidate:Je.a.validateZip,labelClasses:"small mb-0_5",inputClasses:Me()({"size-16":e}),inputSize:"md",isAddressZip:!0,onZipChangeInProgress:this.handleZipCodeChangeProgress}))}componentDidUpdate(e){const t=this.props,a=t.addressStateCode,s=t.resetAddressForm,i=t.addressCity,n=t.vinEligibility,r=t.onPartnerOfferVinEligibilityUpdate,o=this.state.city;u()(s,e.resetAddressForm)||this.setDefaultState(),u()(this.props.zipCode,e.zipCode)||this.setZipCodeFromPage(),a&&e.addressStateCode!==a&&this.onStateCodeChange({stateCode:a}),C()(n)||u()(n,e.vinEligibility)||(r(n.isEligibleVin),this.checkVinMismatchError(T()(n,"squishStyles",[]))),i&&i!==o&&this.setCity(i)}render(){const e=this.props,t=e.stateCodes,a=e.validationErrors,s=e.isMobile,i=e.vehicle,n=e.creativeId,r=e.handleAppraisalOnClick,o=e.isOptimizedTraffic,l=a.firstName,c=a.lastName,d=a.address,p=a.apartment,m=a.city,u=this.state,h=u.stateCode,g=u.stateCodeError,f=u.city,b=u.isSubmitting,E=u.isSubmitted,y=u.vehicles,v=u.selectedVin,C=u.isSubmittingVin,S=u.isZipChangeInProgress,I=T()(i,"make.name",""),_=T()(i,"model.name","");let N;return y&&(N=y.length>1?ua.MULTIPLE_VINS:ua.SINGLE_VIN),k.a.createElement("div",{className:"find-vin-by-address","data-tracking-parent":n},E?k.a.createElement(x.Fragment,null,y&&y.length?k.a.createElement(x.Fragment,null,k.a.createElement("header",{className:"mt-1_5 mb-1 pos-r text-gray-darker"},k.a.createElement("h4",{className:"size-24"},"Great news!"),k.a.createElement("div",null,N)),y.length>1&&y.map(e=>k.a.createElement(da.a,{key:`${e.vin}-radio`,name:`${e.vin}-radio`,onChange:this.selectVehicle,checked:v===e.vin,formGroupClassName:Me()("rounded p-0_75 mb-1 find-vin-vehicle",{"active bg-white":v===e.vin,"bg-gray-extra-light":v!==e.vin}),listItem:{title:e.vin,hideValue:!0,text:k.a.createElement("div",null,k.a.createElement("div",{className:"text-gray-darker font-weight-medium text-capitalize"},e.modelYear," ",e.make," ",e.modelDesc),k.a.createElement("div",{className:"text-gray-darker"},k.a.createElement("span",{className:"font-weight-bold mr-0_25"},"VIN:"),e.vin))}})),1===y.length&&k.a.createElement("div",{className:"bg-gray-extra-light p-0_75 rounded find-vin-vehicle d-flex align-items-baseline"},k.a.createElement("i",{className:"icon-checkmark text-success mr-0_5"}),k.a.createElement("div",null,k.a.createElement("div",{className:"text-gray-darker font-weight-medium text-capitalize"},y[0].modelYear," ",y[0].make," ",y[0].modelDesc),k.a.createElement("div",{className:"text-gray-darker"},k.a.createElement("span",{className:"font-weight-bold mr-0_25"},"VIN:"),y[0].vin))),k.a.createElement(ct.a,{color:"success",className:"mt-1_5 py-0_5 text-transform-none","data-index":G.x,onClick:this.continueWithSelectedVehicle,disabled:!v},C&&k.a.createElement("span",{className:"pr-0_5"},k.a.createElement(gt.a,{size:14,thickness:1,color:"white"})),k.a.createElement("span",{className:"size-16 font-weight-bold"},"Continue with this vehicle"))):k.a.createElement(x.Fragment,null,k.a.createElement("header",{className:"mt-2 mb-2 pos-r text-gray-darker text-center"},k.a.createElement("img",{className:"d-inline-block mx-auto mb-1",src:Object(Ze.q)("/img/eva/no-vin-found.svg"),alt:"no vin found"}),k.a.createElement("h4",{className:"size-20"},"Unfortunately, we can't find your VIN at this time.")))):k.a.createElement(x.Fragment,null,this.renderHeader(),k.a.createElement(F.a,{className:"mt-1_5"},k.a.createElement(q.a,{xs:12},k.a.createElement(ut.a,{noValidate:!0,onSubmit:this.handleSubmit},k.a.createElement(F.a,null,k.a.createElement(q.a,{xs:12,lg:6},this.renderFirstNameField(s,l)),k.a.createElement(q.a,{xs:12,lg:6},this.renderLastNameField(s,c))),this.renderAddressField(s,d),this.renderApartmentField(s,p),k.a.createElement("div",null,this.renderCityField(f,s,m),k.a.createElement(F.a,null,k.a.createElement(q.a,{xs:6},this.renderStateField(h,t,g)),k.a.createElement(q.a,{xs:6},this.renderZipField(s)))),k.a.createElement(F.a,{className:"mt-0_5 align-items-center"},k.a.createElement(q.a,{xs:12,md:7,lg:6,xl:7},k.a.createElement(ct.a,{type:"submit",color:"success",className:"w-100 text-transform-none size-16 text-white",disabled:S||b},b&&k.a.createElement("span",{className:"pr-0_5"},k.a.createElement(gt.a,{size:14,thickness:1,color:"white"})),k.a.createElement("span",{className:"size-16"},"Look up my VIN"))))),!o&&k.a.createElement("div",{className:"text-center text-md-left"},k.a.createElement(ct.a,{color:"link",className:"text-primary-darker text-transform-none p-0 mt-1_5",onClick:r,"data-index":G.x,"data-tracking-id":"view_appraisal"},k.a.createElement("span",{className:"size-14 font-weight-normal"},pa.APPRAISE))))),k.a.createElement("div",{className:"size-10 mt-2"},"By clicking Look up my VIN, I authorize and direct Edmunds to use my information to look up the Vehicle Identification Number (VIN) of the ",I," ",_," associated with my address.")))}}fa.propTypes={fieldRef:w.a.func.isRequired,validate:w.a.func.isRequired,setVinFromDrawerSquishStyles:w.a.func.isRequired,handleAppraisalOnClick:w.a.func.isRequired,updateVinAndContinue:w.a.func.isRequired,toggleVinLpForm:w.a.func,setVinForEligibility:w.a.func,onPartnerOfferVinEligibilityUpdate:w.a.func,updateStepsState:w.a.func.isRequired,addressStateCode:w.a.string,creativeId:w.a.string,addressZipCode:w.a.string,addressCity:w.a.string,zipCode:w.a.string,isMobile:w.a.bool,stateCodes:wt.a.States,validationErrors:w.a.objectOf(w.a.string),fields:w.a.shape({firstName:w.a.shape({value:w.a.func}),lastName:w.a.shape({value:w.a.func}),address:w.a.shape({value:w.a.func}),apartment:w.a.shape({value:w.a.func}),city:w.a.shape({value:w.a.func})}),vehicle:w.a.shape({make:w.a.shape({name:w.a.string}),model:w.a.shape({name:w.a.string}),year:w.a.shape({})}).isRequired,resetAddressForm:w.a.bool,setModelValue:w.a.func.isRequired,location:w.a.shape({}),useUniqId:w.a.bool,isOptimizedTraffic:w.a.bool,vinEligibility:se.a.VinEligibility},fa.defaultProps={creativeId:void 0,addressStateCode:"",addressZipCode:"",addressCity:"",zipCode:"",vehicle:{},resetAddressForm:!1,isMobile:!1,stateCodes:[],validationErrors:{},fields:{},location:{},toggleVinLpForm:b.a,onPartnerOfferVinEligibilityUpdate:b.a,setVinForEligibility:b.a,useUniqId:!1,isOptimizedTraffic:!1,vinEligibility:null};const ba={stateCodes:Object($.a)("allStateCodes",wt.b),addressCity:Object($.a)("location.address.city",Y.c),addressStateCode:Object($.a)("location.address.stateCode",Y.c),addressZipCode:Object($.a)("location.address.zipCode",Y.c),zipCode:Object($.a)("location.zipCode",Y.c),location:Object($.a)("location",Y.c),vinEligibility:Object($.a)(e=>{let t=e.vehicle,a=t.make,s=t.model,i=t.year,n=e.vin,r=e.isEligibleHardcodeYmmBypass,o=e.creativeId;return n&&a&&s&&i?Object(se.f)({vin:n,make:a.name,model:s.name,year:i.year,isEligibleHardcodeYmmBypass:r,trackingCreativeId:o}):null},se.b)},Ea=Object(la.a)(Object($.b)(fa,ba),ha);a("./site-modules/shared/components/find-vin-modal/find-vin-modal.scss");const ya="CLOSE_VIN_DRAWER",va={licensePlate:"We can use your VIN instead. Please provide your VIN below to generate your offer:",vin:"We can use your License Plate instead. Please provide your License Plate below to generate your offer:"},Ca={licensePlate:"If you have your VIN on you, please provide it to generate your offer:",vin:"We can use your License Plate instead. Please provide your License Plate below to generate your offer:"};class Sa extends x.Component{constructor(){super(...arguments),this.state={isOpen:!1,showVinLpForm:!1},this.setVinForEligibility=(e=>this.setState({vin:e})),this.handleDrawerClose=(()=>{this.setState(()=>({isOpen:!1}))}),this.trackDrawerToggle=(()=>{const e=this.props.creativeId,t=this.state.isOpen;ee.a.fireTrackAction({event_type:J.b.EVENT_TYPE_ACTION_COMPLETED,event_data:{action_name:J.b.ACTION_SHOW_CONTENT,action_category:J.b.SYSTEM_ACTION_CATEGORY,action_cause:J.b.ACTION_CAUSE_LINK_CLICK,subaction_name:t?J.b.FIND_VIN:J.b.CLOSE_POPUP,creative_id:e,value:t?"open":"close"}})}),this.toggleDrawer=(()=>this.setState(e=>({isOpen:!e.isOpen,showVinLpForm:!1}),this.trackDrawerToggle)),this.toggleDrawerWithoutTracking=(()=>this.setState(e=>({isOpen:!e.isOpen,showVinLpForm:!1}))),this.appraisalOnClick=(e=>{this.props.changeStep(e),this.toggleDrawerWithoutTracking()}),this.toggleVinLpForm=(()=>{this.setState(e=>({showVinLpForm:!e.showVinLpForm}))}),this.renderVinLpForm=(()=>{const e=this.props,t=e.isLicensePlate,a=e.licensePlateAndVinForm,s=e.isAddressToVinEnabled,i=this.state.showVinLpForm;let n="vin";t&&(n="licensePlate");const r=ma[n],o=pa.APPRAISE;return s&&!i?null:k.a.createElement(x.Fragment,null,k.a.createElement("div",{className:"mt-1_5 mb-1 pos-r text-gray-darker"},!s&&k.a.createElement("h4",{className:"size-24"},r," No problem!"),k.a.createElement("div",null,s?Ca[n]:va[n])),a,k.a.createElement(F.a,null,k.a.createElement(q.a,{xs:12,md:7},k.a.createElement(ct.a,{color:"link",className:"text-primary-darker text-transform-none mt-0_5 px-0 text-center text-lg-left",block:!0,onClick:this.appraisalOnClick,"data-index":G.x,"data-tracking-id":"view_appraisal","data-tracking-value":"get_appraisal"},k.a.createElement("span",{className:"font-weight-normal"},o)))))})}componentDidMount(){ee.a.on(ya,this.handleDrawerClose)}componentWillUnmount(){ee.a.off(ya,this.handleDrawerClose)}render(){const e=this.state,t=e.isOpen,a=e.vin,s=this.props,i=s.className,n=s.creativeId,r=s.isLicensePlate,o=s.updateVinAndContinue,l=s.updateStepsState,c=s.vehicle,d=s.isAddressToVinEnabled,p=s.setVinFromDrawerSquishStyles,m=s.isOptimizedTraffic,u=s.onPartnerOfferVinEligibilityUpdate,h=s.isEligibleHardcodeYmmBypass;let g="vin";r&&(g="licensePlate");const f=ma[g];return k.a.createElement(x.Fragment,null,k.a.createElement(na.a,{isOpen:t,toggle:this.toggleDrawer,side:"right",size:"xsmall"},k.a.createElement("div",{className:"p-1_5 p-md-2","data-tracking-parent":n},k.a.createElement(ct.a,{color:"link",size:"lg",className:"close-btn p-0 d-flex align-items-center","aria-label":"Close",onClick:this.toggleDrawer},k.a.createElement("i",{className:"icon-arrow-left3 size-16"}),k.a.createElement("span",{className:"size-14 ml-0_5 text-capitalize font-weight-normal"},"Back")),d&&k.a.createElement(Ea,{updateStepsState:l,creativeId:n,vehicle:c,handleAppraisalOnClick:this.appraisalOnClick,updateVinAndContinue:o,toggleVinLpForm:this.toggleVinLpForm,resetAddressForm:!t,setVinFromDrawerSquishStyles:p,isOptimizedTraffic:m,onPartnerOfferVinEligibilityUpdate:u,useUniqId:!0,isEligibleHardcodeYmmBypass:h,vin:a,setVinForEligibility:this.setVinForEligibility}),this.renderVinLpForm())),k.a.createElement(ct.a,{color:"link",className:Me()("p-0 border-0 text-primary-darker text-transform-none size-16 find-vin-modal-open-btn",i),onClick:this.toggleDrawer},k.a.createElement("span",{className:"font-weight-normal"},f)))}}Sa.propTypes={creativeId:w.a.string.isRequired,changeStep:w.a.func.isRequired,licensePlateAndVinForm:w.a.node.isRequired,className:w.a.string,isLicensePlate:w.a.bool,isAddressToVinEnabled:w.a.bool,isOptimizedTraffic:w.a.bool,updateVinAndContinue:w.a.func,updateStepsState:w.a.func,onPartnerOfferVinEligibilityUpdate:w.a.func,setVinFromDrawerSquishStyles:w.a.func,isEligibleHardcodeYmmBypass:w.a.bool,vehicle:w.a.shape({make:w.a.shape({name:w.a.string}),model:w.a.shape({name:w.a.string})})},Sa.defaultProps={className:"",isLicensePlate:!1,isAddressToVinEnabled:!1,isOptimizedTraffic:!1,vehicle:{},updateVinAndContinue:b.a,onPartnerOfferVinEligibilityUpdate:b.a,setVinFromDrawerSquishStyles:b.a,updateStepsState:b.a,isEligibleHardcodeYmmBypass:!1};var Ta=a("./site-modules/shared/components/link/link.jsx"),Ia=a("./site-modules/shared/utils/appraisal-link-constructor.js"),_a=a("./site-modules/shared/constants/appraisal/paths.js");const Na={LICENSE_PLATE:{id:Kt.LICENSE_PLATE,label:"License Plate"},VIN:{id:Kt.VIN,label:"VIN"}},Oa={LICENSE_PLATE_TAB_FIRST:[Na.LICENSE_PLATE,Na.VIN],VIN_TAB_FIRST:[Na.VIN,Na.LICENSE_PLATE]},Pa=(e,t)=>!!e||!t,Aa=(e,t)=>Pa(e,t)?Oa.VIN_TAB_FIRST:Oa.LICENSE_PLATE_TAB_FIRST;class xa extends x.Component{constructor(e){var t;t=super(e),this.setActiveStepSquishVinInvalidation=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],a=arguments.length>1?arguments[1]:void 0,s=arguments.length>2?arguments[2]:void 0;const i=t.props.activeTabId;t.setState(n=>{let r=n.errorMap;if(e.length>=1){const n=t.generateSquishVinErrorMessage(s||i,e,a),o=n.id,l=n.message;r.set(o,l)}else t.setMismatchError(s||i);return{errorMap:r}})},this.setMismatchError=(e=>{const t=this.getVehicleMMY(),a=t.makeName,s=t.modelName,i=t.year,n=this.state.errorMap,r=e===Kt.VIN?"VIN":"license plate",o=`${e}_${Xt.SQUISH_VIN}`;n.set(o,k.a.createElement(x.Fragment,null,"The ",r," provided does not belong to a ",i," ",a," ",s,". Click"," ",k.a.createElement(Ta.a,{className:"text-primary-darker text-decoration-underline",to:_a.b.APPRAISAL_LANDING,"data-tracking-id":"correct_squish_vin_secondary"},"here")," ","to correct your vehicle information and re-appraise your car. ",k.a.createElement(Gt.a,null)))}),this.getVehicleMMY=(()=>{const e=this.props.vehicle;return{makeName:T()(e,"make.name",""),modelName:T()(e,"model.name",""),year:T()(e,"year.year","")}}),this.getCtaText=(()=>{const e=this.props,t=e.isEscapeHatch,a=e.isEscapeHatchDrawer,s=e.isLocationStyleStep;return t?"VIEW OFFER NOW":a?"Get My Offer":s?"Continue":"See Your Car's Value"}),this.generateSquishVinErrorMessage=((e,t,a)=>{const s=this.getVehicleMMY(),i=s.makeName,n=s.modelName,r=s.year,o=t[0],l=o.makeName,c=o.modelName,d=o.makeNiceId,p=o.modelNiceId,m=o.year,u=e===Kt.VIN?"VIN":"license plate";return{id:`${e}_${Xt.SQUISH_VIN}`,message:k.a.createElement(x.Fragment,null,"You're appraising a ",r," ",i," ",n," but it looks like this ",u," is associated to a ",m," ",l," ",c,". Click"," ",k.a.createElement(Ta.a,{className:"text-primary-darker text-decoration-underline",to:Object(Ia.b)({make:d,model:p,year:m,queryParams:{vin:a}}),"data-tracking-id":"correct_squish_vin"},"here")," ","to appraise that vehicle instead. ",k.a.createElement(Gt.a,null))}}),this.updateTabs=(()=>{const e=this.props,t=e.queryVin,a=e.isMobile;this.setState({tabs:Pa(t,a)?Oa.VIN_TAB_FIRST:Oa.LICENSE_PLATE_TAB_FIRST})}),this.updateVinMismatchForceError=((e,t)=>{this.setState(a=>{let s=a.errorMap;return e?(this.fireSquishVinTracking({isSquishVinValid:!e,squishStyles:t},this.props.vin),this.setActiveStepSquishVinInvalidation(t,this.props.vin,Kt.VIN)):this.clearMismatchError(Kt.VIN),{errorMap:s,forceError:e}})}),this.clearMismatchError=(e=>{const t=this.state.errorMap,a=`${e}_${Xt.SQUISH_VIN}`;t.has(a)&&t.delete(a)}),this.triggerEpoVinError=(()=>{const e=new Map;return e.set(ce.d,"Invalid VIN"),this.props.updateErrorMapAndScrollToInvalid(e)}),this.clearActiveStepValidations=(()=>this.setState(e=>{let t=e.errorMap;const a=this.props.activeTabId,s=`${a}_${Xt.VIN_ELIGIBILITY}`;return this.clearMismatchError(a),t.has(s)&&t.delete(s),{errorMap:t}},this.triggerEpoVinError)),this.handleVin=((e,t)=>{const a=this.props,s=a.onPartnerOfferVinEligibilityUpdate,i=a.updateVinAndContinue,n=a.onActiveInventoryCheck,r=a.creativeId,o=a.trackVinEntry,l=a.updateStepsState,c=a.isLocationStyleStep,d=t.isEligibleVin,p=t.isSquishVinValid,m=t.squishStyles;this.clearActiveStepValidations(),this.fireSquishVinTracking(t,e),!p||C()(m)&&c?this.setActiveStepSquishVinInvalidation(m,e):(o(e,r),s(d),Object(ia.a)(e,r,n),i(e),l("isVinFromDrawer",!0),ee.a.fireCustomEvent(ya,{}))}),this.fireSquishVinTracking=((e,t)=>{let a=e.isSquishVinValid,s=e.squishStyles;const i={event_type:J.b.EVENT_TYPE_ACTION_PROGRESS,event_data:{action_name:J.b.ACTION_APPRAISE_VEHICLE,subaction_name:J.b.SUBACTION_SQUISHVIN_DECODE,action_category:J.b.SYSTEM_ACTION_CATEGORY,action_cause:J.b.ACTION_CAUSE_USER_INPUT,creative_id:this.props.creativeId,value:J.b.MMY_NOT_FOUND}};s.length&&(ee.a.fireTrackAction(Object(n.a)({},i,{event_data:Object(n.a)({},i.event_data,{value:s.length>1?J.b.MMY_MANY_FOUND:J.b.MMY_ONE_FOUND})})),i.event_data.value=a?J.b.MMY_MATCH:J.b.MMY_MISMATCH,i.event_data.subaction_name=J.b.SUBACTION_SQUISHVIN_VALIDATION),ee.a.fireTrackAction(i),[J.b.MMY_NOT_FOUND,J.b.MMY_MISMATCH].includes(i.event_data.value)&&ee.a.fireTrackAction(Object(n.a)({},i,{event_data:Object(n.a)({},i.event_data,{subaction_name:J.b.SUBACTION_VIN_ERROR,value:`${t}_${i.event_data.subaction_name}_${i.event_data.value}`})}))}),this.updateVin=(async e=>{await this.props.updateVinAndContinue(e,!0)}),this.state={tabs:Aa(e.queryVin,e.isMobile),errorMap:new Map,forceError:!1}}componentDidUpdate(e){const t=this.props,a=t.isVinFromDrawer,s=t.hasVinMismatchError,i=t.vinFromDrawerSquishStyles,n=t.trackVinEntry,r=t.vin,o=t.queryVin,l=t.vehicle;a&&r&&!u()(a,e.isVinFromDrawer)&&(this.props.setVinTabActive(),i.length&&!s&&n(r,G.K)),u()(s,e.hasVinMismatchError)&&(!s||u()(i,e.vinFromDrawerSquishStyles))&&ue(e.vehicle,l)||this.updateVinMismatchForceError(s,i),o&&!u()(e.queryVin,o)&&this.updateTabs()}render(){const e=this.props,t=e.onValueChange,a=e.isMobile,s=e.vehicle,i=e.queryVin,n=e.clearVin,r=e.isPartnerOfferEligibleVin,o=e.creativeId,l=e.vin,c=e.isEscapeHatch,d=e.isSecondary,p=e.isEligibleHardcodeYmmBypass,m=e.isStepActive,u=e.isVinFromDrawer,h=e.isEscapeHatchDrawer,g=e.activeTabId,f=e.tabContentModal,b=e.setVinTabActive,E=e.setActiveTab,y=e.vinTabLink,v=e.isFullWidth,C=e.isLocationStyleStep,S=e.hideVinLicensePlateBtn,T=e.isLicencePlateAndVinStep,I=e.isAddressToVinEnabled,_=e.updateStepsState,N=e.isAllowedToPredefineVin,O=this.state,P=O.errorMap,A=O.forceError,V=O.tabs,w=!(i||c||u||h||C);return k.a.createElement(x.Fragment,null,w&&k.a.createElement("div",{className:"epo-license-plate-and-vin-tab-buttons d-flex mb-1"},k.a.createElement("span",{className:"medium text-gray-darker font-weight-bold d-inline-block pb-0_5 mr-0_5"},"Enter by:"),k.a.createElement(_t.a,{size:"md",role:"tablist"},V.map((e,t)=>{let a=e.id,s=e.label;return k.a.createElement(Nt.a,{key:a,label:s,tabId:a,isActive:a===g,onBtnClick:E,isFirstItem:0===t,isAppraisalValuePage:!0,isEscapeHatch:c})}))),k.a.createElement(At.a,{activeTab:g,className:"epo-license-plate-and-vin-tab-content"},V.map(e=>{let g=e.id;return k.a.createElement(kt.a,{tabId:g,key:`tab-${g}`,"data-test":`tab-${g}`},k.a.createElement(Vt.a,null,k.a.createElement(sa,{tabId:g,isMobile:a,vehicle:s,creativeId:o,onCompleteCallback:this.handleVin,clearVin:n,tabContentModal:f(g),isPartnerOfferEligibleVin:r,errors:P,forceError:A,triggerEpoVinError:this.triggerEpoVinError,onValueChange:t,useUniqId:!T||d||h,isSecondary:d,isEligibleHardcodeYmmBypass:p,isEscapeHatch:c,queryVin:i,vin:l,setVinTabActive:b,ctaText:this.getCtaText(),isStepActive:m,isVinFromDrawer:u,isEscapeHatchDrawer:h,isLocationStyleStep:C,vinTabLink:y,isFullWidth:v,hideVinLicensePlateBtn:S,isAddressToVinEnabled:I,updateStepsState:_,isAllowedToPredefineVin:N})))})))}}xa.propTypes={vehicle:w.a.shape({make:w.a.shape({name:w.a.string}),model:w.a.shape({name:w.a.string}),year:w.a.shape({year:w.a.string})}).isRequired,clearVin:w.a.func.isRequired,updateErrorMapAndScrollToInvalid:w.a.func.isRequired,onPartnerOfferVinEligibilityUpdate:w.a.func.isRequired,onActiveInventoryCheck:w.a.func.isRequired,updateVinAndContinue:w.a.func.isRequired,isMobile:w.a.bool,creativeId:w.a.string,onValueChange:w.a.func,isStepActive:w.a.bool,isSecondary:w.a.bool,isEligibleHardcodeYmmBypass:w.a.bool,queryVin:w.a.string,vin:w.a.string,isPartnerOfferEligibleVin:w.a.bool,isEscapeHatch:w.a.bool,isVinFromDrawer:w.a.bool,activeTabId:w.a.string,tabContentModal:w.a.func,updateStepsState:w.a.func,trackVinEntry:w.a.func,setVinTabActive:w.a.func,setActiveTab:w.a.func,vinTabLink:w.a.node,isEscapeHatchDrawer:w.a.bool,isLocationStyleStep:w.a.bool,isLicencePlateAndVinStep:w.a.bool,isFullWidth:w.a.bool,hasVinMismatchError:w.a.bool,hideVinLicensePlateBtn:w.a.bool,isAddressToVinEnabled:w.a.bool,isAllowedToPredefineVin:w.a.bool,vinFromDrawerSquishStyles:w.a.arrayOf(w.a.shape({}))},xa.defaultProps={isMobile:!1,isEligibleHardcodeYmmBypass:!1,queryVin:"",vin:"",updateStepsState:b.a,trackVinEntry:b.a,isPartnerOfferEligibleVin:!1,creativeId:G.B,onValueChange:void 0,isStepActive:!1,isSecondary:!1,isEscapeHatch:!1,isVinFromDrawer:!1,hasVinMismatchError:!1,activeTabId:"",tabContentModal:b.a,setVinTabActive:b.a,setActiveTab:b.a,vinTabLink:null,isEscapeHatchDrawer:!1,isLocationStyleStep:!1,isLicencePlateAndVinStep:!1,isFullWidth:!1,hideVinLicensePlateBtn:!1,isAddressToVinEnabled:!1,isAllowedToPredefineVin:!0,vinFromDrawerSquishStyles:[]};var ka=a("./site-modules/shared/components/appraisal/appraisal-tabs-container/appraisal-tabs-container.jsx");class Va extends x.Component{constructor(){super(...arguments),this.state={isLoaded:!1,isHiddenVinLicensePlateBtn:!1,hasVinMismatchError:!1,activeTabId:ka.c},this.onSelect=((e,t,a,s,i)=>{const n=this.props,r=n.onDropdownsSelect,o=n.vin,l=n.vinStyles,c=n.checkVinMismatchError;r(e,t,a,s,i),o&&c(l)}),this.setVinMismatchError=(()=>this.setState({hasVinMismatchError:!0})),this.setLoaded=(()=>{this.setState(()=>({isLoaded:!0}))}),this.setActiveTab=(e=>this.setState({activeTabId:e})),this.setVinTabActive=(()=>{this.setActiveTab(ka.g)}),this.setMmyTabActive=(()=>{this.setActiveTab(ka.c)}),this.unsetVinMismatchError=(()=>this.setState({hasVinMismatchError:!1})),this.checkIsMmyTabActive=(()=>this.state.activeTabId===ka.c),this.hideVinLicensePlateBtn=(()=>this.setState({isHiddenVinLicensePlateBtn:!0})),this.showVinLicensePlateBtn=(()=>this.setState({isHiddenVinLicensePlateBtn:!1})),this.handleTabLinkClick=(e=>{const t=e.currentTarget.dataset.tabId;this.setActiveTab(t)}),this.componentDidUpdateEval3460Chal1=(e=>{const t=this.props,a=t.vinStyles,s=t.isProfileOfferVinPrepopulationEnabled,i=t.checkVinMismatchError,n=this.state.hasVinMismatchError,r=a&&!u()(e.vinStyles,a);r&&a.length&&!n&&s&&this.hideVinLicensePlateBtn(),r&&s&&i(a),this.props.hasVinMismatchError!==n&&s&&(this.props.hasVinMismatchError?(this.setVinMismatchError(),this.showVinLicensePlateBtn()):(this.unsetVinMismatchError(),a&&a.length&&this.hideVinLicensePlateBtn()))}),this.trackVinEntry=(e=>{ee.a.fireTrackAction({event_type:J.b.EVENT_TYPE_ACTION_PROGRESS,event_data:{action_name:J.b.ACTION_APPRAISE_VEHICLE,action_category:J.b.USER_ACTION_CATEGORY,action_cause:J.b.ACTION_CAUSE_USER_INPUT,subaction_name:J.b.SUBACTION_VIN_ENTRY,creative_id:"edm-entry-appraisal-step-1",value:e}})})}componentDidMount(){ee.a.domReady(()=>this.setLoaded())}componentDidUpdate(e,t){const a=this.props,s=a.vinStyles,i=a.isProfileOfferVinPrepopulationEnabled,n=this.state.activeTabId,r=s&&!u()(e.vinStyles,s);this.componentDidUpdateEval3460Chal1(e),r&&!i&&(s.length?(this.hideVinLicensePlateBtn(),this.unsetVinMismatchError()):this.setVinMismatchError()),u()(n,t.activeTabId)||(this.checkIsMmyTabActive()?this.hideVinLicensePlateBtn():C()(s)&&this.showVinLicensePlateBtn())}render(){const e=this.props,t=e.isZipCodeValid,a=e.onZipCodeChange,s=e.selectStyle,i=e.zipCode,n=e.estimatedVehicle,r=e.errorMap,o=e.isMobile,l=e.updateStepsState,c=e.vehicle,d=e.vin,p=e.isPartnerOfferEligibleVin,m=e.updateErrorMapAndScrollToInvalid,h=e.onPartnerOfferVinEligibilityUpdate,g=e.onActiveInventoryCheck,f=e.isEligibleHardcodeYmmBypass,b=e.isStepActive,E=e.updateVinAndContinue,y=e.clearVin,v=e.changeStep,C=e.isLoadingColorsAndOptions,S=e.isProfileOfferVinPrepopulationEnabled,T=e.queryVin,I=e.isAllowedToPredefineVin,_=this.props.vinStyles?this.props.vinStyles:[],N=c.make,O=c.model,P=c.year,A=this.state,x=A.isLoaded,V=A.activeTabId,w=A.isHiddenVinLicensePlateBtn,j=A.hasVinMismatchError,R=!!n,M=r.get(ce.f),D=r.get(ce.h),L=r.get(ce.l),U=r.get(ce.j),z=_.map(e=>e.styleId).join(),B=1===_.length;let $="";B&&($=_[0].styleName);const Y=this.checkIsMmyTabActive(),H=_.length>1,Z=x?"See your car\u2019s value":"Loading...",W=x?"Continue":"Loading...";return k.a.createElement("div",{className:"location-and-style-step"},k.a.createElement(F.a,null,k.a.createElement(q.a,{xs:12,className:"px-0 mb-1"},k.a.createElement(_t.a,{size:"md",role:"tablist"},ka.d.DEFAULT.map((e,t)=>{let a=e.id,s=e.label;return k.a.createElement(Nt.a,{key:a,label:s,tabId:a,isActive:a===V,onBtnClick:this.setActiveTab,isFirstItem:0===t,isAppraisalValuePage:!0})})))),!Y&&k.a.createElement(F.a,null,k.a.createElement(q.a,{xs:12,md:6,className:"px-0"},k.a.createElement(vt.a,{isZipCodeValid:t,onZipCodeChange:a,zipCode:i,zipClassName:"pr-md-1 mb-0",errorMap:r,disabled:!x,zipWrapperClassName:"mb-1"}))),k.a.createElement(F.a,null,k.a.createElement(q.a,{xs:12,md:V===ka.g?6:12,lg:V===ka.g?6:12},k.a.createElement(xa,{activeTabId:V,vehicle:c,creativeId:G.c,setActiveTab:this.setActiveTab,clearVin:y,isPartnerOfferEligibleVin:p,updateErrorMapAndScrollToInvalid:m,onPartnerOfferVinEligibilityUpdate:h,updateVinAndContinue:E,onActiveInventoryCheck:g,onValueChange:this.showVinLicensePlateBtn,useUniqId:!0,isMobile:o,updateStepsState:l,isSecondary:!0,isEligibleHardcodeYmmBypass:f,hideVinLicensePlateBtn:w,queryVin:T,vin:d,isVinFromDrawer:!!d&&!I&&!u()(d,T),trackVinEntry:this.trackVinEntry,isStepActive:b,isLocationStyleStep:!0,isFullWidth:!0,hasVinMismatchError:j,vinFromDrawerSquishStyles:_,isAllowedToPredefineVin:I,vinTabLink:k.a.createElement(Ot.a,{classNames:"text-decoration-underline",onClick:this.setVinTabActive,tabLink:ka.f})}),!j&&!!_.length&&w&&!Y&&k.a.createElement(F.a,{className:Me()("size-14",{"mb-1_5":!B})},k.a.createElement(q.a,{xs:12,className:"px-0"},k.a.createElement("div",{className:"font-weight-medium"},P.year," ",N.name," ",O.name),k.a.createElement("div",null,$))))),k.a.createElement(F.a,null,k.a.createElement(q.a,{xs:12,className:"px-0"},k.a.createElement(yt.a,{tag:"div",showAllSubmodels:R,hasModel:!0,hasYear:!0,hasStyle:!0,vehicle:n,selectStyle:s,hasOptionTruncate:!1,inputClasses:"form-control pr-2 w-100 mmy-select input-content",makeLabel:"Make",modelLabel:"Model",yearLabel:"Year",styleLabel:"Style",labelClassName:"small mb-0_25",errorMessageClassNames:"mt-0_5",makeDropdownClassNames:Me()("has-right-padding mb-1 p-0 pr-md-0_75 pr-lg-1",{"d-none":!Y}),modelDropdownClassNames:Me()("mb-1 p-0 pl-md-0_75 pl-lg-1",{"d-none":!Y}),submodelDropdownClassNames:Me()("mb-1 p-0 pl-md-0_75 pl-lg-1",{"d-none":!Y}),yearDropdownClassNames:Me()("has-right-padding mb-1 mb-md-0 p-0 pr-md-0_75 pr-lg-1",{"d-none":!Y}),styleDropdownClassNames:Me()("p-0",{"d-none":!Y&&(!H||!w||j),"mb-0 pl-lg-1 pl-md-0_75 pos-r style-dropdown-error-gutter":Y,"mt-1 mt-md-0 has-right-padding pr-lg-1 pr-md-0_75 col-12 col-md-6":!Y}),buttonGroupClassNames:"d-none",onDropdownsSelect:this.onSelect,errorMake:M,errorModel:D,errorYear:L,errorStyle:U,pubStatesYears:G.a,isMobile:o,updateStepsState:l,disabled:!x,enableSpinner:!0,styleIds:z,showFindStyleLink:Y,isProfileOfferVinPrepopulationEnabled:S,isStyleIdQueryParamEnabled:!_.length||_.length>1,isStyledSelects:!0}))),Y&&!o&&k.a.createElement(F.a,null,k.a.createElement(q.a,{xs:12,md:6,className:"px-0 mt-1"},k.a.createElement(vt.a,{isZipCodeValid:t,onZipCodeChange:a,zipCode:i,zipClassName:"pr-md-1 mb-0 mmy-zip-code",errorMap:r,disabled:!x}))),Y&&o&&k.a.createElement(F.a,null,k.a.createElement(q.a,{xs:4,md:6,className:"px-0 mt-2 mt-md-3"},k.a.createElement(vt.a,{isZipCodeValid:t,onZipCodeChange:a,zipCode:i,zipClassName:"pr-md-0_75 mb-0",errorMap:r,disabled:!x,labelClassName:"icon-location text-primary-darker ml-0_75",inputClassName:"pl-2",isMobile:!0,zipWrapperClassName:"mb-0"})),k.a.createElement(q.a,{xs:7,md:6,lg:4,className:"px-0 mt-2 mt-md-3 ml-auto pl-md-0_75"},k.a.createElement(ct.a,{type:"submit",onClick:v,"data-index":G.m,"data-tracking-id":G.i[G.F],color:"success",className:Me()("heading-5 text-white py-0_5 form-button text-transform-none pos-r d-block w-100",G.r),disabled:!x||C},C&&k.a.createElement("span",{className:"pr-0_5"},k.a.createElement(gt.a,{size:14,thickness:1,color:"white"})),"Continue"))),(Y&&!o||w&&(!Y||!o))&&k.a.createElement(F.a,{className:Me()("mt-2",{"mt-md-2_5":Y})},k.a.createElement(q.a,{xs:12,md:4,lg:5,xl:4,className:"px-0"},k.a.createElement(ct.a,{type:"submit",onClick:v,"data-index":G.m,"data-tracking-id":G.i[G.F],color:"success",className:Me()("heading-5 text-white py-0_5 form-button text-transform-none pos-r d-block w-100",G.r),disabled:!x||C},C&&k.a.createElement("span",{className:"pr-0_5"},k.a.createElement(gt.a,{size:14,thickness:1,color:"white"})),Y?W:Z)),!Y&&k.a.createElement(q.a,{xs:12,md:4},k.a.createElement(ct.a,{type:"submit",color:"link",onClick:this.setMmyTabActive,className:Me()("heading-5 text-primary-darker py-0 text-transform-none d-block py-0_5 font-weight-normal mx-auto mx-md-0 mt-1 mt-md-0"),disabled:!x},"Not my vehicle"))),!Y&&k.a.createElement(F.a,null,k.a.createElement(q.a,{xs:12,md:8,className:"appraisal-tab-link-copy text-gray-dark size-14 mt-1_5 bg-gray-extra-light rounded p-1 tab-info",role:"tablist"},k.a.createElement("div",{className:"font-weight-bold text-primary-darker"},"Did you know?"),k.a.createElement("div",null,k.a.createElement("span",null,"By entering your "),k.a.createElement(Ot.a,{onClick:this.handleTabLinkClick,tabLink:ka.e[V].FIRST})," or ",k.a.createElement(Ot.a,{onClick:this.handleTabLinkClick,tabLink:ka.e[V].SECOND}),k.a.createElement("span",null,", you\u2019ll get a more accurate appraisal that may raise your car's value.")))))}}Va.propTypes={isZipCodeValid:w.a.bool.isRequired,onZipCodeChange:w.a.func.isRequired,onDropdownsSelect:w.a.func.isRequired,updateStepsState:w.a.func,selectStyle:w.a.bool,isMobile:w.a.bool,zipCode:w.a.string,vin:w.a.string,estimatedVehicle:te.b.StyleWithoutSubmodels,vehicle:w.a.shape({}),errorMap:w.a.objectOf(w.a.string),vinStyles:w.a.arrayOf(w.a.shape({})),isPartnerOfferEligibleVin:w.a.bool,isEligibleHardcodeYmmBypass:w.a.bool,isStepActive:w.a.bool,updateErrorMapAndScrollToInvalid:w.a.func,onPartnerOfferVinEligibilityUpdate:w.a.func,onActiveInventoryCheck:w.a.func,updateVinAndContinue:w.a.func,clearVin:w.a.func,changeStep:w.a.func,isLoadingColorsAndOptions:w.a.bool,isProfileOfferVinPrepopulationEnabled:w.a.bool,hasVinMismatchError:w.a.bool,isAllowedToPredefineVin:w.a.bool,queryVin:w.a.string,checkVinMismatchError:w.a.func},Va.defaultProps={zipCode:"",vin:"",estimatedVehicle:null,vehicle:{},selectStyle:!1,isStepActive:!1,isMobile:!1,errorMap:new Map,updateStepsState:b.a,vinStyles:null,isPartnerOfferEligibleVin:!1,isEligibleHardcodeYmmBypass:!1,updateErrorMapAndScrollToInvalid:b.a,onPartnerOfferVinEligibilityUpdate:b.a,onActiveInventoryCheck:b.a,updateVinAndContinue:b.a,clearVin:b.a,changeStep:b.a,isLoadingColorsAndOptions:!1,isProfileOfferVinPrepopulationEnabled:!1,hasVinMismatchError:!1,isAllowedToPredefineVin:!0,queryVin:"",checkVinMismatchError:b.a};const wa={vinStyles:Object($.a)(e=>Object(ae.d)(e),ae.b)},ja=Object($.b)(Va,wa);var Ra=a("../node_modules/lodash/uniqBy.js"),Ma=a.n(Ra),Da=a("./site-modules/shared/utils/collapse-utils.jsx"),La=a("./site-modules/shared/utils/inventory/search-filter.js"),Fa=a("./site-modules/shared/utils/inventory/tracking.js"),Ua=a("./site-modules/shared/utils/inventory-utils/build-filter-pixel-value.js");function qa(e){let t=e.selected,a=e.classes;return k.a.createElement("span",{className:Me()("d-inline-block checkbox",a,{"icon-checkbox-checked2":t,"icon-checkbox-unchecked2":!t})})}function za(e){let t=e.color;return k.a.createElement("span",{className:"checkbox checkbox-color d-flex justify-content-center align-items-center rounded-circle"},k.a.createElement("span",{className:"rounded-circle",style:{backgroundColor:`rgb(${t})`}}))}qa.propTypes={selected:w.a.bool,classes:w.a.string},qa.defaultProps={selected:!1,classes:"align-self-center"},za.propTypes={color:w.a.string.isRequired};class Ba extends x.Component{constructor(){super(...arguments),this.handleFacetSelect=(()=>{const e=this.props,t=e.onUpdate,a=e.facet,s=e.facetName;t(Object(n.a)({},a,{type:s}),!a.selected)})}render(){const e=this.props,t=e.facet,a=e.disableTracking,i=e.facetName,n=e.hideCount,r=e.hideName,o=e.normalSize,l=e.checkboxClasses,c=e.labelClasses,d=e.showPrice,p=t.name,m=t.count,u=void 0===m?0:m,h=t.selected,g=t.rgb,f=t.value,b=t.price,E=(void 0===b?{}:b).usedTradeIn,y=Object(Ua.a)(i,f,p),v=Object(Fa.a)(y),C=a?null:v;return k.a.createElement("li",{className:"list-unstyled"},k.a.createElement(Ft.a,{className:Me()("checkbox-label pos-r d-flex mb-1 mb-lg-0_5",c),tabIndex:-1},k.a.createElement(qt.a,Object(s.a)({onChange:this.handleFacetSelect,type:"checkbox",className:"input custom-control-input mt-0",checked:!!h,tabIndex:0},C)),g?k.a.createElement(za,{color:g}):k.a.createElement(qa,{classes:l,selected:h}),!r&&k.a.createElement("span",{className:Me()("name mr-0_25",{"ml-0_75":!g&&!o,"ml-1_5":g||o,small:!o})},p),!n&&k.a.createElement("span",{className:"xsmall"},"(",Object(Qe.c)(u),")"),d&&E&&k.a.createElement("span",{className:"ml-0_75"},Object(We.a)(E))))}}Ba.propTypes={facet:w.a.shape({}).isRequired,onUpdate:w.a.func.isRequired,hideCount:w.a.bool,hideName:w.a.bool,disableTracking:w.a.bool,normalSize:w.a.bool,showPrice:w.a.bool,facetName:w.a.string.isRequired,checkboxClasses:w.a.string,labelClasses:w.a.string},Ba.defaultProps={hideCount:!1,hideName:!1,disableTracking:!1,showPrice:!1,normalSize:!1,checkboxClasses:"",labelClasses:""};a("./site-modules/shared/components/filter-facets/facet-checkbox/facet-checkbox.scss");const $a=[];class Ya extends x.Component{constructor(){super(...arguments),this.state={collapse:!1},this.toggleCollapse=(()=>{this.setState(e=>({collapse:!e.collapse}))}),this.renderCheckbox=(e=>{const t=e.value,a=e.id,s=e.name,i=this.props,n=i.onUpdate,r=i.hideCount,o=i.facetName,l=i.disableTracking,c=i.normalSize,d=i.checkboxClasses,p=i.labelClasses,m=i.showPrice,u=t||a||s;return k.a.createElement(Ba,{onUpdate:n,hideCount:r,key:u,facet:e,facetName:o,disableTracking:l,normalSize:c,checkboxClasses:d,labelClasses:p,showPrice:m})})}render(){const e=this.props,t=e.values,a=e.visibleValues,s=e.listClasses,i=e.collapseClasses,n=e.additionalContent,r=e.description,o=e.normalSize,l=e.collapseText,c=e.showCollapseIcon,d=e.combineValues,p=this.state.collapse,m=this.renderCheckbox;let u,h;d?(u=Object(La.b)(t),h=$a):(u=t.slice(0,a),h=t.slice(u.length));const g=Me()("m-0",s,{small:!o}),f=p?l.less:l.more;return k.a.createElement(x.Fragment,null,k.a.createElement("div",{className:"facet-checkbox"},Boolean(u.length)&&k.a.createElement("ul",{className:g},u.map(m)),Boolean(h.length)&&k.a.createElement(Da.a,{isOpen:p},k.a.createElement("ul",{className:g},h.map(m))),(Boolean(h.length)||n)&&k.a.createElement("div",{className:"d-flex px-0_5 px-md-1 mb-0_5 justify-content-between"},Boolean(h.length)&&k.a.createElement("button",{onClick:this.toggleCollapse,className:Me()("show-more border-0 px-0",i,{small:!o})},`${f}`,c&&k.a.createElement("span",{className:Me()("ml-0_25",{"icon-arrow-up3":p,"icon-arrow-down3":!p})})),n)),r&&k.a.createElement("div",{className:"small px-0_5 px-2_5 px-lg-1 pb-0_5"},r))}}Ya.propTypes={values:w.a.arrayOf(w.a.shape({name:w.a.string.isRequired,value:w.a.string,id:w.a.string,count:w.a.number,selected:w.a.bool,price:w.a.shape({})})),collapseText:w.a.shape({}),visibleValues:w.a.number,onUpdate:w.a.func.isRequired,hideCount:w.a.bool,disableTracking:w.a.bool,normalSize:w.a.bool,showCollapseIcon:w.a.bool,showPrice:w.a.bool,combineValues:w.a.bool,listClasses:w.a.string,checkboxClasses:w.a.string,labelClasses:w.a.string,collapseClasses:w.a.string,description:w.a.string,facetName:w.a.string.isRequired,additionalContent:w.a.element},Ya.defaultProps={values:[],visibleValues:4,hideCount:!1,disableTracking:!1,normalSize:!1,showCollapseIcon:!1,showPrice:!1,combineValues:!1,listClasses:"px-0_5 px-md-1",checkboxClasses:"",labelClasses:"",collapseClasses:"text-gray-dark",description:"",collapseText:{less:"show less",more:"show more"},additionalContent:null};var Ha=a("./site-modules/shared/components/color-feature-list-smart/color-feature-list-smart.jsx");a("./site-modules/shared/components/color-list-smart-v2/color-list-smart-v2.scss");function Za(e){let t=e.name,a=e.rgb,s=e.opacity,i=e.onClick,n=e.className,r=e.isSelected,o=e.isDisabled,l=e.trackingId,c=e.trackingValue;const d="transparent"===a;return k.a.createElement("label",{htmlFor:`color-item-${t}`,className:n},k.a.createElement("div",{className:Me()("color-item-ring rounded-circle mx-auto p-0_25",{"color-ring-selected":r})},k.a.createElement("input",{id:`color-item-${t}`,className:Me()("color-item d-flex rounded-circle mx-auto",{"color-item-selected":r},{"color-item-btn":i},{"unknown-color":d},{disabled:o}),style:{backgroundColor:s?`rgba(${a},${s})`:`rgb(${a})`},name:"color",title:t,type:"checkbox","aria-label":t,onClick:i,"data-tracking-id":l,"data-tracking-value":c,disabled:o})),k.a.createElement("div",{className:Me()("size-12 color-item-name pos-r",{"font-weight-bold":r})},t))}Za.propTypes={name:w.a.string.isRequired,rgb:w.a.string.isRequired,onClick:w.a.func.isRequired,isSelected:w.a.bool.isRequired,opacity:w.a.string,className:w.a.string,isDisabled:w.a.bool,trackingId:w.a.string,trackingValue:w.a.string},Za.defaultProps={opacity:null,className:"my-0_25 mx-0_5",isDisabled:!1,trackingId:null,trackingValue:null};const Ga=e=>{let t=e.listItems,a=e.selectedItems,i=e.keyPrefix,n=e.itemClassName,r=e.className,o=e.onClick,l=e.showCheckmark,c=e.ariaDescribedBy,d=e.ariaInvalid;const p=t.some(e=>"transparent"===T()(e,"properties.rgb"));return k.a.createElement(x.Fragment,null,p&&k.a.createElement("span",{className:"d-flex align-items-center size-14"},k.a.createElement("i",{className:"icon-notification2 mr-0_5"}),"Some color swatches are unavailable"),k.a.createElement(F.a,Object(s.a)({className:Me()("color-list-smart-v2 mt-1",r)},d&&c?{"aria-describedby":c,"aria-invalid":!0}:{}),t.map(e=>{let t=e.name,s=e.properties,r=e.price,c=e.disabled,d=e.trackingId,p=e.trackingValue;const m=T()(s,"rgb"),u=T()(s,"opacity"),h=T()(r,"baseMSRP",0);return m?k.a.createElement(q.a,{xs:4,md:3,className:"text-center mb-2",key:`${i} ${t} (${m})`},k.a.createElement(Za,{rgb:m,opacity:u,name:t,baseMSRP:h,onClick:o,className:n,isSelected:!!a[t],isDisabled:c,showCheckmark:l,trackingId:d,trackingValue:p})):null})))};Ga.propTypes={itemClassName:w.a.string,listItems:w.a.arrayOf(w.a.shape({name:w.a.string,properties:w.a.shape({rgb:w.a.string,opacity:w.a.string}),price:w.a.shape({baseMSRP:w.a.number}),disabled:w.a.bool,trackingId:w.a.string,trackingValue:w.a.string})).isRequired,keyPrefix:w.a.string,selectedItems:w.a.shape({}),className:w.a.string,onClick:w.a.func.isRequired,showCheckmark:w.a.bool,ariaDescribedBy:w.a.string,ariaInvalid:w.a.bool},Ga.defaultProps={keyPrefix:"",itemClassName:"",selectedItems:{},className:"",showCheckmark:!0,ariaDescribedBy:"",ariaInvalid:!1};const Wa=Object(Ha.a)(Ga,"color"),Qa="--";const Ka={v3ColorsAndOptions:Object($.a)(e=>{return((e,t)=>{const a=T()(e,"style.id");return a?`styles.${a}.${t}`:""})(e.vehicle,"colorsAndOptions")},te.c)},Xa=Object($.b)(function(e){let t=e.v3ColorsAndOptions,a=e.optionsFromGraphQlWithPrice,s=e.vehicle;const n=Object(x.useState)(!1),r=Object(i.a)(n,2),o=r[0],l=r[1],c=T()(s,"style.id"),d=function(e){const t=Object(x.useRef)();return Object(x.useEffect)(()=>{t.current=e}),t.current}(c);return Object(x.useEffect)(()=>{c!==d&&o&&l(!1);const e=a&&a.length;if(!o&&t&&e){const s=function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).filter(e=>e.price&&(e.price.usedPrivateParty>0||e.price.usedTmvRetail>0||e.price.usedTradeIn>0))}(t.options).length,i=function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).filter(e=>{let t=e.options;return t&&t.length&&t.every(e=>{let t=e.oemCode;return t&&t!==Qa})})}(a);((e,t)=>{l(!0),ee.a.fireTrackAction({event_type:J.b.EVENT_TYPE_ACTION_PROGRESS,event_data:{action_name:J.b.ACTION_APPRAISE_VEHICLE,action_category:J.b.USER_ACTION_CATEGORY,action_cause:J.b.ACTION_CAUSE_BUTTON_CLICK,subaction_name:"v3_graphql_option_delta",creative_id:G.c,value:e}}),ee.a.fireTrackAction({event_type:J.b.EVENT_TYPE_ACTION_PROGRESS,event_data:{action_name:J.b.ACTION_APPRAISE_VEHICLE,action_category:J.b.USER_ACTION_CATEGORY,action_cause:J.b.ACTION_CAUSE_BUTTON_CLICK,subaction_name:"graphql_option_oemcode_delta",creative_id:G.c,value:t}})})(s-e,a.length-i.length)}},[a,o,d,c,t]),null},Ka);a("./site-modules/shared/components/appraisal/trade-in-appraiser-steps/colors-and-options-step/colors-and-options-step.scss");const Ja={AVAILABLE_COLORS_COUNT:"available_colors_count",AVAILABLE_OPTIONS_COUNT:"available_options_count",STYLE_ENGINE_SIZE:"style_engine_size",STYLE_TRANSMISSION_TYPE:"style_transmission_type",STYLE_DRIVETRAIN:"style_drivetrain"};function es(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).filter(e=>e.price&&(e.price.usedPrivateParty>0||e.price.usedTmvRetail>0||e.price.usedTradeIn>0))}function ts(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const a=t.options,s=void 0===a?[]:a,i=t.engineSize,n=t.transmissionType;return{options:s,colors:e,engineSize:i,driveTrain:t.driveTrain,transmissionType:n,selectedColor:{},selectedColorName:""}}function as(e){return e.filter(e=>{let t=e.properties;return t&&t.rgb}).length}class ss extends x.Component{constructor(){super(...arguments),this.state=ts(this.props.colors,this.props.vehicleFeatures),this.getLowestPricedOption=((e,t,a,s,i)=>s.reduce((s,i)=>{let n=s[e],r=s.price;const o=i.options.reduce((s,i)=>{let n=s[e],r=s.price,o=i[t][a],l=i.price.baseMSRP;return l>0&&l<r?{[e]:o,price:l}:{[e]:n,price:r}},{[e]:n,price:r}),l=o[e],c=o.price;return c<r?{[e]:l,price:c}:{[e]:n,price:r}},{[e]:i,price:1/0})[e]),this.getDrawerCreativeId=(()=>{return this.props.drawerCreativeId||G.t}),this.selectedOptionsWithSubOption=((e,t)=>e.map(e=>{const a=e.options.map(e=>{return T()(e,t)?e:null}).filter(e=>e);return a.length?Object(n.a)({},e,{options:a}):null}).filter(e=>e)),this.fireTrackAction=(e=>{let t=e.subactionName,a=e.value;const s=this.props.isExtendedReport?G.c:this.getDrawerCreativeId();ee.a.fireTrackAction({event_type:J.b.EVENT_TYPE_ACTION_PROGRESS,event_data:{action_name:J.b.ACTION_APPRAISE_VEHICLE,action_category:J.b.USER_ACTION_CATEGORY,action_cause:J.b.ACTION_CAUSE_BUTTON_CLICK,subaction_name:t,creative_id:s,value:a}})}),this.handleOptionsSelect=((e,t)=>{const a=[...this.state.options],s=a.findIndex(t=>{return t.id===e.id});a[s].selected=t,this.setState({options:a},()=>{const e=this.state.options.filter(e=>{return e.selected}),t=this.state.options.length;this.props.onOptionsSelect(e,t)})}),this.handleColorSelect=(e=>{const t=e?{[e]:!0}:{};this.setState({selectedColor:t,selectedColorName:e},()=>{const e=this.state,t=e.selectedColorName,a=e.colors.find(e=>{return e.name===t});this.props.onColorSelect(a)})})}static getDerivedStateFromProps(e,t){let a=e.colors,s=e.vehicleFeatures,i=void 0===s?{}:s,n=t.colors,r=t.options,o=void 0===r?[]:r;const l=i.options||[];return!a||!l||u()(a,n)&&(d=o,(c=l)&&d&&c.length===d.length&&c.every((e,t)=>{const a=d[t];return a&&e.id===a.id}))?null:ts(a,i);var c,d}componentDidUpdate(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const a=this.props,s=a.colors,i=a.vehicleFeatures,n=a.onPartnerOfferEligibilityUpdate,r=a.updateStepsState,o=a.isStepActive,l=a.partnerOfferEligibilityResponse,c=a.preSelectedColor,d=a.setLoadingColorsAndOptions,p=a.setChromeStyleIds,m=a.setTranslationTransmissionType,h=a.setTranslationEngineSize,g=a.chromeStyleIds,f=a.isEval3446Chal1Enabled,b=e.partnerOfferEligibilityResponse,E=e.colors,y=e.vehicleFeatures;if(s&&i&&(!u()(i,y)||!u()(s,E))){d(!1);const e=i.options,t=es(void 0===e?[]:e);this.fireTrackAction({subactionName:Ja.AVAILABLE_COLORS_COUNT,value:as(s)}),this.fireTrackAction({subactionName:Ja.AVAILABLE_OPTIONS_COUNT,value:t.length})}const v=this.state,S=v.colors,T=v.selectedColor,I=v.options,_=v.engineSize,N=v.transmissionType,O=v.driveTrain,P=e.isStepActive!==o;if(o&&P&&C()(T)&&c&&c.id){const e=S.find(e=>{return e.id===c.id})||{name:""};this.handleColorSelect(e.name)}if(C()(l)||u()(l,b)||(r("partnerOfferEligibilityResponse",l),n(l.isEligible)),s&&(C()(s)||!as(s))&&i&&C()(i))return;const A=t.engineSize,x=t.transmissionType,k=t.driveTrain,V=(y||{}).options;if(f&&I&&!u()(I,V)){const e=I.filter(e=>{return e.selected}),t=this.selectedOptionsWithSubOption(e,"transmission.transmissionType"),a=this.selectedOptionsWithSubOption(e,"engine.size"),s=this.getLowestPricedOption("transmissionType","transmission","transmissionType",t,N),n=this.getLowestPricedOption("engineSize","engine","size",a,_),r=i||{},o=r.engineSize,l=void 0===o?null:o,c=r.transmissionType,d=void 0===c?null:c;h({engineSize:a.length?n:l,isOverride:!!a.length}),m({transmissionType:t.length?s:d,isOverride:!!t.length})}if(i&&!u()(i,y)){const e=i.options;r("partnerEquipment",(void 0===e?[]:e).map(e=>e.name))}const w=e.chromeStyleIds;u()(g,w)||p(g),A===_&&x===N&&k===O||(this.fireTrackAction({subactionName:Ja.STYLE_ENGINE_SIZE,value:_}),this.fireTrackAction({subactionName:Ja.STYLE_TRANSMISSION_TYPE,value:N}),this.fireTrackAction({subactionName:Ja.STYLE_DRIVETRAIN,value:O}))}render(){const e=this.state,t=e.options,a=e.colors,i=e.selectedColor,n=e.selectedColorName,r=this.props,o=r.isMobile,l=r.colors,c=r.vehicleFeatures,d=r.errorMap,p=r.vehicle,m=T()(c,"options",[]),u=es(t),h=u.length,g=u.slice(0,Math.round(h/2)),f=u.slice(g.length),b={less:"See less",more:"See more"},E=d.get(ce.a),y=`${ce.a}-error-${Object(zt.c)()}`;return k.a.createElement(F.a,{className:"colors-and-options-step text-gray-darker"},k.a.createElement(Xa,{optionsFromGraphQlWithPrice:u,vehicle:p}),!C()(l)&&as(l)||es(m).length?k.a.createElement(x.Fragment,null,k.a.createElement(q.a,{xs:12,className:"px-0 mb-1"},k.a.createElement("div",{className:"font-weight-bold mb-0_5"},"Exterior Color: ",k.a.createElement("span",{className:"font-weight-normal"},n)),k.a.createElement(Wa,Object(s.a)({listItems:a,selectedItems:i,showCheckmark:!1,updateHOCState:this.handleColorSelect},E?{ariaDescribedBy:y,ariaInvalid:!0}:{})),k.a.createElement(Yt.a,{id:y,error:E})),!!h&&k.a.createElement(q.a,{xs:12,className:"px-0"},k.a.createElement("div",{className:"mb-1"},k.a.createElement("div",{className:"font-weight-bold"},"Add Additional Equipment:")),k.a.createElement(F.a,{className:"pl-0_5"},(o?[u]:[g,f]).map((e,t)=>k.a.createElement(q.a,{xs:12,md:6,className:"p-0",key:`equipment-${t}`},k.a.createElement(Ya,{onUpdate:this.handleOptionsSelect,values:e,facetName:"options",listClasses:"options-list p-0 pr-md-0_5",checkboxClasses:"medium",labelClasses:"align-items-baseline",visibleValues:o?6:e.length,collapseText:b,collapseClasses:"text-primary-darker pl-1_25",showCollapseIcon:!0,normalSize:!0,disableTracking:!0,hideCount:!0})))))):k.a.createElement(q.a,{xs:12,className:"display-3 px-0"},"Sorry, we couldn't find any colors and options! Please continue to the next step."))}}ss.propTypes={onOptionsSelect:w.a.func.isRequired,onColorSelect:w.a.func.isRequired,onPartnerOfferEligibilityUpdate:w.a.func.isRequired,updateStepsState:w.a.func.isRequired,isStepActive:w.a.bool.isRequired,colors:te.b.Colors,vehicleFeatures:te.b.VehicleFeatures,isExtendedReport:w.a.bool,isZipCodeValid:w.a.bool,isMobile:w.a.bool,errorMap:w.a.objectOf(w.a.string),vehicle:w.a.shape({}),zipCode:w.a.string,partnerOfferEligibilityResponse:se.a.Eligibility,preSelectedColor:w.a.shape({}),drawerCreativeId:w.a.string,setLoadingColorsAndOptions:w.a.func,setChromeStyleIds:w.a.func,setTranslationTransmissionType:w.a.func,setTranslationEngineSize:w.a.func,chromeStyleIds:w.a.arrayOf(w.a.string),styleId:w.a.string,isEval3446Chal1Enabled:w.a.bool},ss.defaultProps={colors:void 0,vehicleFeatures:void 0,isExtendedReport:!1,isMobile:!1,isZipCodeValid:!1,errorMap:new Map,vehicle:{},zipCode:"",partnerOfferEligibilityResponse:{},preSelectedColor:{},drawerCreativeId:"",setLoadingColorsAndOptions:b.a,setChromeStyleIds:b.a,setTranslationTransmissionType:b.a,setTranslationEngineSize:b.a,chromeStyleIds:[],styleId:"",isEval3446Chal1Enabled:!1};const is={colors:Object($.a)(e=>{return((e,t)=>{const a=T()(e,"style.id");return a?`styles.${a}.${t}`:""})(e.vehicle,"colorsAndOptions")},te.c,function(e){const t=e.colors.sort((e,t)=>{const a=T()(e,"properties.rgb"),s=T()(t,"properties.rgb");return a?s?"transparent"===a?-1:"transparent"===s?1:a===s?0:a<s?-1:1:-1:1});return Ma()(t,"id")}),vehicleFeatures:Object($.a)(e=>{let t=e.vehicle;const a=T()(t,"style.id");return a?Object(te.w)(a):""},te.c),chromeStyleIds:Object($.a)(e=>{let t=e.vehicle,a=e.isEval3446Chal1Enabled;const s=T()(t,"style.id");return s&&a?Object(te.f)(s):""},te.c),partnerOfferEligibilityResponse:Object($.a)(e=>{let t=e.vehicle,a=e.zipCode,s=e.isZipCodeValid,i=e.isExtendedReport,n=e.isStepActive;if(i&&s&&n){const e=T()(t,"make.slug",""),s=T()(t,"model.slug",""),i=T()(t,"style.year",null);return Object(se.e)({make:e,model:s,year:i,zipCode:a})}return null},se.b)},ns=Object(z.c)(e=>({zipCode:T()(e,"visitor.location.zipCode")}))(Object($.b)(ss,is));var rs=a("./site-modules/shared/components/select/select.jsx");a("./site-modules/shared/components/appraisal/trade-in-appraiser-steps/condition-and-mileage-step/condition-and-mileage-step.scss");const os={THRESHOLD:5e3,MIN:100},ls=e=>{return(new Date).getFullYear()-e>=11};function cs(e){const t=new Date,a=t.getFullYear(),s=t.getMonth()+1-2,i=s>0?s:0,n=a-e;return n<0||0===n&&0===i?os.MIN:ls(e)?13e4:12e3*n+1e3*i}function ds(e){let t=e.mileage,a=e.condition,n=e.isMileageValid,r=e.onMileageChange,o=e.onConditionChange,l=e.getMileageRef,c=e.onMileageBlur,d=e.errorMap,p=e.isStepActive,m=e.setChromeStyleSku,u=e.propsChromeStyleSku,h=e.transmissionType,g=e.engineSize,f=e.isTransmissionTypeTranslationOverride,b=e.isEngineSizeTranslationOverride,E=e.make,y=e.model,v=e.year;const C=Object(x.useRef)(null),S=Object(x.useState)(cs(v)),T=Object(i.a)(S,2),I=T[0],_=T[1],N=Object(x.useCallback)(()=>{if(p&&!t&&n){const e=cs(v);_(e),r({target:{value:`${e}`}}),C.current&&C.current.touch()}},[p,t,n,v,r]);Object(x.useEffect)(()=>{p&&(f&&ee.a.fireTrackAction({event_type:J.b.EVENT_TYPE_ACTION_PROGRESS,event_data:{action_name:J.b.ACTION_APPRAISE_VEHICLE,action_category:J.b.USER_ACTION_CATEGORY,action_cause:J.b.ACTION_CAUSE_BUTTON_CLICK,subaction_name:J.b.SUBACTION_STYLE_TRANSMISSION_OVERRIDE,creative_id:G.c,value:h}}),b&&ee.a.fireTrackAction({event_type:J.b.EVENT_TYPE_ACTION_PROGRESS,event_data:{action_name:J.b.ACTION_APPRAISE_VEHICLE,action_category:J.b.USER_ACTION_CATEGORY,action_cause:J.b.ACTION_CAUSE_BUTTON_CLICK,subaction_name:J.b.SUBACTION_STYLE_ENGINE_OVERRIDE,creative_id:G.c,value:g}}))},[g,b,p,f,h]),Object(x.useEffect)(()=>{p&&N()},[p,N]),Object(x.useEffect)(()=>{p&&!a&&o({target:{value:G.n.AVERAGE}})},[p,a,o]);const O=(e=>{const t=Object(x.useRef)();return Object(x.useEffect)(()=>{t.current=e}),t.current})(u);Object(x.useEffect)(()=>{O!==u&&m(u)},[O,u,m]);const P=d.get(ce.g),A=d.get(ce.c),V=`${ce.g}-error-${Object(zt.c)()}`,w=`${ce.c}-error-${Object(zt.c)()}`;return k.a.createElement(F.a,{className:"text-gray-darker condition-and-mileage-step"},k.a.createElement(q.a,{xs:12,md:6},k.a.createElement("div",{className:"mb-1 size-16 font-weight-bold"},"Vehicle Condition"),k.a.createElement("div",{className:Me()("pos-r condition-dropdown custom-select-arrow",{"has-danger":!!A})},k.a.createElement(rs.a,Object(s.a)({isLabelHidden:!0,name:"vehicleCondition",className:"select form-control form-control-lg text-gray-darker size-16 pr-2 condition-select",options:G.q.map(e=>({label:e.title,value:e.title})),value:a,onChange:function(e){let t=e.value;o({target:{value:t}})}},A?{ariaDescribedBy:A,ariaInvalid:!0}:{}))),k.a.createElement(Yt.a,{id:w,error:A,classes:"mt-1"}),k.a.createElement("div",{className:"mt-0_5 size-14 text-gray-dark mb-2_5"},a&&G.q.find(e=>e.title===a).text,k.a.createElement("div",null,a===G.n.DAMAGED&&k.a.createElement("div",{className:"mt-1"},"Sorry,",k.a.createElement(Ta.a,{to:"/",title:"Edmunds.com",className:"mx-0_25"},"Edmunds.com"),'does not provide estimates for damaged vehicles. To derive a value for a "Damaged" vehicle, simply take the "Average" condition and subtract the cost of restoring the vehicle to "Average" condition.',k.a.createElement(ct.a,{color:"link",onClick:function(){o({target:{value:G.n.AVERAGE}})},className:"text-capitalize text-underline text-gray-darker p-0 border-0 align-top ml-0_25"},k.a.createElement("span",{className:"size-14 font-weight-normal"},"Got It"))))),k.a.createElement(ra.a,Object(s.a)({placeholder:"Enter Mileage",type:"string",inputMode:"numeric",pattern:"[0-9]*",id:"mileage",name:"mileage",label:"Mileage",inputClassName:"heading-5 font-weight-normal mileage-field",labelClassName:"mb-1 font-weight-bold text-gray-darker",ref:function(e){l(e),C.current=e},value:t,isValid:!P&&n,onChange:r,onBlur:c},P?{ariaDescribedBy:V,ariaInvalid:!0}:{})),k.a.createElement(Yt.a,{id:V,error:P}),k.a.createElement("div",{className:"mt-0_5 size-14 text-gray-dark"},function(e,t,a,s){const i=e+os.THRESHOLD;return`In your area, the average mileage for a ${t} ${a} ${s} is between ${e>os.THRESHOLD?e-os.THRESHOLD:os.MIN} - ${i} miles.`}(I,v,E,y))))}ds.propTypes={isMileageValid:w.a.bool.isRequired,getMileageRef:w.a.func.isRequired,onConditionChange:w.a.func.isRequired,onMileageChange:w.a.func.isRequired,onMileageBlur:w.a.func.isRequired,isStepActive:w.a.bool,mileage:w.a.string,condition:w.a.string,errorMap:w.a.objectOf(w.a.oneOfType([w.a.string,w.a.node,w.a.func])),setChromeStyleSku:w.a.func,setOptionCodes:w.a.func,propsChromeStyleSku:w.a.string,make:w.a.string,model:w.a.string,year:w.a.oneOfType([w.a.string,w.a.number]),engineSize:w.a.number,transmissionType:w.a.string,isTransmissionTypeTranslationOverride:w.a.bool,isEngineSizeTranslationOverride:w.a.bool},ds.defaultProps={mileage:"",condition:"",errorMap:new Map,setChromeStyleSku:b.a,setOptionCodes:b.a,propsChromeStyleSku:"",isStepActive:!1,make:"",model:"",year:"",engineSize:null,transmissionType:null,isTransmissionTypeTranslationOverride:!1,isEngineSizeTranslationOverride:!1};const ps={propsChromeStyleSku:Object($.a)(e=>{let t=e.isPartnerOfferEligible,a=e.isEligibleHardcodeYmmBypass,s=e.isExtendedReport,i=e.styleId,n=e.chromeStyleIds,r=e.engineSize,o=e.transmissionType,l=e.activeStepId;const c=![G.F,G.m].includes(l);return t&&!a&&s&&c?Object(se.c)({styleId:i,chromeStyleIds:n,transmissionType:o,engineSize:r}):null},se.b)},ms=Object($.b)(ds,ps);var us=a("./site-modules/shared/components/loading-spinner/loading-spinner.jsx"),hs=a("./site-modules/shared/components/image/image.jsx");a("./site-modules/shared/components/appraisal/trade-in-appraiser-steps/appraisal-report-step/appraisal-report-step-head.scss");function gs(e){let t=e.title,a=e.make,s=e.model,i=e.style,n=e.photo,r=e.descriptionValues,o=e.isExtendedReport,l=e.showExteriorColor,c=e.showAddEquipment,d=e.changeStep;const p=Object(Ge.d)({makeSlug:a,modelSlug:s}),m="border-0 p-0 text-transform-none font-weight-normal text-primary-darker btn-link text-left edit-link",u={Exterior:{stepId:G.m,trackingId:"edit_color"},Mileage:{stepId:G.p,trackingId:"edit_mileage"}};return k.a.createElement(x.Fragment,null,k.a.createElement(q.a,{xs:12},k.a.createElement("div",{className:"heading-4"},t),k.a.createElement("div",{className:"text-gray-darker"},i)),k.a.createElement(q.a,{xs:12,md:o?5:6},k.a.createElement(Ta.a,{className:Me()("d-block my-0_75 text-center",{"text-md-left":o}),to:p,target:"_blank"},k.a.createElement(hs.a,{imageId:n,className:Me()("img-fluid",{rounded:o}),alt:t,source:Ze.d.MEDIA}))),o&&k.a.createElement(q.a,{xs:12,md:7,className:"pt-md-0_5"},r.map(e=>{let t=e.title,a=e.value,s=e.isTotal;return("Exterior"!==t||"Exterior"===t&&l)&&k.a.createElement("div",{key:t,className:"text-info pb-0_5"},k.a.createElement("span",null,t,":"),k.a.createElement("span",{className:"pl-0_25"},s?k.a.createElement(x.Fragment,null,Object(We.a)(a),k.a.createElement("div",{className:"small"},"As of ",He()(Date.now(),"longDate"))):a),(e=>{const t=u[e];return t?k.a.createElement("span",{className:"pl-0_5 size-14"},"(",k.a.createElement(ct.a,{onClick:d,className:m,"data-tracking-id":t.trackingId,"data-index":t.stepId},"edit"),")"):null})(t))}),c&&k.a.createElement(ct.a,{onClick:d,className:m,"data-tracking-id":"edit_options","data-index":G.m},k.a.createElement("span",{className:"icon-plus-circle2 mr-0_5"}),"Add additional equipment to my appraisal")))}function fs(e){let t=e.descriptionValues;const a=["Exterior"],s=He()(Date.now(),"shortDate");return t.map(e=>{let t=e.title,i=e.value,n=e.isTotal;return k.a.createElement(F.a,{key:t,className:Me()({"mb-0_75":n})},k.a.createElement(q.a,{className:Me()({"text-gray small":!n,"text-gray-darker font-weight-bold":n}),xs:6},t),k.a.createElement(q.a,{className:Me()("text-right",{"text-gray small":!n,"text-gray-darker font-weight-bold":n,"color-name-selection":a.includes(t)}),xs:6},n?k.a.createElement(x.Fragment,null,Object(We.a)(i),k.a.createElement("div",{className:"appraisal-date font-weight-normal mt-0_25"},`As of ${s}`)):i))})}gs.propTypes={changeStep:w.a.func.isRequired,title:w.a.string,make:w.a.string,model:w.a.string,style:w.a.string,photo:w.a.string,descriptionValues:w.a.arrayOf(w.a.shape({})),isExtendedReport:w.a.bool,showExteriorColor:w.a.bool,showAddEquipment:w.a.bool},gs.defaultProps={title:"",make:"",model:"",style:"",photo:"",descriptionValues:[],isExtendedReport:!1,showExteriorColor:!0,showAddEquipment:!1},fs.propTypes={descriptionValues:w.a.arrayOf(w.a.shape({}))},fs.defaultProps={descriptionValues:[]};var bs=a("./site-modules/shared/components/tooltip-item/tooltip-item.jsx");a("./site-modules/shared/components/appraisal/appraisal-report-price-title/appraisal-report-price-title.scss");function Es(e){let t=e.id,a=e.title,i=e.info,n=e.placement,r=e.columnsSize,o=e.className,l=e.iconClassName,c=e.onTooltipOpen;return k.a.createElement(q.a,Object(s.a)({},r,{className:o}),a,"\xa0",!(!i||!t)&&k.a.createElement(bs.a,{id:t,className:"appraisal-table-info-btn",iconClassName:l,item:{text:i,placement:n},useUniqId:!0,onTooltipOpen:c}))}Es.propTypes={info:w.a.string,title:w.a.oneOfType([w.a.string,w.a.object]).isRequired,id:w.a.string,columnsSize:w.a.shape({xs:w.a.number,md:w.a.number,lg:w.a.number}),placement:w.a.string,className:w.a.string,iconClassName:w.a.string,onTooltipOpen:w.a.func},Es.defaultProps={info:"",id:"",placement:"bottom",className:"",columnsSize:{xs:8,md:8,lg:8},iconClassName:"ml-0_5 xsmall",onTooltipOpen:b.a};var ys=a("./site-modules/shared/utils/nice-name.js"),vs=a("./site-modules/shared/utils/calculator/calculator-helper.js"),Cs=a("./constants/pub-states.js"),Ss=a("./site-modules/shared/constants/key-values.js");class Ts extends x.Component{constructor(){super(...arguments),this.state={value:"",isMoreInfoCollapsed:!1},this.handlePayoffChange=(e=>{e.persist();const t=Object(We.d)(e.target.value),a=t>0?-t:t;this.setState({value:a})}),this.handleBlur=(()=>{this.props.onPayoffChange(this.state.value)}),this.handleEnterPress=(e=>{e.key===Ss.a&&(e.preventDefault(),e.target.blur())}),this.toggleMoreInfo=(()=>this.setState(e=>({isMoreInfoCollapsed:!e.isMoreInfoCollapsed})))}render(){const e=this.state,t=e.isMoreInfoCollapsed,a=e.value;return k.a.createElement(F.a,null,k.a.createElement(q.a,{xs:7},k.a.createElement("span",{id:"payoff-amount",className:"font-weight-normal mb-1"},"Do you owe anything on your trade-in?")),k.a.createElement(q.a,{xs:5},k.a.createElement("div",{className:"payment-field ml-md-1 pos-r"},k.a.createElement("span",{className:"i-dollar"},"$"),k.a.createElement(qt.a,{name:"payOffAmount",type:"number",inputMode:"numeric",className:"input-content text-gray-darker text-right pl-1 pr-0",onChange:this.handlePayoffChange,onBlur:this.handleBlur,onKeyPress:this.handleEnterPress,value:a,"data-testid":"payOffAmount"}))),k.a.createElement(q.a,null,k.a.createElement(ct.a,{color:"link","aria-describedby":"total-trade-in","aria-expanded":!t,className:"p-0 mt-0_25 text-decoration-none text-left heading-6 font-weight-normal",onClick:this.toggleMoreInfo},k.a.createElement("div",{className:"text-primary-darker"},k.a.createElement("span",null,G.G.title),k.a.createElement("span",{className:Me()("pl-0_25 small text-primary-darker",{"icon icon-arrow-down2":!t,"icon icon-arrow-up2":t})}))),k.a.createElement(pt.a,{className:"mt-0_75","aria-hidden":t,isOpen:t},k.a.createElement("p",{className:"text-gray-darker"},G.G.PAYOFF_AMOUNT))))}}Ts.propTypes={onPayoffChange:w.a.func.isRequired};var Is=a("./site-modules/shared/components/car-buying/odometer-payment-value/odometer-payment-value.jsx");class _s extends x.Component{constructor(){super(...arguments),this.state={isMoreInfoCollapsed:!1},this.toggleMoreInfo=(()=>this.setState(e=>({isMoreInfoCollapsed:!e.isMoreInfoCollapsed})))}render(){const e=this.props,t=e.totalTradeIn,a=e.infoMessage,s=this.state.isMoreInfoCollapsed;return k.a.createElement(F.a,{className:"trade-in"},k.a.createElement(q.a,{xs:8,className:"text-gray-darker font-weight-bold"},k.a.createElement("span",{id:"total-trade-in"},G.fb.title)),k.a.createElement(q.a,{xs:4,className:"font-weight-bold text-right"},k.a.createElement(Is.a,{value:t}),k.a.createElement("div",{className:"appraisal-date font-weight-normal mt-0_25 mr-0_5"},"As of ",He()(Date.now(),"shortDate"))),k.a.createElement(q.a,null,k.a.createElement(ct.a,{color:"link","aria-describedby":"total-trade-in","aria-expanded":!s,className:"p-0 mt-0_25 text-decoration-none text-left heading-6 font-weight-normal",onClick:this.toggleMoreInfo},k.a.createElement("div",{className:"text-primary-darker"},k.a.createElement("span",null,G.G.title),k.a.createElement("span",{className:Me()("pl-0_25 small text-primary-darker",{"icon icon-arrow-down2":!s,"icon icon-arrow-up2":s})}))),k.a.createElement(pt.a,{className:"mt-0_75","aria-hidden":s,isOpen:s},k.a.createElement("p",{className:"text-gray-darker"},G.G.TOTAL_TRADE_IN)),a&&k.a.createElement("div",{className:"mt-0_75 small text-gray-darker","data-test":"total-trade-in-info-message"},a)))}}_s.propTypes={totalTradeIn:w.a.number,infoMessage:w.a.string},_s.defaultProps={totalTradeIn:0,infoMessage:""};class Ns extends x.Component{constructor(){super(...arguments),this.state={isMoreInfoCollapsed:!1},this.toggleMoreInfo=(()=>this.setState(e=>({isMoreInfoCollapsed:!e.isMoreInfoCollapsed})))}render(){const e=this.props,t=e.appliedTradeIn,a=e.infoMessage,s=e.skipMoreInfo,i=e.className,n=e.classNameValue,r=e.hideAppraisalDate,o=this.state.isMoreInfoCollapsed;return k.a.createElement(F.a,{className:Me()("trade-in",{"mt-1_25":!s})},k.a.createElement(q.a,{xs:8,className:Me()("text-gray-darker font-weight-bold",i)},k.a.createElement("span",null,G.b.title)),k.a.createElement(q.a,{xs:4,className:Me()("font-weight-bold text-right",n)},k.a.createElement(Is.a,{value:t}),!r&&k.a.createElement("div",{className:"appraisal-date font-weight-normal mt-0_25 mr-0_5"},"As of ",He()(Date.now(),"shortDate"))),!s&&k.a.createElement(q.a,null,k.a.createElement(ct.a,{color:"link","aria-describedby":"payoff-amount","aria-expanded":!o,className:"p-0 mt-0_25 text-decoration-none text-left heading-6 font-weight-normal",onClick:this.toggleMoreInfo},k.a.createElement("div",{className:"text-primary-darker"},k.a.createElement("span",null,G.G.title),k.a.createElement("span",{className:Me()("pl-0_25 small text-primary-darker",{"icon icon-arrow-down2":!o,"icon icon-arrow-up2":o})}))),k.a.createElement(pt.a,{className:"mt-0_75","aria-hidden":o,isOpen:o},k.a.createElement("p",{className:"text-gray-darker"},G.G.APPLIED_TRADE_IN)),a&&k.a.createElement("div",{className:"mt-0_75 small text-gray-darker","data-test":"applied-trade-in-info-message"},a)))}}function Os(e){let t=e.title,a=e.value,s=e.values,i=e.info;const n=a[G.kb];return n?k.a.createElement(x.Fragment,null,k.a.createElement(F.a,{className:"mb-0_5 mt-0_75"},k.a.createElement(Es,{title:t,info:i,id:Object(ys.c)(t),columnsSize:{xs:9,md:9,lg:9}}),k.a.createElement(q.a,{xs:3,className:"text-right"},Object(We.c)(n)),!!s.length&&s.map(e=>{let a=e.name,s=e.price;return k.a.createElement(x.Fragment,{key:a},k.a.createElement(q.a,{xs:9,className:Me()("mt-0_75 pl-1_5",{"option-names-selections":"Optional Equipment"===t})},a),k.a.createElement(q.a,{xs:3,className:"mt-0_75 text-right"},function(e){const t=e&&e[G.kb];return Object(We.c)(t)}(s)))}))):null}function Ps(e){let t=e.totalPrice,a=e.priceList,n=e.onPayoffChange,r=e.sellingPrice,o=e.msrp,l=e.residualValue,c=e.isPurchase,d=e.isUsed,p=e.styleId,m=e.zipCode,u=e.pageName,h=e.venomVersion;const g=Object(x.useState)(!1),f=Object(i.a)(g,2),b=f[0],E=f[1],y=Object(x.useState)(t),v=Object(i.a)(y,2),C=v[0],S=v[1],I=Object(x.useState)(0),_=Object(i.a)(I,2),N=_[0],O=_[1],P=Object(x.useState)(0),A=Object(i.a)(P,2),V=A[0],w=A[1],j=Object(x.useState)({totalTradeInMsg:"",appliedTradeInMsg:""}),R=Object(i.a)(j,2),M=R[0],D=R[1];Object(x.useEffect)(()=>{let e=!1;return async function(){const t=await Object(vs.a)({salesPrice:r,msrp:o,residual:l,isPurchase:c,isUsed:d,styleId:p,zipCode:m,tradeIn:C,pageName:u,venomVersion:h});if(!e){const e=d?Cs.a.USED:Cs.a.NEW,a=Object(vs.d)(t,X.ab)||C,s=Object(vs.i)(T()(t,"limitCriteria",{}),e).tradeInValidationError;n(V,a),D({totalTradeInMsg:C<0?X.fb:"",appliedTradeInMsg:s}),O(a)}}(),()=>{e=!0}},[C]);return k.a.createElement("div",null,k.a.createElement(ct.a,{color:"link",block:!0,"data-tracking-id":"view_detailed_report",className:"m-0 p-0 mt-0_75 text-decoration-none text-left heading-6 font-weight-normal",onClick:()=>E(!b)},k.a.createElement("span",{className:"text-primary-darker"},k.a.createElement("span",null,"See Detailed Report"),k.a.createElement("span",{className:Me()("small ml-0_25",{"icon-arrow-up3":b,"icon-arrow-down3":!b})}))),k.a.createElement(pt.a,{isOpen:b,className:"heading-5 font-weight-normal"},a.map(e=>k.a.createElement(Os,Object(s.a)({key:`appraisal report - ${e.title}`},e)))),k.a.createElement("hr",{className:"my-1_5 my-md-1"}),k.a.createElement(Ts,{onPayoffChange:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;S(t+e),w(e)}}),k.a.createElement("hr",{className:"my-1_5 my-md-1"}),k.a.createElement(_s,{totalTradeIn:C,infoMessage:M.totalTradeInMsg}),k.a.createElement(Ns,{appliedTradeIn:N,infoMessage:M.appliedTradeInMsg}))}Ns.propTypes={appliedTradeIn:w.a.number,infoMessage:w.a.string,skipMoreInfo:w.a.bool,className:w.a.string,classNameValue:w.a.string,hideAppraisalDate:w.a.bool},Ns.defaultProps={appliedTradeIn:0,infoMessage:"",skipMoreInfo:!1,className:"",classNameValue:"",hideAppraisalDate:!1},Os.propTypes={title:w.a.string.isRequired,value:w.a.shape({}),values:w.a.arrayOf(w.a.shape({})),info:w.a.string},Os.defaultProps={info:"",values:[],value:{}},Ps.propTypes={totalPrice:w.a.number.isRequired,priceList:w.a.arrayOf(w.a.shape({})),onPayoffChange:w.a.func.isRequired,sellingPrice:w.a.number,msrp:w.a.number,residualValue:w.a.number,isPurchase:w.a.bool,isUsed:w.a.bool,styleId:w.a.number,zipCode:w.a.string,venomVersion:w.a.string,pageName:w.a.string},Ps.defaultProps={priceList:[],sellingPrice:0,msrp:0,residualValue:0,isPurchase:!1,isUsed:!1,styleId:null,zipCode:"",venomVersion:"",pageName:""};const As=Object(z.c)(e=>({venomVersion:T()(e,"venomVersion.version"),pageName:T()(e,"pageContext.page.name")}))(Ps);function xs(e){let t=e.getVehicleData,a=e.onPayoffChange,s=e.changeStep,i=e.vehiclePhoto,n=e.totalPrices,r=e.priceList,o=e.sellingPrice,l=e.msrp,c=e.residualValue,d=e.isPurchase,p=e.isUsed,m=e.color,u=e.condition,h=e.mileage,g=e.showExteriorColor,f=e.showAddEquipment,b=e.zipCode;const E=t(),y=E.makeName,v=E.modelName,C=E.makeSlug,S=E.modelSlug,T=E.styleName,I=E.year,_=E.styleId,N=`${I} ${y} ${v}`,O=n[G.kb],P=[{title:"Appraisal value:",value:O,isTotal:!0},{title:"Mileage",value:h},{title:"Exterior",value:m.name},{title:"Condition",value:u}];return k.a.createElement(F.a,{className:"mb-md-1_5 appraisal-report-step-head"},k.a.createElement(gs,{changeStep:s,title:N,make:C,model:S,style:T,photo:i,descriptionValues:P,showExteriorColor:g,showAddEquipment:f}),k.a.createElement(q.a,{xs:12,md:6,className:"pt-md-0_5"},k.a.createElement(fs,{descriptionValues:P}),k.a.createElement(As,{totalPrice:O,priceList:r,onPayoffChange:a,sellingPrice:o,msrp:l,residualValue:c,isPurchase:d,isUsed:p,styleId:_,zipCode:b})))}xs.propTypes={getVehicleData:w.a.func.isRequired,changeStep:w.a.func.isRequired,onPayoffChange:w.a.func.isRequired,priceList:w.a.arrayOf(w.a.shape({})),totalPrices:w.a.shape({}),sellingPrice:w.a.number,msrp:w.a.number,residualValue:w.a.number,isPurchase:w.a.bool,isUsed:w.a.bool,vehiclePhoto:w.a.string,color:w.a.shape({}),condition:w.a.string,mileage:w.a.string,showExteriorColor:w.a.bool,showAddEquipment:w.a.bool,zipCode:w.a.string},xs.defaultProps={priceList:[],sellingPrice:0,msrp:0,residualValue:0,isPurchase:!1,isUsed:!1,stepId:G.ab,vehiclePhoto:"",color:{},condition:"",mileage:"",totalPrices:{},showExteriorColor:!1,showAddEquipment:!1,zipCode:""};a("./site-modules/shared/components/appraisal/appraisal-report-toggle-btn/appraisal-report-toggle-btn.scss");function ks(e){let t=e.onClick,a=e.show,s=e.showText,i=e.hideText,n=e.btnClassNames;return k.a.createElement(ct.a,{color:"link",size:"lg",className:Me()("appraisal-report-toggle-btn w-100 text-left px-0 py-0 mt-0_5",n),onClick:t,"data-tracking-id":"view_detailed_report"},a?s:i,k.a.createElement("span",{className:Me()("text-primary align-middle small pl-0_25",{"icon-arrow-down3":a,"icon-arrow-up3":!a})}))}ks.propTypes={onClick:w.a.func.isRequired,show:w.a.bool,showText:w.a.string,hideText:w.a.string,btnClassNames:w.a.string},ks.defaultProps={show:!0,showText:"Show estimated values",hideText:"Hide estimated values",btnClassNames:""};var Vs=a("./site-modules/shared/components/appraisal/transaction-type-select/transaction-type-select.jsx"),ws=a("../node_modules/reactstrap/lib/ButtonDropdown.js"),js=a.n(ws),Rs=a("../node_modules/reactstrap/lib/DropdownToggle.js"),Ms=a.n(Rs),Ds=a("../node_modules/reactstrap/lib/DropdownMenu.js"),Ls=a.n(Ds);a("./site-modules/shared/components/appraisal/trade-in-appraiser-steps/appraisal-report-step/appraisal-report-step-condition-dropdown.scss");class Fs extends x.Component{constructor(){super(...arguments),this.state={isOpen:!1},this.onChange=(e=>{let t=e.currentTarget.value;this.setState({isOpen:!1},()=>{this.props.onUpdate(t)})}),this.onToggleOpen=(()=>{this.setState(e=>({isOpen:!e.isOpen}))})}render(){const e=this.state.isOpen,t=this.props,a=t.selectedCondition,s=t.conditionClassName;return k.a.createElement(js.a,{isOpen:e,toggle:this.onToggleOpen,className:"condition-container align-baseline"},k.a.createElement(Ms.a,{className:"m-0 p-0 condition text-capitalize size-16","aria-haspopup":!0},k.a.createElement("span",{"aria-label":"vehicle-condition",className:Me()("px-0_25",s)},a),k.a.createElement("i",{"aria-hidden":!0,className:"brand-primary-darker size-12 py-0 my-0 pr-0_25 icon-arrow-down3"})),k.a.createElement(Ls.a,{right:!0,className:"condition-dropdown-shadow p-0_25"},G.o.map(e=>{let t=e.title,s=e.text;return k.a.createElement(x.Fragment,{key:`${t}-btn`},k.a.createElement(ct.a,{className:Me()("condition-dropdown-btn size-14  font-weight-normal text-gray-darker py-0_5 px-0_75 m-0 w-100",{"font-weight-bold":a===t}),onClick:this.onChange,value:t},k.a.createElement("div",{className:"btn-title d-flex text-capitalize justify-content-between"},t,k.a.createElement("i",{"aria-hidden":!0,hidden:a!==t,className:"btn-title-icon text-primary-darker font-weight-bold align-self-center icon-checkmark mr-0_25"})),k.a.createElement("div",{className:"display-6 condition-dropdown-description"},s)))})))}}Fs.propTypes={selectedCondition:w.a.string.isRequired,onUpdate:w.a.func.isRequired,conditionClassName:w.a.string},Fs.defaultProps={selectOnOpen:!1,conditionClassName:""};a("./site-modules/shared/components/appraisal/trade-in-appraiser-steps/appraisal-report-step/appraisal-report-step-bar-chart.scss");function Us(e){let t=e.prices,a=e.selectedType,s=e.selectedCondition;return t.length&&k.a.createElement("div",{className:"appraisal-report-bar-chart pt-2_5 pt-sm-1_5"},k.a.createElement(F.a,{className:"bar-chart justify-content-center text-center text-gray-darker align-items-end size-14"},t.map((e,t)=>{const i=`appraisal-report-bar-chart-bar-${t}`;return k.a.createElement(q.a,{key:i,xs:3,className:Me()("bar d-flex align-items-end justify-content-center pb-0_5 mx-0_25 mx-lg-0_5 pos-r",`bar-${t}`,a,{"selected-condition font-weight-bold":G.o[t].title===s})},Object(We.c)(e))})),k.a.createElement("hr",{className:"bar-chart-underline my-0"}),k.a.createElement(F.a,{className:"justify-content-center my-0_5"},G.o.map(e=>{let t=e.title,a=e.text;return k.a.createElement(q.a,{xs:3,key:`${t}-${a}`,className:"bar-description size-12 text-gray-darker text-center px-0 px-lg-05 mx-0_25 mx-lg-0_5"},k.a.createElement("span",{className:Me()({"font-weight-bold":t===s})},t)," ",k.a.createElement(bs.a,{id:t.toLowerCase(),className:"appraisal-table-info-btn",iconClassName:"small text-gray-darker",item:{text:a,placement:"bottom"},useUniqId:!0}))})))}Us.propTypes={prices:w.a.arrayOf(w.a.number),selectedType:w.a.string,selectedCondition:w.a.string},Us.defaultProps={prices:[],selectedType:G.kb,selectedCondition:G.n.AVERAGE};var qs=a("./site-modules/shared/components/profile/firebase-auth.jsx");a("./site-modules/shared/components/appraisal/trade-in-appraiser-steps/appraisal-report-step-extended/appraisal-report-extended-detailed.scss");const zs="We use data from a wide variety of sources to provide you with your Edmunds appraisal report, considering factors such as the car's year, make, model, trim, mileage, depreciation and features. This is not a firm offer on your car.",Bs="selected-outlined";class $s extends x.Component{static getDerivedStateFromProps(e,t){const a=e.emailReportStatus,s=t.isSubmitting,i=t.isSubmitted;return a===G.u.SENT?(s&&ee.a.fireTrackAction({event_type:J.b.EVENT_TYPE_ACTION_PROGRESS,event_data:{action_name:J.b.ACTION_SIGN_UP,subaction_name:J.b.SUCCESS_EMAIL_ONLY_SIGN_UP,action_cause:J.b.ACTION_CAUSE_BUTTON_CLICK,action_category:J.b.USER_ACTION_CATEGORY,creative_id:"edm-entry-track-car-value"}}),{isSubmitting:!1,isSubmitted:i||s}):null}constructor(e){var t;t=super(e),this.onEmailFormFieldFocus=(()=>{const e=this.props,t=e.emailReportStatus,a=e.resetEmailReportStatus;this.state.isSubmitted&&(t===G.u.SENT&&a(),this.setState({isSubmitted:!1}))}),this.getPrices=function(e){let a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const s=t.props.allConditionPricing,i=t.state.selectedType;return a?s.rough[e]:G.o.map(t=>{let a=t.title;return s[a.toLowerCase()][e][i]})},this.getConditionDescription=(e=>G.o.find(t=>{return t.title===e})),this.uniqInputId="",this.editLinkClassName="border-0 p-0 text-transform-none font-weight-normal text-primary-darker btn-link text-left edit-link",this.editLinkDataByDescriptionTitle={Exterior:{stepId:G.m,trackingId:"edit_color"},Mileage:{stepId:G.p,trackingId:"edit_mileage"}},this.handleTypeChange=(e=>{let t=e.value;const a=this.props.stepId;this.setState(()=>({selectedType:t})),this.props.updateStepsState("selectedReportType",t),ee.a.fireTrackAction(Object(G.rb)(t,this.props.creativeId)),ee.a.fireTrackAction(G.d[a][t])}),this.handleConditionChange=(e=>{this.props.updateStepsState("condition",e)}),this.handleSubmitEmail=(async e=>{const t=this.props,a=t.validate,s=t.resetEmailReportStatus;e.preventDefault(),e.stopPropagation();const i=a();i&&s(),this.setState({isSubmitting:i},async()=>{const e=this.props,t=e.isAuthenticated,a=e.doesNotHaveEmail,s=e.updateIdmData,n=e.fields,r=e.validateEmailAsync;await rt({isAuthenticated:t,doesNotHaveEmail:a,isValid:i,emailField:n.email,updateIdmData:s,validateEmailAsync:r,fetchSignInMethodsForEmail:qs.e,fireValidExistingEmailCustomEvent:ne.g}),ee.a.fireTrackAction({event_type:J.b.EVENT_TYPE_ACTION_PROGRESS,event_data:{action_name:J.b.ACTION_SIGN_UP,subaction_name:J.b.SUBMIT_SIGN_UP_EMAIL,action_category:J.b.USER_ACTION_CATEGORY,action_cause:J.b.ACTION_CAUSE_BUTTON_CLICK,creative_id:"edm-entry-track-car-value",value:"TRACK"}})})}),this.inputRef=(e=>{if(e)return this.props.fieldRef(e.props.name,e)}),this.renderEditLink=(e=>{const t=this.editLinkDataByDescriptionTitle[e];return k.a.createElement("span",{className:"pl-0_5 size-14"},"(",k.a.createElement(ct.a,{onClick:this.props.changeStep,className:this.editLinkClassName,"data-tracking-id":t.trackingId,"data-index":t.stepId},"edit"),")")}),this.renderPriceRow=(e=>{let t=e.prices,a=e.className,i=e.priceClassName,n=void 0===i?"":i,r=e.titleProps,o=e.conditionOrderNumber;return t.find(e=>void 0!==e)?k.a.createElement(F.a,{key:r.title,className:Me()("extended-report-table-row px-0_25",a)},k.a.createElement(Es,Object(s.a)({iconClassName:"small text-gray-darker"},r,{columnsSize:{xs:8,lg:4}})),t.map((e,t)=>{const a=`${e}-${r.id}-${t}`;return k.a.createElement(q.a,{xs:2,key:a,className:Me()("text-right py-0_5 py-lg-0_75 hidden-md-down",n,{[Bs]:t===o})},Object(We.c)(e))}),k.a.createElement(q.a,{xs:4,className:Me()("text-right py-0_5 py-lg-0_75 hidden-lg-up",n)},Object(We.c)(t[o]))):null}),this.renderReportDetailHeader=(()=>{const e=this.props,t=e.stepId,a=e.isMobile;return k.a.createElement(x.Fragment,null,k.a.createElement("div",{className:"heading-4 d-flex align-items-center"},k.a.createElement("span",{className:"icon-edmunds-car text-primary size-24 mr-0_5"}),"Your Edmunds Appraisal ",k.a.createElement("span",{className:"d-none d-md-block"},"\xa0Report")),k.a.createElement("div",{className:"my-0_5 size-14"},"As of ",He()(Date.now(),"mm/dd/yyyy")),t===G.x&&!a&&k.a.createElement("div",{className:"my-0_5 mb-lg-1_5 size-14"},zs))}),this.renderEmailSection=(()=>{const e=this.props,t=e.validationErrors.email,a=e.validate,s=e.userEmail,i=e.isMobile,n=this.state,r=n.isSubmitting,o=n.isSubmitted,l=o?"Sent!":"SEND",c=i?"Email":"Enter Your Email";return k.a.createElement("div",{className:"mb-2"},k.a.createElement("div",{className:Me()("rounded email-section-wrapper pt-1 pb-1_5 w-100",{"px-1_5":!i,"px-1":i})},k.a.createElement("div",{className:"text-center text-md-left"},k.a.createElement("div",{className:"d-flex justify-content-center align-items-center justify-content-md-start"},k.a.createElement("span",{className:"icon-edmunds-car text-primary size-24 mr-0_5"}),k.a.createElement("span",{className:"heading-5"},"Know what your car is worth")),k.a.createElement("div",{className:"size-14"},"Get a copy of your appraisal report and monthly updates on the value of your car.")),k.a.createElement(ut.a,{noValidate:!0,onSubmit:this.handleSubmitEmail,className:"mt-1"},k.a.createElement(q.a,{xl:8,md:10,className:"px-0"},k.a.createElement("div",{className:"w-100 d-flex"},k.a.createElement(q.a,{className:"px-0",xs:i?8:9},k.a.createElement(ra.a,{className:"mb-0",defaultValue:s,"data-tracking-id":"provide_email","data-tracking-parent":"edm-entry-track-car-value","data-tracking-ignore-value":!0,id:`offer-card-email-${this.uniqInputId}`,maxLength:255,name:"email",type:"email",inputClassName:"px-0_5 mb-0 email-input","aria-label":c,ref:this.inputRef,isValid:!t,required:!0,onFocus:this.onEmailFormFieldFocus,onBlur:a,readOnly:r,placeholder:`${c} \u2020`})),k.a.createElement(q.a,{xs:i?4:3,className:"px-0"},k.a.createElement(ct.a,{type:"submit",color:"success",className:Me()("w-100 size-16 text-white py-0_5 track-btn text-capitalize",{"p-0":i,"pl-0_75":!i&&r,"pl-0_25":i&&r}),"data-tracking-id":"submit_sign_up_email",disabled:o},r&&k.a.createElement("span",{className:Me()({"pr-0_5":!i,"pr-0_25":i})},k.a.createElement(gt.a,{size:14,thickness:1,color:"white"})),k.a.createElement("span",{className:"size-16"},l)))),t&&k.a.createElement("div",{id:`error-email-${this.uniqInputId}`,className:"size-12 mt-0_25 text-danger d-none d-md-block"},t)))),k.a.createElement("div",{className:Me()("text-gray size-10",{"mt-0_25":!i,"mt-0_75":i})},"\u2020 By clicking Send, I accept the terms of the"," ",k.a.createElement(Ta.a,{target:"_blank",rel:"noopener noreferrer",to:"/about/visitor-agreement.html",className:"text-gray-darker disclaimer"},k.a.createElement("u",null,"Edmunds Visitor Agreement")),"."," ",k.a.createElement(Ta.a,{target:"_blank",rel:"noopener noreferrer",to:"/about/privacy.html",className:"text-gray-darker disclaimer"},k.a.createElement("u",null,"Our collection and use of your personal information")),"."))}),this.renderReportTableHeader=(()=>{const e=this.props,t=e.changeStep,a=e.isMobile,s=e.getVehicleData,i=e.mileage,n=e.color,r=e.vin,o=e.stepId,l=e.showBarChart,c=e.showVehicleDetails,d=e.zipCode,p=e.showExteriorColor,m=e.showAddEquipment,u=e.condition,h=this.state.selectedType,g=G.lb[h].info,f=s(),b=f.makeName,E=f.modelName,y=f.styleName,v=f.year;return k.a.createElement("div",{className:"text-gray-darker"},c?k.a.createElement(x.Fragment,null,k.a.createElement("div",null,this.renderReportDetailHeader()),k.a.createElement("div",{className:"appraisal-report-vehicle-details size-16 text-gray-darker text-md-left mt-1 mb-1_5"},k.a.createElement("div",{className:"font-weight-bold"},v," ",b," ",E),k.a.createElement("div",null,y),k.a.createElement("div",null,"Mileage: ",Object(Qe.c)(parseInt(i,10)),this.renderEditLink("Mileage")),p&&k.a.createElement("div",null,"Exterior: ",n.name,this.renderEditLink("Exterior")),o===G.x&&k.a.createElement("div",null,"VIN: ",r),k.a.createElement("div",null,"Zip code: ",d),m&&k.a.createElement(ct.a,{onClick:t,className:this.editLinkClassName,"data-tracking-id":"edit_options","data-index":G.m},k.a.createElement("span",{className:"icon-plus-circle2 mr-0_5"}),"Add additional equipment to my appraisal"))):k.a.createElement("div",null,this.renderReportDetailHeader()),this.renderEmailSection(),l?k.a.createElement(x.Fragment,null,a&&k.a.createElement(F.a,null,k.a.createElement(q.a,{xs:12},k.a.createElement(Vs.a,{labelText:"Transaction type select",isLabelHidden:!0,onChange:this.handleTypeChange,selected:h,className:"mb-1"}))),k.a.createElement(F.a,{className:"justify-content-between"},!a&&k.a.createElement(q.a,{lg:6,md:5,xs:8},k.a.createElement(Vs.a,{labelText:"Transaction type select",isLabelHidden:!0,onChange:this.handleTypeChange,selected:h,className:"mb-1"}))),k.a.createElement(F.a,null,k.a.createElement(q.a,{xs:12,className:"size-12 text-center"},g)),k.a.createElement(F.a,{className:"justify-content-center pb-2_5 pb-sm-1_5"},k.a.createElement(q.a,{xs:12},k.a.createElement(Us,{prices:this.getPrices("totalPrices"),selectedType:h,selectedCondition:u})))):k.a.createElement(x.Fragment,null,k.a.createElement(F.a,{className:"justify-content-between flex-md-row-reverse mb-md-1_5"},k.a.createElement(q.a,{md:5,lg:6},k.a.createElement(Vs.a,{labelText:"Transaction type select",isLabelHidden:!0,onChange:this.handleTypeChange,selected:h,className:"mb-1_5"})))))}),this.renderYourAppraisal=(e=>k.a.createElement("div",{className:Me()("text-gray-darker size-12 text-center font-weight-bold",e)},"Your car's value")),this.renderReportTable=(()=>{const e=this.props.condition,t=this.state.selectedType,a=[Object(n.a)({},G.X.NATIONAL_BASE,{prices:this.getPrices("nationalPrices")}),Object(n.a)({},G.X.OPTIONAL_EQUIPMENT,{prices:this.getPrices("optionalPrices"),optionsValues:this.getPrices("optionalPricesValues",!0)}),Object(n.a)({},G.X.COLOR_ADJUSTMENT,{prices:this.getPrices("colorPrices")}),Object(n.a)({},G.X.REGIONAL_ADJUSTMENT,{prices:this.getPrices("regionalPrices")}),Object(n.a)({},G.X.MILEAGE_ADJUSTMENT,{prices:this.getPrices("mileagePrices")}),Object(n.a)({},G.X.CONDITION_ADJUSTMENT,{prices:this.getPrices("conditionPrices")}),{title:"Value",prices:this.getPrices("totalPrices"),isTotal:!0}],s=k.a.createElement(F.a,{className:"extended-report-table-head-your-appraisal px-0_25 hidden-md-down"},k.a.createElement(q.a,{xs:7,lg:4}),G.o.map(t=>{let a=t.title;const s=a===e;return k.a.createElement(q.a,{xs:2,key:`table-head-condition-selected-${a}`,className:Me()("py-0_5",{[Bs]:s})},s&&this.renderYourAppraisal())}),k.a.createElement(q.a,{xs:5})),i=k.a.createElement(F.a,{className:"extended-report-table-head px-0_25 size-14 font-weight-bold"},k.a.createElement(q.a,{xs:7,lg:4,className:Me()("d-flex align-items-end align-items-lg-baseline","py-1 py-lg-0_5")}),G.o.map(t=>{let a=t.title,s=t.text;return k.a.createElement(q.a,{xs:2,key:a,className:Me()("text-right hidden-md-down","py-1 py-lg-0_5",{[Bs]:a===e})},k.a.createElement("div",{className:"d-none d-lg-block d-xl-inline"},a),k.a.createElement(bs.a,{id:a.toLowerCase(),className:"appraisal-table-info-btn",iconClassName:"small text-gray-darker",item:{text:s,placement:"bottom"},useUniqId:!0}))}),k.a.createElement(q.a,{xs:5,className:Me()("hidden-lg-up text-right d-flex align-items-end justify-content-end","py-1 py-lg-0_5")},k.a.createElement("div",null,this.renderYourAppraisal("pr-1_25"),k.a.createElement(Fs,{onUpdate:this.handleConditionChange,selectedCondition:e})))),r=a.map(a=>{const s=a.title,i=a.info,n=a.prices,r=a.optionsValues,o=void 0===r?[]:r,l=a.totalPrice,c=a.isTotal,d=G.o.findIndex(t=>t.title===e),p=!!o.length&&o.map(e=>{let a=e.name,s=e.price;return this.renderPriceRow({prices:Array(G.o.length).fill(s[t]),conditionOrderNumber:d,className:"extended-report-table-option-row",titleProps:{title:a,id:Object(ys.c)(a),className:"py-0_5 py-lg-0_75 pl-1"}})});return k.a.createElement(x.Fragment,{key:s},this.renderPriceRow({prices:n,conditionOrderNumber:d,totalPrice:l,className:Me()("extended-report-table-item-row",{"extended-report-table-total-row":c}),priceClassName:{"heading-4":c},titleProps:{title:c?k.a.createElement(x.Fragment,null,k.a.createElement("span",{className:"hidden-lg-up"},e," Condition "),s):s,info:i,id:Object(ys.c)(s),className:Me()("py-lg-0_75",{"py-0_75 font-weight-bold":c,"py-0_5":!c})}}),p)});return k.a.createElement("div",{className:"text-gray-darker size-14"},s,i,r)});const a=e.selectedReportType;this.state={selectedType:a,isSubmitting:!1,isSubmitted:!1}}componentDidMount(){this.uniqInputId=Object(zt.c)()}render(){const e=this.props.isDetailedReportOpen;return k.a.createElement(x.Fragment,null,this.renderReportTableHeader(),k.a.createElement(pt.a,{isOpen:e},this.renderReportTable()))}}$s.propTypes={stepId:w.a.string.isRequired,isDetailedReportOpen:w.a.bool.isRequired,changeStep:w.a.func.isRequired,emailReportStatus:w.a.string,resetEmailReportStatus:w.a.func,updateStepsState:w.a.func,allConditionPricing:w.a.shape({rough:w.a.object,average:w.a.object,clean:w.a.object,outstanding:w.a.object}).isRequired,selectedReportType:w.a.string,condition:w.a.string,creativeId:w.a.string,getVehicleData:w.a.func.isRequired,mileage:w.a.string,vin:w.a.string,color:w.a.shape({}),showVehicleDetails:w.a.bool,showBarChart:w.a.bool,showExteriorColor:w.a.bool,showAddEquipment:w.a.bool,zipCode:w.a.string,validationErrors:w.a.objectOf(w.a.string),validate:w.a.func.isRequired,userEmail:w.a.string,fields:w.a.shape({}),validateEmailAsync:w.a.func.isRequired,updateIdmData:w.a.func.isRequired},$s.defaultProps={emailReportStatus:"",resetEmailReportStatus:b.a,updateStepsState:b.a,condition:"",selectedReportType:G.kb,creativeId:G.g,mileage:"",color:{},vin:"",showVehicleDetails:!1,showBarChart:!0,showExteriorColor:!1,showAddEquipment:!1,zipCode:"",validationErrors:{},userEmail:"",fields:{}};const Ys=Object(H.a)($s),Hs=Object(z.c)(e=>({userEmail:T()(e,"profile.data.idm.identifiers.email[0]"),isAuthenticated:e.profile.isAuthenticated,doesNotHaveEmail:!T()(e,"profile.data.idm.identifiers.email[0]")}))(Object(la.a)(Ys,nt)),Zs="Hide detailed report",Gs="See detailed report";class Ws extends x.Component{constructor(){super(...arguments),this.state={isDetailedReportOpen:!0},this.getDisplayConditions=(()=>{switch(this.props.stepId){case G.ab:return{showVehicleDetails:!1,showBarChart:!0};case G.x:return{showVehicleDetails:!0,showBarChart:!0};default:return{showVehicleDetails:!1,showBarChart:!1}}}),this.getReportView=(()=>{const e=this.props,t=e.changeStep,a=e.stepId,s=e.emailReportStatus,i=e.resetEmailReportStatus,n=e.updateStepsState,r=e.allConditionPricing,o=e.selectedReportType,l=e.condition,c=e.creativeId,d=e.isMobile,p=e.getVehicleData,m=e.mileage,u=e.color,h=e.vin,g=e.zipCode,f=e.showExteriorColor,b=e.showAddEquipment,E=this.state.isDetailedReportOpen,y=this.getDisplayConditions(),v=y.showVehicleDetails,C=y.showBarChart;return k.a.createElement(Hs,{changeStep:t,stepId:a,isDetailedReportOpen:E,emailReportStatus:s,resetEmailReportStatus:i,updateStepsState:n,allConditionPricing:r,selectedReportType:o,condition:l,creativeId:c,isMobile:d,getVehicleData:p,mileage:m,color:u,vin:h,showVehicleDetails:v,showBarChart:C,zipCode:g,showExteriorColor:f,showAddEquipment:b})}),this.toggleDetailedReport=(()=>this.setState(e=>({isDetailedReportOpen:!e.isDetailedReportOpen})))}render(){const e=this.state.isDetailedReportOpen;return k.a.createElement("div",{className:"appraiser-report-step-extended rounded"},this.getReportView(),k.a.createElement("div",{className:"pt-1"},k.a.createElement(ks,{onClick:this.toggleDetailedReport,show:!e,hideText:Zs,showText:Gs,btnClassNames:"text-primary"})))}}Ws.propTypes={stepId:w.a.string,totalPrices:w.a.shape({tradeIn:w.a.number,privateParty:w.a.number,dealerRetail:w.a.number}).isRequired,getVehicleData:w.a.func.isRequired,changeStep:w.a.func.isRequired,emailReportStatus:w.a.string,resetEmailReportStatus:w.a.func,updateStepsState:w.a.func,allConditionPricing:w.a.shape({rough:w.a.object,average:w.a.object,clean:w.a.object,outstanding:w.a.object}),selectedReportType:w.a.string,creativeId:w.a.string,condition:w.a.string,mileage:w.a.string,vin:w.a.string,color:w.a.shape({}),isMobile:w.a.bool,zipCode:w.a.string,showExteriorColor:w.a.bool,showAddEquipment:w.a.bool},Ws.defaultProps={stepId:G.ab,emailReportStatus:"",resetEmailReportStatus:b.a,updateStepsState:b.a,allConditionPricing:null,selectedReportType:"",condition:"",creativeId:G.g,isMobile:!1,mileage:"",color:{},vin:"",zipCode:"",showExteriorColor:!1,showAddEquipment:!1};var Qs=a("./site-modules/shared/components/logos/carmax-logo.jsx"),Ks=a("./site-modules/shared/components/logos/edmunds-logo-text.jsx");a("./site-modules/shared/components/appraisal/appraisal-partner-offer-value-props/appraisal-partner-offer-value-props.scss");const Xs=[{text:"No-obligation offer you can keep in your back pocket"},{text:"Easy way to sell your car quickly"},{text:"Haggle free so you don\u2019t have to negotiate"}];function Js(){return k.a.createElement("section",{className:"appraisal-partner-offer-value-props size-14 text-gray-darker"},k.a.createElement("ul",{className:"pl-1 pr-1_5 h-100 d-flex flex-column justify-content-around"},Xs.map(e=>{let t=e.text;return k.a.createElement("li",{key:t,className:"mb-0_5 pl-0_5"},k.a.createElement("i",{className:"icon-checkmark text-success size-16"})," ",t)})))}var ei=a("./site-modules/shared/components/appraisal/appraisal-utm-storage/appraisal-utm-storage.js");a("./site-modules/shared/components/appraisal/trade-in-appraiser-steps/license-plate-and-vin-step/license-plate-and-vin-step.scss");const ti={title:"Edmunds market insights and a real offer on your car",details:[{id:"#1",text:"Get the Edmunds Appraisal, so you know what it's worth"},{id:"#2",text:"Get an instant, no obligation offer from CarMax to see how it compares"},{id:"#3",text:"No contact info needed, no annoying calls"}]},ai=["NY","CA"],si=(e,t,a)=>e?a:!!t||!a;class ii extends x.Component{constructor(e){super(e),this.onActiveStep=(()=>{this.props.isEscapeHatch?ee.a.fireTrackAction(G.D):ee.a.fireTrackAction(G.E)}),this.setVinFromDrawerSquishStyles=(e=>{this.setState({vinFromDrawerSquishStyles:e})}),this.setActiveTab=(e=>this.setState({activeTabId:e})),this.getStepEdmundsHeader=(()=>k.a.createElement(F.a,{className:"mb-1_5"},k.a.createElement(q.a,{xs:12,className:"mb-1_5 pt-0_5"},k.a.createElement(Ks.a,{className:"edm-logo"})),k.a.createElement(q.a,{xs:12,className:"heading-4 mb-0_5"},ti.title),k.a.createElement(q.a,{xs:12,xl:9,className:"size-14"},k.a.createElement(x.Fragment,null,k.a.createElement("ul",{className:"pl-1 mb-0"},ti.details.map(e=>k.a.createElement("li",{key:e.id},e.text))))))),this.getStepHeader=(()=>{const e=this.props,t=e.isEscapeHatch,a=e.isMobile,s=e.vehicle,i=s.make,n=s.model,r=s.year;return t?k.a.createElement(F.a,{className:"mb-1_5 text-center text-gray-darker"},k.a.createElement(q.a,{xs:12,className:"mb-1_5 mb-md-1_25 pt-2_5"},k.a.createElement("div",{className:"partner-logo mx-auto"},k.a.createElement(Qs.a,null))),k.a.createElement(q.a,{xs:12,className:Me()("mb-1",{"heading-4":a,"heading-3":!a})},"CarMax wants to buy your",k.a.createElement("br",null),r.year," ",i.name," ",n.name,"!"),k.a.createElement(q.a,{xs:12},k.a.createElement(hs.a,{imageId:"img/eva/price-reveal-v2.png",source:Ze.d.STATIC,alt:"Price Reveal",className:"price-reveal"})),k.a.createElement(q.a,{xs:12,xl:9,className:"size-14 mx-auto mt-0_75"},"All we need is your ",this.state.activeTabId===Kt.VIN?"VIN":"License Plate"," to see your",k.a.createElement("br",null),"no-obligation and hassle free cash offer.")):this.getStepEdmundsHeader()}),this.setVinTabActive=(()=>this.setActiveTab(Kt.VIN)),this.setLicensePlateTabActive=(()=>this.setActiveTab(Kt.LICENSE_PLATE)),this.getTabContents=(()=>{const e=this.props,t=e.onValueChange,a=e.isMobile,s=e.vehicle,i=e.queryVin,n=e.clearVin,r=e.isPartnerOfferEligibleVin,o=e.trackingCreativeId,l=e.vin,c=e.isEscapeHatch,d=e.isSecondary,p=e.isEligibleHardcodeYmmBypass,m=e.isStepActive,u=e.isVinFromDrawer,h=e.hasVinMismatchError,g=e.updateErrorMapAndScrollToInvalid,f=e.onPartnerOfferVinEligibilityUpdate,b=e.updateVinAndContinue,E=e.onActiveInventoryCheck,y=e.isLicencePlateAndVinStep,v=e.isAllowedToPredefineVin,C=e.updateStepsState,S=this.state,T=S.activeTabId,I=S.vinFromDrawerSquishStyles;return k.a.createElement(x.Fragment,null,c&&!a&&k.a.createElement(Js,null),k.a.createElement(xa,{vinFromDrawerSquishStyles:I,activeTabId:T,isMobile:a,vehicle:s,creativeId:o,setActiveTab:this.setActiveTab,clearVin:n,tabContentModal:this.tabContentModal,isPartnerOfferEligibleVin:r,onPartnerOfferVinEligibilityUpdate:f,updateVinAndContinue:b,onActiveInventoryCheck:E,onValueChange:t,useUniqId:c,isSecondary:d,isEligibleHardcodeYmmBypass:p,isEscapeHatch:c,queryVin:i,vin:l,setVinTabActive:this.setVinTabActive,isStepActive:m,isVinFromDrawer:u,hasVinMismatchError:h,updateErrorMapAndScrollToInvalid:g,trackVinEntry:this.trackVinEntry,vinTabLink:k.a.createElement(Ot.a,{classNames:"text-decoration-underline",onClick:this.setVinTabActive,tabLink:ka.f}),isLicencePlateAndVinStep:y,isAllowedToPredefineVin:v,updateStepsState:C}))}),this.getDrawerCreativeId=(()=>{return`${this.props.trackingCreativeId}-popup`}),this.isAddressToVinExcludedState=(e=>ai.includes(e)),this.isAddressToVinAllowed=(e=>{const t=this.props.stateCode;return e&&!this.isAddressToVinExcludedState(t)}),this.isOptimizedTraffic=[ei.a.isSemCampaignAppraisals,ei.a.isSemCampaignFacebook,this.props.isAppExtensionPage].some(e=>!!e),this.updateActiveTabId=(()=>{const e=this.props,t=e.queryVin,a=e.isMobile,s=e.isEscapeHatch;this.setState({activeTabId:si(s,t,a)?Kt.VIN:Kt.LICENSE_PLATE})}),this.trackVinEntry=((e,t)=>{ee.a.fireTrackAction({event_type:J.b.EVENT_TYPE_ACTION_PROGRESS,event_data:{action_name:J.b.ACTION_APPRAISE_VEHICLE,action_category:J.b.USER_ACTION_CATEGORY,action_cause:J.b.ACTION_CAUSE_USER_INPUT,subaction_name:J.b.SUBACTION_VIN_ENTRY,creative_id:t,value:e}})}),this.fireSkippedStepEvents=(()=>{const e=this.props,t=e.vin,a=e.isVinFromDrawer,s=this.state.vinFromDrawerSquishStyles;if(t){const e=s.length&&a?this.getDrawerCreativeId():G.e;this.trackVinEntry(t,e),ee.a.fireTrackAction({event_type:J.b.EVENT_TYPE_ACTION_PROGRESS,event_data:{action_name:J.b.ACTION_APPRAISE_VEHICLE,action_category:J.b.USER_ACTION_CATEGORY,action_cause:J.b.ACTION_CAUSE_USER_INPUT,subaction_name:J.b.SUBACTION_VIN_STEP_BYPASS,creative_id:G.e,value:t}})}}),this.tabContentModal=(e=>{const t=this.props,a=t.changeStep,s=t.onValueChange,i=t.isMobile,n=t.vehicle,r=t.clearVin,o=t.isPartnerOfferEligibleVin,l=t.vin,c=t.isEscapeHatch,d=t.isEligibleHardcodeYmmBypass,p=t.isStepActive,m=t.updateErrorMapAndScrollToInvalid,u=t.onPartnerOfferVinEligibilityUpdate,h=t.onActiveInventoryCheck,g=t.updateVinAndContinue,f=t.updateStepsState,b=t.isLicencePlateAndVinStep,E=t.isAddressToVinEnabled;if(c)return k.a.createElement(ct.a,{color:"link",className:"p-0 border-0 text-primary-darker text-transform-none size-16 find-vin-modal-open-btn",onClick:e===Kt.VIN?this.setLicensePlateTabActive:this.setVinTabActive},k.a.createElement("span",{className:"font-weight-normal"},"Use my ",e===Kt.VIN?"License Plate":"VIN"," instead"));const y=e===Kt.LICENSE_PLATE,v=this.getDrawerCreativeId();return!this.isAddressToVinAllowed(E)&&this.isOptimizedTraffic?null:(e=>k.a.createElement(Sa,{isMobile:i,creativeId:e?G.K:v,changeStep:a,isLicensePlate:y,vehicle:n,updateVinAndContinue:g,updateStepsState:f,isAddressToVinEnabled:e,setVinFromDrawerSquishStyles:this.setVinFromDrawerSquishStyles,isOptimizedTraffic:this.isOptimizedTraffic,onPartnerOfferVinEligibilityUpdate:u,isEligibleHardcodeYmmBypass:d,licensePlateAndVinForm:k.a.createElement(xa,{isAddressToVinEnabled:e,isMobile:i,activeTabId:y?Kt.VIN:Kt.LICENSE_PLATE,vehicle:n,creativeId:e?G.K:v,setActiveTab:this.setActiveTab,clearVin:r,isPartnerOfferEligibleVin:o,updateErrorMapAndScrollToInvalid:m,onPartnerOfferVinEligibilityUpdate:u,updateVinAndContinue:g,onActiveInventoryCheck:h,onValueChange:s,useUniqId:!0,updateStepsState:f,isSecondary:!0,isEligibleHardcodeYmmBypass:d,isEscapeHatch:c,vin:l,setVinTabActive:this.setVinTabActive,trackVinEntry:this.trackVinEntry,isStepActive:p,isEscapeHatchDrawer:!0,isFullWidth:!0,vinTabLink:k.a.createElement(Ot.a,{classNames:"text-decoration-underline",onClick:this.setVinTabActive,tabLink:ka.f}),isLicencePlateAndVinStep:b})}))(this.isAddressToVinAllowed(E))});const t=e.queryVin,a=e.isMobile,s=e.isEscapeHatch;this.state={activeTabId:si(s,t,a)?Kt.VIN:Kt.LICENSE_PLATE,vinFromDrawerSquishStyles:[]}}componentDidMount(){this.props.isStepActive&&this.onActiveStep()}componentDidUpdate(e){const t=this.props,a=t.isStepActive,s=t.isStepDone,i=t.queryVin,n=t.vinStyles,r=a!==e.isStepActive&&a,o=s&&!a&&!u()(s,e.isStepDone);r&&this.onActiveStep(),o&&this.fireSkippedStepEvents(),i&&!u()(e.queryVin,i)&&this.updateActiveTabId(),u()(this.state.vinFromDrawerSquishStyles,n)||u()(e.vinStyles,n)||this.setVinFromDrawerSquishStyles(n)}render(){const e=this.props,t=e.trackingCreativeId,a=e.isMobile,s=e.isEscapeHatch,i=k.a.createElement(x.Fragment,null,this.getStepHeader(),!s||a?this.getTabContents():k.a.createElement("div",{className:"d-md-flex d-lg-block d-xl-flex"},this.getTabContents()));return k.a.createElement("div",{className:Me()("license-plate-and-vin-step",{"teaser-offer-card pl-1 pr-1_25 pb-2 mb-2 px-md-3_5":s}),"data-tracking-parent":t},i)}}ii.propTypes={vehicle:w.a.shape({make:w.a.shape({name:w.a.string}),model:w.a.shape({name:w.a.string}),year:w.a.shape({year:w.a.string})}).isRequired,onPartnerOfferVinEligibilityUpdate:w.a.func.isRequired,onActiveInventoryCheck:w.a.func.isRequired,updateVinAndContinue:w.a.func.isRequired,clearVin:w.a.func.isRequired,changeStep:w.a.func.isRequired,updateErrorMapAndScrollToInvalid:w.a.func.isRequired,isMobile:w.a.bool,trackingCreativeId:w.a.string,onValueChange:w.a.func,updateStepsState:w.a.func,isStepActive:w.a.bool,isSecondary:w.a.bool,isEligibleHardcodeYmmBypass:w.a.bool,queryVin:w.a.string,vin:w.a.string,stateCode:w.a.string,isPartnerOfferEligibleVin:w.a.bool,isEscapeHatch:w.a.bool,isVinFromDrawer:w.a.bool,hasVinMismatchError:w.a.bool,isStepDone:w.a.bool,isAppExtensionPage:w.a.bool,isLicencePlateAndVinStep:w.a.bool,isAllowedToPredefineVin:w.a.bool,vinStyles:w.a.arrayOf(w.a.shape({})),isAddressToVinEnabled:w.a.bool},ii.defaultProps={isMobile:!1,isEligibleHardcodeYmmBypass:!1,queryVin:"",stateCode:"",vin:"",updateStepsState:b.a,isPartnerOfferEligibleVin:!1,isStepDone:!1,trackingCreativeId:G.B,onValueChange:void 0,isStepActive:!1,isSecondary:!1,isEscapeHatch:!1,isVinFromDrawer:!1,hasVinMismatchError:!1,tabContentModal:b.a,isAppExtensionPage:!1,isLicencePlateAndVinStep:!1,isAllowedToPredefineVin:!0,vinStyles:[],isAddressToVinEnabled:!1};const ni={vinStyles:Object($.a)(e=>{let t=e.vin;return Object(ae.d)({vin:t})},ae.b)},ri=Object(z.c)(e=>({isAppExtensionPage:T()(e,"pageContext.isAppExtensionPage"),stateCode:T()(e,"visitor.location.stateCode")}))(Object($.b)(ii,ni));var oi=a("./site-modules/shared/pages/seo.jsx"),li=a("./site-modules/shared/components/delighted/delighted.jsx");function ci(e){let t=e.onClick,a=e.deviceType,s=e.title,i=e.pageName,n=e.sessionId,r=e.disableNpsSurvey,o=e.isEpo;if(r)return null;const l=o?li.a.PartnerOffer:li.a.VehicleAppraiser,c={device_type:a,page:s,page_name:i,session_id:n};return k.a.createElement(li.b,{product:l,linkParams:c,title:"We Want Your Feedback",onClick:t})}ci.propTypes={onClick:w.a.func.isRequired,deviceType:w.a.oneOf(["mobile","desktop"]),title:w.a.string,pageName:w.a.string,sessionId:w.a.string,disableNpsSurvey:w.a.bool,isEpo:w.a.bool},ci.defaultProps={deviceType:null,title:null,pageName:null,sessionId:null,disableNpsSurvey:!1,isEpo:!1};const di=Object(z.c)(e=>({deviceType:e.mobile?"mobile":"desktop",title:T()(e,"seo.headContent.title")||oi.c.title,pageName:T()(e,"pageContext.legacy.pageName")||T()(e,"pageContext.page.name"),sessionId:T()(e,"visitor.session"),disableNpsSurvey:T()(e,"featureFlags.disableNpsSurvey")}))(ci);class pi extends x.PureComponent{render(){const e=this.props,t=e.getVehicleData,a=e.changeStep,i=e.updateStepsState,n=e.totalPrices,r=e.allConditionPricing,o=e.selectedReportType,l=e.stepId,c=e.creativeId,d=e.zipCode,p=e.color,m=e.condition,u=e.mileage,h=e.vin,g=e.emailReportStatus,f=e.resetEmailReportStatus,b=e.isMobile,E=e.isPartnerOfferEligible,y=e.hideDelightedSurvey,v=e.handleDelightedSurveyClick,C=e.showExteriorColor,S=e.showAddEquipment,T=e.showReportPricesOnly,I=e.isEscapeHatch,_=e.licensePlateAndVinProps,N=e.offerType,O=()=>k.a.createElement(Ws,{changeStep:a,stepId:l,totalPrices:n,allConditionPricing:r,emailReportStatus:g,resetEmailReportStatus:f,creativeId:c,selectedReportType:o,updateStepsState:i,condition:m,isMobile:b,getVehicleData:t,mileage:u,color:p,vin:h,isPartnerOfferEligible:E,zipCode:d,showExteriorColor:C,showAddEquipment:S,offerType:N,isEscapeHatch:I});return T?O():k.a.createElement(x.Fragment,null,I&&k.a.createElement(F.a,{className:"appraisal-report-step-head"},k.a.createElement(q.a,{xs:12},k.a.createElement(ri,Object(s.a)({},_,{isMobile:b,isEscapeHatch:I})))),I&&k.a.createElement("div",{className:Me()({"pr-2":!b})},k.a.createElement(ze,{isMobile:b,className:"mb-2"})),O(),I&&k.a.createElement(x.Fragment,null,k.a.createElement("hr",{className:"my-2"}),k.a.createElement(ri,Object(s.a)({},_,{isMobile:b,isEscapeHatch:I,isSecondary:!0})),E&&k.a.createElement("hr",{className:"my-2"})),!y&&k.a.createElement(x.Fragment,null,!E&&k.a.createElement("hr",null),k.a.createElement(di,{onClick:v})))}}pi.propTypes={getVehicleData:w.a.func.isRequired,changeStep:w.a.func.isRequired,updateStepsState:w.a.func.isRequired,stepId:w.a.string,creativeId:w.a.string,selectedReportType:w.a.string,zipCode:w.a.string,color:w.a.shape({}),condition:w.a.string,mileage:w.a.string,vin:w.a.string,totalPrices:w.a.shape({}),allConditionPricing:w.a.shape({}),partnerOfferEligibilityResponse:w.a.shape({}),emailReportStatus:w.a.string,resetEmailReportStatus:w.a.func,isMobile:w.a.bool,isPartnerOfferEligible:w.a.bool,hideDelightedSurvey:w.a.bool,handleDelightedSurveyClick:w.a.func,showExteriorColor:w.a.bool,showAddEquipment:w.a.bool,showReportPricesOnly:w.a.bool,isEscapeHatch:w.a.bool,licensePlateAndVinProps:w.a.shape({}),offerType:w.a.string},pi.defaultProps={stepId:G.ab,creativeId:G.g,selectedReportType:G.kb,zipCode:"",color:{},condition:"",mileage:"",vin:"",emailReportStatus:"",resetEmailReportStatus:b.a,totalPrices:{},allConditionPricing:{},partnerOfferEligibilityResponse:{},isMobile:!1,isPartnerOfferEligible:!1,hideDelightedSurvey:!1,handleDelightedSurveyClick:null,showExteriorColor:!1,showAddEquipment:!1,showReportPricesOnly:!1,isEscapeHatch:!1,licensePlateAndVinProps:{},offerType:""};var mi=a("../node_modules/lodash/merge.js"),ui=a.n(mi),hi=a("../node_modules/lodash/assignInWith.js"),gi=a.n(hi),fi=a("../node_modules/lodash/find.js"),bi=a.n(fi),Ei=a("../node_modules/lodash/clone.js"),yi=a.n(Ei),vi=a("./site-modules/shared/components/map-link/map-link.jsx"),Ci=a("./site-modules/shared/utils/address-format.js"),Si=a("./site-modules/shared/utils/phone-format.js"),Ti=a("./site-modules/shared/components/arrow-link/arrow-link.jsx");a("./site-modules/shared/components/radio-list/radio-list.scss"),a("./site-modules/shared/components/appraisal/trade-in-appraiser-steps/instant-offer-step/nearest-stores/nearest-stores.scss");const Ii={creative_id:G.W,action_name:J.b.ACTION_RECEIVE_EPO,action_category:J.b.USER_ACTION_CATEGORY,action_cause:J.b.ACTION_CAUSE_USER_INPUT};class _i extends x.Component{constructor(){super(...arguments),this.state={selectedStore:"",store:{}},this.selectStore=(e=>{let t=e.target.value;const a=this.props.nearestStores,s=bi()(a,{name:t});this.setState({selectedStore:t}),this.props.updateStore(s),ee.a.fireTrackAction({event_type:J.b.EVENT_TYPE_ACTION_COMPLETED,event_data:Object(n.a)({},Ii,{subaction_name:J.b.SUBACTION_DEALER_SELECT_DISTANCE,value:s.distance})})})}static getDerivedStateFromProps(e,t){const a=e.store,s=a&&a.name||"";return t.selectedStore!==s?{selectedStore:s}:null}render(){const e=this.props,t=e.nearestStores,a=e.isSecondary,s=e.store,i=e.appointmentUri,n=e.toggleScheduleAppointmentDrawer,r=this.state.selectedStore,o=e=>k.a.createElement("div",{className:"nearest-stores w-100"},e);if(C()(s)||C()(t))return o(k.a.createElement(Ai,null));const l=s.storeUrl;return o(k.a.createElement(x.Fragment,null,k.a.createElement(Qs.a,null),k.a.createElement("div",{className:"mb-1_5"},"You can redeem this offer at any CarMax location. Here are your nearby locations:"),k.a.createElement("div",{className:"nearest-stores-list radio-list"},t.map((e,t)=>{let s=e.id,o=e.name,l=e.addressLine1,c=e.addressLine2,d=e.city,p=e.state,m=e.distance;return k.a.createElement(da.a,{key:`${s}${a?"-2":""}`,formGroupClassName:Me()("rounded store-wrapper p-0_5 pl-0_75 pos-r",{"active pt-1_75 bg-white":r===o}),labelContainerClassName:"w-100 pos-r pl-0 pr-0_25",name:`${s}${a?"-2":""}`,onChange:this.selectStore,checked:r===o,listItem:{trackingId:"dealer_select",trackingValue:`Dealer ${t+1}`,title:o,hideValue:!0,text:k.a.createElement("div",{className:"size-14 d-flex flex-column"},k.a.createElement("div",{className:"pl-1_25"},r===o&&k.a.createElement("div",{className:"text-uppercase bg-primary text-white text-center font-weight-bold badge"},"Your store"),r!==o&&k.a.createElement("div",{className:"make-store"},"Make this my store"),k.a.createElement("div",{className:"font-weight-bold"},"CarMax ",o),r===o&&k.a.createElement(x.Fragment,null,k.a.createElement("div",null,l),k.a.createElement("div",null,c),r===o&&k.a.createElement("div",{className:"d-flex mt-0_25"},k.a.createElement("div",{className:"phone-link"},k.a.createElement("a",{href:`tel:${Object(Si.a)(G.k)}`,"data-tracking-id":"instant_offer_call_dealer","data-tracking-value":Object(Si.b)(G.k),className:"text-underline mt-0_25"},Object(Si.c)(G.k))),k.a.createElement("span",{className:"text-gray mx-0_25"},"|"),k.a.createElement(vi.a,{location:Object(Ci.b)({street:l,city:d,state:p},o),className:"text-underline",target:"_blank","data-tracking-id":"partner_offer_directions_to_dealer","data-tracking-ignore-value":!0},"Directions"))),k.a.createElement("div",{className:"size-12 text-gray mt-0_25"},m," miles away")),r===o&&k.a.createElement(x.Fragment,null,k.a.createElement("hr",{className:"w-100 mx-0 my-0_5"}),k.a.createElement(Ti.a,{className:"size-14 pl-1_25",target:"_blank",to:i,rel:"noopener noreferrer","data-tracking-id":"instant_offer_dealer_site_clickout","data-tracking-value":`Schedule an appointment - location${a?"2":""}`,onClick:n},"Schedule an appointment")))}})})),k.a.createElement("div",{className:"ml-2"},k.a.createElement(Ti.a,{className:"mt-0_5 size-14",target:"_blank",to:l,rel:"noopener noreferrer","data-tracking-id":"instant_offer_dealer_site_clickout"},Ni.LOCATION))))}}_i.propTypes={nearestStores:w.a.arrayOf(w.a.shape({id:w.a.string,name:w.a.string,addressLine1:w.a.string,addressLine2:w.a.string,latitude:w.a.number,longitude:w.a.number,message:w.a.string,phone:w.a.string,city:w.a.string,state:w.a.string,zipCode:w.a.string,storeUrl:w.a.string,distance:w.a.number})),isSecondary:w.a.bool,updateStore:w.a.func,store:w.a.shape({name:w.a.string,addressLine1:w.a.string,addressLine2:w.a.string,longitude:w.a.number,latitude:w.a.number,storeUrl:w.a.string}),appointmentUri:w.a.string.isRequired,toggleScheduleAppointmentDrawer:w.a.func},_i.defaultProps={nearestStores:[],isSecondary:!1,updateStore:b.a,store:{},toggleScheduleAppointmentDrawer:b.a};const Ni={MAKE_APPOINTMENT:"Make an appointment",PRINT:"Print Offer",EMAIL:"Email Offer",BY_APPOINTMENT:"By Appointment Only",LOCATION:"View More Locations",SCHEDULE_AN_APPOINTMENT:"Schedule an appointment",SCHEDULE_APPOINTMENT:"Schedule Appointment",CARMAX:"CarMax",TEXT_OFFER:"Text Offer"};function Oi(e){let t=e.appointmentUri,a=e.ctaTextsTracking,s=e.renderNoOffer,i=e.storeUrl,n=e.isMobile,r=e.toggleScheduleAppointmentDrawer,o=t;return s?(o=t||i)?k.a.createElement(ct.a,{color:"success",target:"_blank",className:"heading-5 text-white text-capitalize py-0_75 py-lg-0_5 px-lg-3",href:o,rel:"noopener noreferrer",block:n,"data-tracking-id":"instant_offer_dealer_site_clickout","data-tracking-value":a.SCHEDULE_APPOINTMENT,onClick:r},Ni.SCHEDULE_APPOINTMENT):null:o?k.a.createElement(Ti.a,{className:"size-14",target:"_blank",to:o,rel:"noopener noreferrer","data-tracking-id":"instant_offer_dealer_site_clickout","data-tracking-value":a.SCHEDULE_APPOINTMENT,onClick:r},Ni.SCHEDULE_AN_APPOINTMENT):null}Oi.propTypes={appointmentUri:w.a.string,ctaTextsTracking:w.a.shape({}),renderNoOffer:w.a.bool,storeUrl:w.a.string,isMobile:w.a.bool,toggleScheduleAppointmentDrawer:w.a.func},Oi.defaultProps={appointmentUri:"",ctaTextsTracking:{},renderNoOffer:!1,storeUrl:"",isMobile:!1,toggleScheduleAppointmentDrawer:null};const Pi=(e,t,a)=>{const s=((e,t)=>e||t)(e,a);return k.a.createElement(q.a,{xs:12,className:"text-left size-12 mt-1"},"1 For the safety of our customers and associates, due to the COVID-19 Pandemic, CarMax will fulfill this offer by appointment only.\xa0",s&&k.a.createElement(Ta.a,{className:"appointment-text-link text-primary-darker",target:"_blank",to:s,"data-tracking-id":"partner_schedule_dropoff","data-tracking-value":`${t.MAKE_APPOINTMENT} - legal`},Ni.MAKE_APPOINTMENT,"."))};function Ai(e){let t=e.ctaTextsTracking;return k.a.createElement("div",{className:"size-14"},k.a.createElement("div",{className:"mb-0_5"},k.a.createElement(Qs.a,null)),k.a.createElement("div",null,"You can redeem this offer at any CarMax location."," ",k.a.createElement("span",{className:"text-primary-darker"},k.a.createElement(Ta.a,{target:"_blank",to:G.l,rel:"noopener noreferrer","data-tracking-id":"instant_offer_dealer_site_clickout","data-tracking-value":t.LOCATION},"Click here to locate a CarMax near you"))))}function xi(e){let t=e.appointmentUri,a=e.store,s=e.ctaTextsTracking,i=e.renderNoOffer;const n=e=>k.a.createElement("div",{className:Me()("size-14 text-center",{"text-lg-left":!i})},e);if(C()(a))return n(k.a.createElement(Ai,{ctaTextsTracking:s}));const r=a.name,o=a.addressLine1,l=a.addressLine2,c=a.city,d=a.state,p=a.storeUrl,m=a.message===Ni.BY_APPOINTMENT,u=k.a.createElement(x.Fragment,null,m&&k.a.createElement("div",{className:"carmax-appointment-btn d-inline-block my-0_5 p-0_5"},Ni.BY_APPOINTMENT,k.a.createElement("sup",null,"1")),k.a.createElement("div",{className:"font-weight-bold"},"CarMax ",r),k.a.createElement("div",null,o),k.a.createElement("div",null,l)),h=o&&c&&d,g=t||p,f=!h&&u;return n(k.a.createElement(x.Fragment,null,g&&i?k.a.createElement("a",{href:g,className:"d-block mb-0_5","data-tracking-id":"instant_offer_dealer_site_clickout",target:"_blank",rel:"noopener noreferrer","data-tracking-value":s.CARMAX},k.a.createElement(Qs.a,null)):k.a.createElement("div",{className:"mb-0_5"},k.a.createElement(Qs.a,null)),m&&t?k.a.createElement(Ta.a,{target:"_blank",to:t,"data-tracking-id":"partner_schedule_dropoff","data-tracking-value":s.BY_APPOINTMENT},f):f,h&&k.a.createElement(vi.a,{location:Object(Ci.b)({street:o,city:c,state:d},r),className:"text-decoration-none-hover",target:"_blank","data-tracking-id":"partner_offer_directions_to_dealer","data-tracking-ignore-value":!0},u),k.a.createElement("a",{href:`tel:${Object(Si.a)(G.k)}`,"data-tracking-id":"instant_offer_call_dealer","data-tracking-value":Object(Si.b)(G.k),className:"d-block text-primary-darker"},Object(Si.c)(G.k)),k.a.createElement(Ti.a,{className:"mt-0_5 size-14",target:"_blank",to:p,rel:"noopener noreferrer","data-tracking-id":"instant_offer_dealer_site_clickout","data-tracking-value":s.LOCATION},Ni.LOCATION)))}Ai.propTypes={ctaTextsTracking:w.a.objectOf(w.a.string)},Ai.defaultProps={ctaTextsTracking:Ni},xi.propTypes={appointmentUri:w.a.string,store:w.a.shape({name:w.a.string,addressLine1:w.a.string,addressLine2:w.a.string,city:w.a.string,state:w.a.string,storeUrl:w.a.string}),ctaTextsTracking:w.a.objectOf(w.a.string),renderNoOffer:w.a.bool},xi.defaultProps={appointmentUri:null,store:{},ctaTextsTracking:Ni,renderNoOffer:!1};class ki extends x.Component{constructor(e){super(e),this.getInstructionSteps=(e=>{return[{header:"Make an appointment with CarMax",body:k.a.createElement(Oi,{appointmentUri:e,ctaTextsTracking:this.ctaTextsTracking,toggleScheduleAppointmentDrawer:this.props.toggleScheduleAppointmentDrawer})},{header:"Bring in offer, vehicle and the following:",body:k.a.createElement("ul",{className:"pl-1 mb-0"},k.a.createElement("li",null,"Title (if it's not with the lien holder)**"),k.a.createElement("li",null,"Valid Registration"),k.a.createElement("li",null,"Valid state-issued photo ID for all titleholders"),k.a.createElement("li",null,"All keys and remotes (if applicable)"))},{header:"We'll verify the vehicle's condition and you'll leave with payment in-hand",body:null}].map((e,t)=>{const a=`epo-instant-offer-instruction-${t}`,s=e.header,i=e.body;return k.a.createElement("div",{key:a,className:"how-to-item pos-r d-flex pb-1"},k.a.createElement("div",{className:"mr-0_5 text-center size-20"},k.a.createElement("span",{className:"step-counter rounded-circle d-inline-block"},t+1)),k.a.createElement("div",{className:"mt-0_25"},k.a.createElement("div",{className:"font-weight-bold"},s),i&&k.a.createElement("div",{className:"mt-0_5"},i)))})}),this.getNearestStores=(()=>{const e=this.props,t=e.appointmentUri,a=e.store,s=e.nearestStores,i=e.isSecondary,n=e.toggleScheduleAppointmentDrawer,r=e.updateStore;return k.a.createElement(_i,{nearestStores:s,store:a,appointmentUri:t,updateStore:r,toggleScheduleAppointmentDrawer:n,isSecondary:i})}),this.getEmailButton=(()=>{const e=this.props,t=e.handleEmailReportClick;return e.emailReportStatus===G.u.SENT?k.a.createElement("div",{className:"heading-6 d-flex align-items-center mr-sm-1 flex-column-reverse flex-sm-row"},"Email Sent!",k.a.createElement("i",{className:"icon-checkmark pl-sm-0_25 text-success mb-0_25 mb-sm-0"})):k.a.createElement(ct.a,{color:"link",className:"appraisal-email-report-btn size-16 p-0 mr-sm-1 text-primary-darker d-flex align-items-center flex-column-reverse flex-sm-row",onClick:t,"data-tracking-id":"begin_sign_up","data-tracking-value":this.ctaTextsTracking.EMAIL},k.a.createElement("span",{className:"font-weight-normal text-transform-none"},Ni.EMAIL),k.a.createElement("i",{className:"pl-sm-0_25 icon icon-envelop3 text-gray mb-0_25 mb-sm-0"}))}),this.emailAndPrintButtons=(()=>{const e=this.props,t=e.redemptionCertificateUri,a=e.isSecondary,s=e.handleOpenSendToPhoneModal;return k.a.createElement(F.a,null,k.a.createElement(q.a,{xs:12,className:"d-flex justify-content-around justify-content-sm-center my-1"},a&&this.getEmailButton(),k.a.createElement(Ta.a,{className:"print-offer-btn size-16 mx-sm-1 text-primary-darker d-flex align-items-center flex-column-reverse flex-sm-row",target:"_blank",to:t,"data-tracking-id":"partner_schedule_dropoff","data-tracking-value":this.ctaTextsTracking.PRINT},k.a.createElement("span",null,Ni.PRINT),k.a.createElement("i",{className:"pl-sm-0_25 icon icon-printer3 text-gray mb-0_25 mb-sm-0"})),k.a.createElement(ct.a,{color:"link",className:"appraisal-text-offer-btn size-16 p-0 ml-sm-1 text-primary-darker d-flex align-items-center flex-column-reverse flex-sm-row",onClick:s,"data-tracking-id":"partner_send_to_phone","data-tracking-value":this.ctaTextsTracking.TEXT_OFFER},k.a.createElement("span",{className:"font-weight-normal text-transform-none"},Ni.TEXT_OFFER),k.a.createElement("i",{className:"pl-sm-0_25 icon-mobile text-gray mb-0_25 mb-sm-0"}))))}),this.ctaTextsTracking=this.props.isSecondary?gi()({},Ni,(e,t)=>`${t}2`):yi()(Ni)}componentDidMount(){const e=this.props,t=e.nearestStores,a=e.store,s=!C()(a)&&bi()(t,{name:a.name});s&&!this.props.isSecondary&&ee.a.fireTrackAction({event_type:J.b.EVENT_TYPE_ACTION_COMPLETED,event_data:Object(n.a)({},Ii,{subaction_name:J.b.SUBACTION_DEFAULT_DEALER_DISTANCE,value:s.distance})})}render(){const e=this.props,t=e.appointmentUri,a=e.store,s=e.isMobile,i=a&&a.message===Ni.BY_APPOINTMENT;return k.a.createElement("div",{className:"instant-offer-partner-next-steps"},!s&&k.a.createElement("div",{className:"mt-0_5"},this.emailAndPrintButtons()),s?k.a.createElement(F.a,{className:"text-gray-darker px-lg-1 justify-content-center justify-content-lg-between"},k.a.createElement(q.a,{xs:12},k.a.createElement("div",{className:"heading-4 mt-1_5"},"How to Redeem Your Offer")),k.a.createElement(q.a,{xs:12,sm:8,lg:7,className:"size-14 text-center mt-1_5"},k.a.createElement("div",{className:"d-inline-block text-left"},this.getInstructionSteps(t))),k.a.createElement(q.a,{xs:12,lg:6,xl:5,className:"mb-1_5"},s&&this.emailAndPrintButtons(),k.a.createElement("div",{className:"mt-1"},this.getNearestStores()))):k.a.createElement(F.a,{className:"text-gray-darker px-lg-1 justify-content-center justify-content-lg-between flex-column-reverse flex-md-row"},k.a.createElement(q.a,{xs:12,sm:8,lg:6},k.a.createElement("div",{className:"heading-4 my-1_5"},"How to Redeem Your Offer"),k.a.createElement("div",{className:"d-inline-block text-left size-14"},this.getInstructionSteps(t))),k.a.createElement(q.a,{xs:12,lg:6,xl:5,className:"my-1_5"},this.getNearestStores())),k.a.createElement(F.a,null,k.a.createElement(q.a,{xs:12,className:"size-12 mb-1"},"*The offer from CarMax is contingent on your providing accurate information on Edmunds.com. CarMax will conduct an in-person verification of your vehicle and evaluate other vehicle use and history information prior to finalizing the offer. Any differences between the information you provide about your vehicle and the vehicle's actual condition, use, and history may impact the offer you receive from CarMax."),k.a.createElement(q.a,{xs:12,className:"size-12"},"**The title must be provided at the time of sale and all titleholders should be present. If a previously paid-off lien is listed on the title, you will need both the title and lien release from the lienholder before CarMax can purchase your car."),i&&Pi(t,this.ctaTextsTracking)))}}function Vi(e){const t=e.store,a=e.isMobile,s=e.eval2657Recipe,i=e.appointmentUri,n=e.isSecondary,r=e.renderNoOffer,o=e.toggleScheduleAppointmentDrawer,l=t||{},c=l.message,d=l.storeUrl,p=c===Ni.BY_APPOINTMENT,m=gi()({},Ni,(e,t)=>`${t}${r?" CarMax":""}${n?"2":""}`);return k.a.createElement(x.Fragment,null,k.a.createElement(xi,{appointmentUri:i,store:t,ctaTextsTracking:m,renderNoOffer:r}),k.a.createElement("div",{className:"mt-1"},"chal"===s?k.a.createElement(Oi,{appointmentUri:i,ctaTextsTracking:m,renderNoOffer:r,storeUrl:d,isMobile:a,toggleScheduleAppointmentDrawer:o}):k.a.createElement(Oi,{appointmentUri:i,ctaTextsTracking:m,renderNoOffer:r,storeUrl:d,isMobile:a})),p&&Pi(i,m,d))}ki.propTypes={appointmentUri:w.a.string.isRequired,redemptionCertificateUri:w.a.string.isRequired,nearestStores:w.a.arrayOf(w.a.shape({})),store:w.a.shape({name:w.a.string,addressLine1:w.a.string,addressLine2:w.a.string,longitude:w.a.number,latitude:w.a.number}),handleEmailReportClick:w.a.func.isRequired,emailReportStatus:w.a.string,isSecondary:w.a.bool,isMobile:w.a.bool,toggleScheduleAppointmentDrawer:w.a.func,updateStore:w.a.func,handleOpenSendToPhoneModal:w.a.func},ki.defaultProps={emailReportStatus:"",isSecondary:!1,isMobile:!1,toggleScheduleAppointmentDrawer:null,store:{},updateStore:b.a,nearestStores:[],handleOpenSendToPhoneModal:b.a},Vi.propTypes={renderNoOffer:w.a.bool,store:w.a.shape({}),isMobile:w.a.bool,eval2657Recipe:w.a.string,conditionPricing:w.a.shape({}),appointmentUri:w.a.string,isSecondary:w.a.bool,toggleScheduleAppointmentDrawer:w.a.func},Vi.defaultProps={renderNoOffer:!1,store:{},isMobile:!1,eval2657Recipe:"ctrl",conditionPricing:{},appointmentUri:null,isSecondary:!1,toggleScheduleAppointmentDrawer:b.a};var wi=a("../node_modules/lodash/compact.js"),ji=a.n(wi),Ri=a("./site-modules/shared/utils/core-link-constructor.js"),Mi=a("./site-modules/shared/utils/build-and-price-link-constructor.js"),Di=a("./site-modules/shared/utils/srp-link-constructor.js");function Li(e){let t=e.getVehicleData,a=e.toggleAppraiserDrawer;const s=t(),i=s.makeName,n=s.modelName,r=s.year,o=s.modelSlug,l=s.makeSlug,c=s.publicationState;return 5!==ji()([i,n,r,o,l]).length?null:k.a.createElement("div",null,k.a.createElement("h3",{className:"heading-4 mb-1"},"Learn more about the ",r," ",i," ",n),k.a.createElement("ul",{className:"list-unstyled"},k.a.createElement("li",{className:"mb-1"},k.a.createElement(Ta.a,{to:Object(Ri.b)({makeSlug:l,modelSlug:o}),className:"text-primary-darker"},"Read Reviews for the ",i," ",n)),[Cs.a.NEW,Cs.a.NEW_USED].includes(c)&&k.a.createElement("li",{className:"mb-1"},k.a.createElement(Ta.a,{to:Object(Mi.a)({make:l,model:o,year:r}),className:"text-primary-darker"},"Build & Price a New ",i," ",n)),k.a.createElement("li",{className:"mb-1"},k.a.createElement(Ta.a,{to:Object(Di.p)({make:l,model:o}),className:"text-primary-darker"},"Browse Inventory for a ",i," ",n," near you")),k.a.createElement("li",null,a?k.a.createElement(ct.a,{color:"default",className:"text-primary-darker bg-white p-0 m-0 text-capitalize size-16 border-0",onClick:a},"Start Over"):k.a.createElement(Ta.a,{to:_a.b.APPRAISAL_LANDING,className:"text-primary-darker"},"Start Over"))))}Li.propTypes={getVehicleData:w.a.func.isRequired,toggleAppraiserDrawer:w.a.func},Li.defaultProps={toggleAppraiserDrawer:null};a("./site-modules/shared/components/appraisal/trade-in-appraiser-steps/appraisal-report-step/appraisal-report-error-message.scss");class Fi extends x.Component{componentDidMount(){const e=this.props,t=e.vin;e.isExtendedReport&&ee.a.fireTrackAction(G.eb),t&&ee.a.fireTrackAction(ui()({},G.eb,{event_data:{subaction_name:J.b.SUBACTION_VIN_ERROR,value:`${this.props.vin}_${J.b.SUBACTION_EPO_OFFER}_TMV_REPORT_ERROR`}}))}render(){const e=this.props,t=e.getVehicleData,a=e.isMobile,s=e.appointmentUri,i=e.conditionPricing,n=e.eval2657Recipe,r=e.partnerOfferEligibilityResponse,o=e.toggleScheduleAppointmentDrawer,l=e.isExtendedReport,c=e.toggleAppraiserDrawer;return k.a.createElement("div",{"data-tracking-parent":G.U},k.a.createElement("div",{className:Me()("appraisal-report-error-message text-gray-darker text-center pt-2_5 pb-1_5 px-2 mb-2")},k.a.createElement("span",{className:"icon-edmunds-car text-primary size-30"}),k.a.createElement("h2",{className:"size-24"},"We're sorry. We are unable to generate an appraisal report for your car at this time."),l&&k.a.createElement(x.Fragment,null,k.a.createElement("p",{className:"size-16 mb-2"},"You can still schedule an appointment with CarMax to sell your car."),k.a.createElement(Vi,{appointmentUri:s,conditionPricing:i,eval2657Recipe:n,isMobile:a,store:r.store,renderNoOffer:!0,toggleScheduleAppointmentDrawer:o}))),k.a.createElement(Li,{getVehicleData:t,toggleAppraiserDrawer:c}))}}Fi.propTypes={getVehicleData:w.a.func.isRequired,partnerOfferEligibilityResponse:w.a.shape({}),isMobile:w.a.bool,isExtendedReport:w.a.bool,eval2657Recipe:w.a.string,conditionPricing:w.a.shape({}),appointmentUri:w.a.string,vin:w.a.string,toggleScheduleAppointmentDrawer:w.a.func,toggleAppraiserDrawer:w.a.func},Fi.defaultProps={partnerOfferEligibilityResponse:{},isMobile:!1,isExtendedReport:!1,eval2657Recipe:"ctrl",vin:"",conditionPricing:{},appointmentUri:null,toggleScheduleAppointmentDrawer:b.a,toggleAppraiserDrawer:null};a("./site-modules/shared/components/appraisal/trade-in-appraiser-steps/appraisal-report-step/appraisal-report-step.scss");class Ui extends x.Component{constructor(){super(...arguments),this.state={nationalPrices:{},regionalPrices:{},colorPrices:{},optionalPrices:{},totalPrices:{},mileagePrices:{},conditionPrices:{},isLoading:!0,optionalPricesValues:[],allConditionPricing:{},isTradeInCalculated:!1,conditionPricing:{}},this.getPriceList=(()=>{const e=this.state,t=e.nationalPrices,a=e.regionalPrices,s=e.totalPrices,i=e.mileagePrices,r=e.colorPrices,o=e.conditionPrices,l=e.optionalPrices,c=e.optionalPricesValues,d=this.props.isExtendedReport;return[Object(n.a)({},G.X.NATIONAL_BASE,{value:t}),Object(n.a)({},G.X.OPTIONAL_EQUIPMENT,{value:l,values:c}),Object(n.a)({},G.X.COLOR_ADJUSTMENT,{value:r}),Object(n.a)({},G.X.REGIONAL_ADJUSTMENT,{value:a}),Object(n.a)({},G.X.MILEAGE_ADJUSTMENT,{value:i}),Object(n.a)({},G.X.CONDITION_ADJUSTMENT,{value:o}),{title:d?"Value":"Value at Time of Build",value:s,isTotal:!0}]}),this.getAppraisalReportEditControls=(()=>{const e=this.props,t=e.color,a=e.options,s=e.hasPartnerEquipment,i=e.showAddEquipment;return{showExteriorColor:0!==Object.keys(t).length,showAddEquipment:i&&s&&0===a.length}}),this.initialize=(()=>{const e=this.props,t=e.resetEmailReportStatus,a=e.onReportFormed;t(),this.calculateTradeIn(),a(!0,G.ab)}),this.resetIsTradeInCalculated=(()=>this.setState({isTradeInCalculated:!1})),this.calculateTradeIn=(()=>{const e=this.props,t=e.condition,a=e.options,s=e.creativeId,i=e.tmvConditions,r=_e(t,i,a),o=Te(i);this.setState(Object(n.a)({},r,{allConditionPricing:Ne(i,a),isTradeInCalculated:!0,conditionPricing:o}),()=>{const e=this.props,t=e.isExtendedReport,a=e.updateStepsState,r=e.vehiclePhoto,o=this.state,l=o.totalPrices,c=o.certifiedUsedPrice,d=o.allConditionPricing,p=o.nationalPrices,m=!!l[G.kb],u=!C()(p),h=Oe(d);m&&a("allConditionTotalPrices",h),t&&!C()(l)&&u?(ee.a.fireTrackAction(Object(G.bb)(s)),a("appraisalEmailData",Object(n.a)({},this.state,{certifiedUsedPrice:c,vehiclePhoto:r,tmvConditions:i}))):m&&u||ee.a.fireTrackAction(Object(G.I)(s))})}),this.displayReport=(()=>{const e=this.props,t=e.getVehicleData,a=e.onPayoffChange,i=e.changeStep,n=e.sellingPrice,r=e.msrp,o=e.residualValue,l=e.isPurchase,c=e.isUsed,d=e.vehiclePhoto,p=e.color,m=e.condition,u=e.mileage,h=e.zipCode,g=this.state.totalPrices;return k.a.createElement(xs,Object(s.a)({getVehicleData:t,changeStep:i,onPayoffChange:a,priceList:this.getPriceList(),totalPrices:g,sellingPrice:n,msrp:r,residualValue:o,isPurchase:l,isUsed:c,vehiclePhoto:d,color:p,condition:m,mileage:u,zipCode:h},this.getAppraisalReportEditControls()))}),this.displayExtendedReport=(()=>{const e=this.props,t=e.getVehicleData,a=e.changeStep,i=e.updateStepsState,n=e.selectedReportType,r=e.stepId,o=e.stepNextId,l=e.creativeId,c=e.zipCode,d=e.color,p=e.options,m=e.condition,u=e.mileage,h=e.vin,g=e.emailReportStatus,f=e.resetEmailReportStatus,b=e.isMobile,E=e.isPartnerOfferEligible,y=e.hideDelightedSurvey,v=e.handleDelightedSurveyClick,C=e.partnerOfferEligibilityResponse,S=e.showReportExtendedPriceOnly,T=e.isEscapeHatch,I=e.licensePlateAndVinProps,_=e.offerType,N=this.state,O=N.totalPrices,P=N.allConditionPricing;return k.a.createElement(pi,Object(s.a)({getVehicleData:t,changeStep:a,updateStepsState:i,totalPrices:O,allConditionPricing:P,selectedReportType:n,stepId:r,stepNextId:o,creativeId:l,zipCode:c,color:d,options:p,condition:m,mileage:u,vin:h,partnerOfferEligibilityResponse:C,emailReportStatus:g,resetEmailReportStatus:f,isMobile:b,isPartnerOfferEligible:E,hideDelightedSurvey:y,handleDelightedSurveyClick:v,showReportPricesOnly:S},this.getAppraisalReportEditControls(),{isEscapeHatch:T,licensePlateAndVinProps:I,offerType:_}))})}static getDerivedStateFromProps(e){return{isLoading:c()(e.tmvConditions)}}componentDidMount(){this.props.isReportActive&&this.initialize()}componentDidUpdate(e){const t=this.props,a=t.isReportActive,s=t.tmvConditions,i=this.state.isTradeInCalculated,n=!u()(s,e.tmvConditions);!a||g()(s)||i&&!n||this.initialize(),!a&&i&&!g()(s)&&n&&this.resetIsTradeInCalculated()}render(){const e=this.state,t=e.totalPrices,a=e.isLoading,s=e.nationalPrices,i=e.conditionPricing,n=e.isTradeInCalculated,r=this.props,o=r.getVehicleData,l=r.isExtendedReport,c=r.creativeId,d=r.renderNoAppraisalReportMessage,p=r.partnerOfferEligibilityResponse,m=r.isMobile,u=r.toggleScheduleAppointmentDrawer,h=r.vin,g=r.isReportActive,f=r.toggleAppraiserDrawer,b=r.isEscapeHatch,E=o(),y=E.makeName,v=E.modelName,S=E.year,T=(l&&!C()(t)||t[G.kb])&&!C()(s),I=l?this.displayExtendedReport():this.displayReport();d&&d(!T);const _=T?k.a.createElement("div",{"data-tracking-parent":c},k.a.createElement("div",{className:Me()("appraisal-report-step",{"mx-md-1_5":b})},I)):k.a.createElement(x.Fragment,null,g&&n&&k.a.createElement(Fi,{getVehicleData:o,partnerOfferEligibilityResponse:p,isMobile:m,vin:h,isExtendedReport:l,conditionPricing:i,toggleScheduleAppointmentDrawer:u,toggleAppraiserDrawer:f}));return k.a.createElement(us.a,{isLoading:a},a?k.a.createElement("div",{className:"display-2"},"Calculating appraisal for your ",S," ",y," ",v,"!"):_)}}Ui.propTypes={stepId:w.a.string,onReportFormed:w.a.func.isRequired,updateStepsState:w.a.func.isRequired,getVehicleData:w.a.func.isRequired,toggleAppraiserDrawer:w.a.func,vehiclePhoto:w.a.string,zipCode:w.a.string,mileage:w.a.string,condition:w.a.string,vin:w.a.string,options:w.a.arrayOf(w.a.shape({})),color:w.a.shape({}),partnerOfferEligibilityResponse:w.a.shape({}),isReportActive:w.a.bool,isMobile:w.a.bool,isExtendedReport:w.a.bool,emailReportStatus:w.a.string,resetEmailReportStatus:w.a.func,stepNextId:w.a.string,isPartnerOfferEligible:w.a.bool,hideDelightedSurvey:w.a.bool,handleDelightedSurveyClick:w.a.func,onPayoffChange:w.a.func.isRequired,isPurchase:w.a.bool,showReportExtendedPriceOnly:w.a.bool,sellingPrice:w.a.number,msrp:w.a.number,residualValue:w.a.number,isUsed:w.a.bool,selectedReportType:w.a.string,creativeId:w.a.string,tmvConditions:w.a.shape({}),hasPartnerEquipment:w.a.bool,changeStep:w.a.func,renderNoAppraisalReportMessage:w.a.func,toggleScheduleAppointmentDrawer:w.a.func,isEscapeHatch:w.a.bool,licensePlateAndVinProps:w.a.shape({}),showAddEquipment:w.a.bool,offerType:w.a.string},Ui.defaultProps={stepId:G.ab,vehiclePhoto:"",resetEmailReportStatus:b.a,toggleScheduleAppointmentDrawer:b.a,toggleAppraiserDrawer:null,zipCode:"",mileage:"",vin:"",condition:"",options:[],color:{},partnerOfferEligibilityResponse:{},isReportActive:!1,isMobile:!1,isExtendedReport:!1,emailReportStatus:"",stepNextId:"",isPartnerOfferEligible:!1,hideDelightedSurvey:!1,handleDelightedSurveyClick:null,isPurchase:!1,showReportExtendedPriceOnly:!1,sellingPrice:0,msrp:0,residualValue:0,isUsed:!1,selectedReportType:G.kb,creativeId:G.g,tmvConditions:null,hasPartnerEquipment:!1,changeStep:b.a,renderNoAppraisalReportMessage:null,isEscapeHatch:!1,licensePlateAndVinProps:{},showAddEquipment:!0,offerType:""};const qi={vehiclePhoto:Object($.a)(e=>{const t=(0,e.getVehicleData)().styleId;return t?`styles.${t}.photo`:""},te.c)},zi=Object(z.c)((e,t)=>{const a=t.getVehicleData().styleId;return{tmvConditions:T()(e.vehicle,Object(te.D)(a))}})(Object($.b)(Ui,qi));var Bi=a("../node_modules/lodash/flatten.js"),$i=a.n(Bi),Yi=a("../node_modules/lodash/map.js"),Hi=a.n(Yi),Zi=a("../node_modules/lodash/groupBy.js"),Gi=a.n(Zi),Wi=a("../node_modules/lodash/pick.js"),Qi=a.n(Wi),Ki=a("../node_modules/lodash/omit.js"),Xi=a.n(Ki),Ji=a("../node_modules/lodash/cloneDeep.js"),en=a.n(Ji);const tn={ADD:"add",REMOVE:"remove"},an={SINGLE:"single",MULTIPLE:"multiple"};a("./site-modules/shared/components/appraisal/trade-in-appraiser-steps/offer-conditions-step/radio-group/radio-group.scss");function sn(e){let t=e.onChange,a=e.answers,s=e.selected,i=e.trackingId,n=e.name,r=e.title,o=e.className,l=e.labelTextClassName;const d=new Map;return a.forEach(e=>{let t=e.detailQuestions;c()(t)||t.forEach(e=>{let t=e.id,a=e.answerType;d.set(`${t}`,a)})}),k.a.createElement("div",{className:Me()("conditions-questions-radio-group question",o)},r&&k.a.createElement(Ft.a,{className:"text-gray-darker mb-1"},r),k.a.createElement(_t.a,{className:"d-flex","data-toggle":"buttons",role:"radiogroup","aria-label":r},a.map(e=>{let a=e.id,r=e.desc,o=e.detailQuestions;const p=`condition-question-selection-${n}-${a}`,m=(e=>e===s)(a);return k.a.createElement(ct.a,{key:p,tag:Ft.a,for:p,outline:!m,size:"responsive",color:m?"primary":"secondary",className:Me()("radio-group-button d-flex align-items-center justify-content-center mb-0 py-0_25",{active:m,"bg-white text-gray-darker":!m})},k.a.createElement(qt.a,{"data-tracking-id":i,"data-tracking-value":r,type:"radio",id:p,name:n,value:a,onChange:function(){const e={detailQuestionsAnswerTypeById:d,actionType:c()(o)?tn.REMOVE:tn.ADD};t({name:n,value:a,action:e})},checked:m,className:"condition-question-input"}),k.a.createElement("span",{className:Me()("font-weight-normal",l)},r))})))}sn.propTypes={onChange:w.a.func.isRequired,answers:w.a.arrayOf(w.a.shape({id:w.a.oneOfType([w.a.string,w.a.number]),desc:w.a.string})).isRequired,name:w.a.oneOfType([w.a.number,w.a.string]).isRequired,selected:w.a.oneOfType([w.a.number,w.a.string]),title:w.a.string,trackingId:w.a.string,className:w.a.string,labelTextClassName:w.a.string},sn.defaultProps={selected:"",title:"",trackingId:"",className:"",labelTextClassName:""};var nn=a("./site-modules/shared/components/checkbox/checkbox.jsx");a("./site-modules/shared/components/appraisal/trade-in-appraiser-steps/offer-conditions-step/checkbox-list/checkbox-list.scss");const rn=/\(select all that apply\)/gi;function on(e){let t=e.onChange,a=e.name,s=e.title,i=e.answers,n=e.selected,r=e.className;const o=rn.test(s);return k.a.createElement("div",{className:Me()("conditions-questions-checkbox-list question",r)},k.a.createElement("div",{className:"text-gray-darker mb-1"},s.replace(rn,""),o&&k.a.createElement("span",{className:"small text-gray-dark"},"Select all that apply")),i.map(e=>{let s=e.id,i=e.desc;const r=`condition-question-selection-${a}-${s}`,o=n[s]||!1;return k.a.createElement("div",{className:"mb-1",key:r},k.a.createElement(nn.a,{id:r,name:a,value:s,onChange:function(e){const i=e.target.checked;t({name:a,value:s,isSelected:i})},checked:o,labelClassName:"condition-question-input",labelText:i,textLabelClassName:"text-gray-darker pl-1_75"}))}))}on.propTypes={onChange:w.a.func.isRequired,answers:w.a.arrayOf(w.a.shape({id:w.a.oneOfType([w.a.string,w.a.number]),desc:w.a.string})).isRequired,name:w.a.oneOfType([w.a.string,w.a.number]).isRequired,title:w.a.string,selected:w.a.shape({id:w.a.bool}),className:w.a.string},on.defaultProps={title:"",selected:{},className:""};const ln={"exterior--paint-body-work":{v2QuestionId:300,v2AnswerIdsByV1Value:{0:1,1:2,2:3,3:4}},"interior--broken-parts":{v2QuestionId:410,v2AnswerIdsByV1Value:{0:1,1:2,2:3,3:4}},"interior--fabric-issues":{v2QuestionId:420,v2AnswerIdsByV1Value:{0:1,1:2,2:3,3:4}},tires:{v2QuestionId:500,v2AnswerIdsByV1Value:{0:1,2:2,4:3}},keys:{v2QuestionId:600,v2AnswerIdsByV1Value:{1:2,2:1}},"mechanical--odometer-untrusted":{v2QuestionId:1e3,v2AnswerIdsByV1Value:{false:1,true:2}},"other--odor":{v2QuestionId:830,v2AnswerIdsByV1Value:{false:1,true:2}},"accidents--minor":{v2QuestionId:110,v2AnswerIdsByV1Value:{0:1,1:2,2:3},v2ParentQuestionId:100,v2ParentAnswerId:2},"accidents--major":{v2QuestionId:120,v2AnswerIdsByV1Value:{0:1,1:2,2:3},v2ParentQuestionId:100,v2ParentAnswerId:2},"mechanical--inoperable":{v2QuestionId:210,v2AnswerIdsByV1Value:{false:1,true:2},v2ParentQuestionId:200,v2ParentAnswerId:2},"mechanical--engine":{v2QuestionId:220,v2AnswerIdsByV1Value:{false:1,true:2},v2ParentQuestionId:200,v2ParentAnswerId:2},"mechanical--transmission":{v2QuestionId:230,v2AnswerIdsByV1Value:{false:1,true:2},v2ParentQuestionId:200,v2ParentAnswerId:2},"after-market--suspension":{v2QuestionId:710,v2AnswerIdsByV1Value:{false:1,true:2},v2ParentQuestionId:700,v2ParentAnswerId:2},"after-market--engine":{v2QuestionId:720,v2AnswerIdsByV1Value:{false:1,true:2},v2ParentQuestionId:700,v2ParentAnswerId:2},"other--convertible-top":{v2QuestionId:810,v2AnswerIdsByV1Value:{false:1,true:2},v2ParentQuestionId:800,v2ParentAnswerId:2},"other--air-conditioning":{v2QuestionId:820,v2AnswerIdsByV1Value:{false:1,true:2},v2ParentQuestionId:800,v2ParentAnswerId:2},"other--missing-standard-equipment":{v2QuestionId:840,v2AnswerIdsByV1Value:{false:1,true:2},v2ParentQuestionId:800,v2ParentAnswerId:2},"frame-damage":{v2QuestionId:910,v2AnswerIdsByV1Value:{false:1,true:2},v2ParentQuestionId:900,v2ParentAnswerId:2},"flood-damage":{v2QuestionId:920,v2AnswerIdsByV1Value:{false:1,true:2},v2ParentQuestionId:900,v2ParentAnswerId:2},"mechanical--check-engine-light":{v2QuestionId:240,v2AnswerIdsByV1Value:{index:1},v2ParentQuestionId:200,v2ParentAnswerId:2,answerType:"multiple"},"mechanical--4x4-service":{v2QuestionId:240,v2AnswerIdsByV1Value:{index:2},v2ParentQuestionId:200,v2ParentAnswerId:2,answerType:"multiple"},"mechanical--check-brakes-light":{v2QuestionId:240,v2AnswerIdsByV1Value:{index:3},v2ParentQuestionId:200,v2ParentAnswerId:2,answerType:"multiple"},"mechanical--other-warning-light":{v2QuestionId:240,v2AnswerIdsByV1Value:{index:4},v2ParentQuestionId:200,v2ParentAnswerId:2,answerType:"multiple"},"mechanical--brakes":{v2QuestionId:251,v2AnswerIdsByV1Value:{index:1},v2ParentQuestionId:200,v2ParentAnswerId:2,answerType:"multiple"},"mechanical--steering":{v2QuestionId:251,v2AnswerIdsByV1Value:{index:2},v2ParentQuestionId:200,v2ParentAnswerId:2,answerType:"multiple"},"mechanical--suspension":{v2QuestionId:251,v2AnswerIdsByV1Value:{index:3},v2ParentQuestionId:200,v2ParentAnswerId:2,answerType:"multiple"},"mechanical--other":{v2QuestionId:251,v2AnswerIdsByV1Value:{index:4},v2ParentQuestionId:200,v2ParentAnswerId:2,answerType:"multiple"}};a("./site-modules/shared/components/appraisal/trade-in-appraiser-steps/offer-conditions-step/offer-conditions-step.scss");const cn=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0,n=arguments.length>5?arguments[5]:void 0;const r=e.name,o=t.name,l=a.year;return![G.A,G.x].includes(n)&&4===ji()([r,o,l,s||i]).length};function dn(e){return e===an.MULTIPLE?{}:1}class pn extends x.Component{constructor(){var e;e=super(...arguments),this.state={offerPayload:{},questionsAnswered:{}},this.onAnswerSelect=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const a=e.state,s=a.offerPayload,i=a.questionsAnswered,n={},r=t.actionType,o=t.detailQuestionsAnswerTypeById,l=void 0===o?new Map:o,c=Array.from(l.keys());switch(r){case tn.ADD:Object.keys(s).concat(c).forEach(e=>{const t=l.get(e)===an.MULTIPLE?{}:void 0;n[e]=i[e]||s[e]||t});break;case tn.REMOVE:Object.keys(Xi()(s,c)).forEach(e=>{n[e]=i[e]||s[e]});break;default:Object.keys(s).forEach(e=>{n[e]=i[e]||s[e]})}e.setState({offerPayload:n})},this.handleSelect=(e=>{const t=e.name,a=e.value,s=e.isSelected;this.setState(e=>{let i=e.questionsAnswered;const n=en()(i);return n[t]||(n[t]={}),n[t][a]=s,{questionsAnswered:n}},()=>this.onAnswerSelect())}),this.handleChange=(e=>{const t=e.name,a=e.value,s=e.action;this.setState(e=>{let s=e.questionsAnswered;return{questionsAnswered:Object(n.a)({},s,{[t]:a})}},()=>this.onAnswerSelect(s))}),this.renderDetailQuestions=(e=>{const t=this.state.questionsAnswered;return C()(e)?null:k.a.createElement(x.Fragment,null,e.map(e=>{const a=e.id,s=e.desc,i=e.answers,n=e.answerType,r=t[a],o=`detail-question-${a}`;switch(n){case an.MULTIPLE:return k.a.createElement(Vt.a,{key:o},k.a.createElement(on,{onChange:this.handleSelect,title:s,answers:i,name:a,selected:r}));default:return k.a.createElement(Vt.a,{key:o},k.a.createElement(sn,{onChange:this.handleChange,title:s,answers:i,name:a,selected:r,labelTextClassName:"text-transform-none"}))}}))}),this.renderFieldError=(e=>{const t=this.props.errorMap,a=this.state.offerPayload,s=t.get(ce.b);if(!s)return null;const i=s.singleQuestionErrorMessage,n=s.multipleQuestionsErrorMessage,r=e.map(e=>{return`${e.id}`}),o=r.length>1,l=Qi()(a,r),c=r.every(e=>l[e]),d=e.reduce((e,t)=>{let s=t.id,i=t.answers;const n=a[s],r=i.find(e=>e.id===n);return r?e.concat(r):e},[]).reduce((e,t)=>{let a=t.detailQuestions;return a?e.concat(a.map(e=>{return`${e.id}`})):e},[]),p=Qi()(a,d),m=d.every(e=>p[e]);let u="";return c?m||(u=n):u=o?n:i,k.a.createElement(Yt.a,{id:`conditionsQuestionsSection-error-${Object(zt.c)()}`,classes:"mb-0_5",error:u})})}static getDerivedStateFromProps(e,t){const a=e.conditionsQuestions.questionsUngrouped,s=e.isStepActive,i=e.vinEligibility,n=t.offerPayload,r=t.questionsAnswered;if(!C()(a)&&C()(n)){const e={};return a.forEach(t=>{const a=t.id,s=t.answerType;t.answerType===an.MULTIPLE?e[a]=r[a]||dn(s):e[a]=r[a]}),{offerPayload:e}}if(s&&C()(r)&&i){if(!C()(i.lastConditionQuestionResponses)){const e=i.lastConditionQuestionResponses,t={};return Object.keys(e).forEach(a=>{const s=e[a],i=ln[a],n=i.v2QuestionId,r=i.v2AnswerIdsByV1Value,o=i.v2ParentQuestionId,l=i.v2ParentAnswerId,c=i.answerType;if(o&&!t[o]&&(t[o]=l),c===an.MULTIPLE){const e=t[n]||dn(c);e[r.index]=!0,t[n]=e}else t[n]=r[s]}),a.forEach(e=>{let a=e.id,s=e.answerType;t[a]||(t[a]=dn(s))}),{questionsAnswered:t,offerPayload:t}}if(!C()(i.lastQuoteConditionQuestionsResponses)){const e=i.lastQuoteConditionQuestionsResponses,t={},s=$i()(a.map(e=>{let t=e.answers;return $i()(ji()(t.map(e=>{return e.detailQuestions})))}));return a.concat(s).forEach(a=>{let s=a.id,i=a.answerType;const n=e.find(e=>s===e.id)||{},r=T()(n,"answers",[]);t[s]=i===an.SINGLE&&r.length?r[0]:dn(i),i===an.MULTIPLE&&r.forEach(e=>{t[s][e]=!0})}),{questionsAnswered:t,offerPayload:t}}}return null}shouldComponentUpdate(e,t){const a=this.props,s=a.conditionsQuestions,i=a.vinEligibility,n=a.isStepActive,r=a.errorMap,o=this.state,l=o.questionsAnswered,c=o.offerPayload;return!(e.isStepActive===n&&u()(e.conditionsQuestions,s)&&u()(e.vinEligibility,i)&&u()(e.errorMap,r)&&u()(t.offerPayload,c)&&u()(t.questionsAnswered,l))}componentDidUpdate(e,t){const a=this.props,s=a.vinEligibility,i=a.updateQuestionnaireResponses,n=a.onPartnerOfferVinEligibilityUpdate,r=a.vehicle,o=a.isVinFromDrawer,l=a.isStepActive,c=a.predefinedVin,d=a.activeStepId,p=this.state.offerPayload,m=r.make,h=r.model,g=r.year,f=l!==e.isStepActive,b=p!==t.offerPayload;if(cn(m,h,g,c,o,d)&&!C()(s)&&!u()(s,e.vinEligibility)){n(s.isEligibleVin)}l&&(f||b)&&i(p)}render(){const e=this.props.conditionsQuestions,t=e.questionsUngrouped,a=e.questionsGroupedByCategory,s=this.state.questionsAnswered;return k.a.createElement(F.a,{className:"offer-conditions-step"},!t||t&&!t.length?k.a.createElement(q.a,{xs:12,className:"display-3 px-0"},"We don't have any more questions about your vehicle's condition. Please continue to the next step."):k.a.createElement(q.a,{xs:12,className:"conditions-questions"},Hi()(a,(e,t)=>k.a.createElement("div",{className:"questions-section",key:`questions-section-${t}`},t&&k.a.createElement("div",{className:"text-gray-darker mb-0_5 font-weight-bold"},t),this.renderFieldError(e),e.map(e=>{const t=e.id,a=e.desc,i=e.answers,n=s[t],r=(bi()(i,["id",n])||[]).detailQuestions;switch(e.answerType){case an.MULTIPLE:return k.a.createElement(Vt.a,{key:`parent-question-${t}`},k.a.createElement(on,{onChange:this.handleSelect,title:a,answers:i,name:t,selected:n}));default:return k.a.createElement(x.Fragment,{key:`parent-question-${t}`},k.a.createElement(Vt.a,{key:`parent-question-${t}`},k.a.createElement(sn,{onChange:this.handleChange,title:a,answers:i,name:t,selected:n,labelTextClassName:"text-transform-none"})),this.renderDetailQuestions(r))}})))))}}pn.propTypes={updateQuestionnaireResponses:w.a.func.isRequired,onPartnerOfferVinEligibilityUpdate:w.a.func,conditionsQuestions:w.a.shape({questionsUngrouped:se.a.ConditionsQuestions,questionsGroupedByCategory:w.a.shape({[w.a.string]:se.a.ConditionsQuestions})}),vinEligibility:se.a.VinEligibility,errorMap:w.a.objectOf(w.a.shape({})),isStepActive:w.a.bool,vehicle:w.a.shape({make:w.a.shape({name:w.a.string}),model:w.a.shape({name:w.a.string}),year:w.a.shape({year:w.a.string})}),location:w.a.shape({}),isVinFromDrawer:w.a.bool,predefinedVin:w.a.string,activeStepId:w.a.string},pn.defaultProps={conditionsQuestions:{questionsUngrouped:[],questionsGroupedByCategory:{}},vinEligibility:null,errorMap:new Map,isStepActive:!1,onPartnerOfferVinEligibilityUpdate:b.a,vehicle:{},location:null,isVinFromDrawer:!1,predefinedVin:"",activeStepId:""};const mn={conditionsQuestions:Object($.a)(e=>{let t=e.location;return Object(se.g)(t)},se.b,e=>({questionsUngrouped:e,questionsGroupedByCategory:Gi()(e,"category")})),vinEligibility:Object($.a)(e=>{let t=e.vehicle,a=t.make,s=t.model,i=t.year,n=e.vin,r=e.isEligibleHardcodeYmmBypass,o=e.isStepActive,l=e.predefinedVin,c=e.isVinFromDrawer,d=e.activeStepId;return o||cn(a,s,i,l,c,d)?Object(se.f)({vin:n||l,make:a.name,model:s.name,year:i.year,isEligibleHardcodeYmmBypass:r}):null},se.b)},un=Object(z.c)(e=>({location:T()(e,"pageContext.location")}))(Object($.b)(pn,mn));var hn=a("../node_modules/reactstrap/lib/Modal.js"),gn=a.n(hn),fn=a("../node_modules/reactstrap/lib/ModalBody.js"),bn=a.n(fn),En=a("../node_modules/create-hmac/browser.js"),yn=a.n(En);a("./site-modules/shared/components/appraisal/trade-in-appraiser-steps/epo-processing/epo-processing.scss");const vn=[{successStateKey:"isProcessing",copy:"Processing your vehicle information"},{successStateKey:"isAnalyzing",copy:"Analyzing thousands of local transactions"},{successStateKey:"isPreparing",copy:"Searching for a no-obligation offer on your car"}],Cn=e=>e?{processing:1150,analyzing:1750,preparing:3e3,completed:3500}:{processing:350,analyzing:500,preparing:850,completed:1e3};class Sn extends x.Component{constructor(e){super(e),this.state={isAnalyzing:!1,isProcessing:!1,isPreparing:!1},this.setProcessing=(()=>this.setState({isProcessing:!0})),this.setAnalyzing=(()=>this.setState({isAnalyzing:!0})),this.setPreparing=(()=>this.setState({isPreparing:!0}));const t=e.isMobile,a=Cn(t),s=a.processing,i=a.analyzing,n=a.preparing,r=a.completed;this.processingTimeout=_()(this.setProcessing,s),this.analyzingTimeout=_()(this.setAnalyzing,i),this.preparingTimeout=_()(this.setPreparing,n),this.completedTimeout=_()(this.props.setLoadingStatus,r)}componentDidMount(){this.processingTimeout(),this.analyzingTimeout()}componentDidUpdate(e){const t=this.props.isSubmittingFinished;t&&e.isSubmittingFinished!==t&&(this.preparingTimeout(),this.completedTimeout())}componentWllUnmount(){this.analyzingTimeout.cancel(),this.processingTimeout.cancel(),this.completedTimeout.cancel(),this.completedTimeout.cancel()}render(){const e=this.props.className;return k.a.createElement("div",{className:Me()("epo-processing mx-auto",e)},k.a.createElement("div",{className:"mb-3"},k.a.createElement("div",{className:"instant-offer-animated-cash mx-auto",style:{background:`url(${Object(Ze.q)("/img/eva/appraisal-cash-icon-animated.svg")}) no-repeat center`}})),k.a.createElement("ul",{className:"p-0"},vn.map(e=>{let t=e.successStateKey,a=e.copy;return k.a.createElement(x.Fragment,{key:a},k.a.createElement("li",{className:"d-flex mb-1"},k.a.createElement("i",{className:Me()("icon icon-checkmark-circle size-20",{"text-success":this.state[t]})}),k.a.createElement("div",{className:"ml-0_75"},a)))})))}}Sn.propTypes={className:w.a.string,isSubmittingFinished:w.a.bool.isRequired,setLoadingStatus:w.a.func.isRequired,isMobile:w.a.bool},Sn.defaultProps={className:"",isSubmittingAppraisal:!0,isMobile:!1};var Tn=a("../node_modules/reactstrap/lib/InputGroupAddon.js"),In=a.n(Tn);const _n={GREAT:"Great",GOOD:"Good",FAIR:"Fair",BAD:"Bad"},Nn="great-deal",On="good-deal",Pn="regular",An=(e,t,a)=>{const s=a>e.outstanding;return s?Nn:a>t&&!s?On:Pn},xn=(e,t)=>{const a=((e,t)=>{let a="Fair";return Nn===e?a="Great":On===e?a="Good":t&&(a="Bad"),a})(e.displayType,e.isBadDeal);return{event_type:J.b.EVENT_TYPE_ACTION_COMPLETED,event_data:{action_name:J.b.ACTION_RECEIVE_EPO,action_category:J.b.USER_ACTION_CATEGORY,action_cause:J.b.ACTION_CAUSE_BUTTON_CLICK,subaction_name:J.b.OFFER_STRENGTH,creative_id:t,value:a}}},kn=(e,t,a)=>{const s=e||{},i=a>s.outstanding,n=a>t&&!i;return a<s.rough||!a||!t||C()(e)?_n.BAD:i?_n.GREAT:n?_n.GOOD:_n.FAIR},Vn={PRINT:"Print Offer",EMAIL:"Email Offer",SEND_TO_PHONE:"Send To Phone",SCHEDULE_APPOINTMENT:"Schedule Appointment"};class wn extends x.PureComponent{static getDerivedStateFromProps(e,t){const a=e.condition,s=e.conditionPricing,i=e.valuation,n=e.emailReportStatus,r=t.offerRangeDisplayType,o=t.isSubmitting,l=t.isSubmitted,c=s[a],d=An(s,c,i);return d!==r?{offerRangeDisplayType:d}:n===G.u.SENT?{isSubmitting:!1,isSubmitted:l||o}:null}constructor(e){super(e),this.onEmailFormFieldFocus=(()=>{const e=this.props,t=e.emailReportStatus,a=e.resetEmailReportStatus;this.state.isSubmitted&&(t===G.u.SENT&&a(),this.setState({isSubmitted:!1}))}),this.getIsBadDeal=(()=>{const e=this.props;return e.valuation<e.conditionPricing.rough}),this.getInlineEmailForm=(()=>{const e=this.props,t=e.validationErrors.email,a=e.validate,s=e.userEmail,i=this.state,n=i.isSubmitting,r=i.isSubmitted,o=r?"Sent!":"SEND";return k.a.createElement(x.Fragment,null,k.a.createElement(ra.a,{id:`offer-card-email-${this.uniqInputId}`,"data-tracking-id":"provide_email","data-tracking-ignore-value":!0,maxLength:255,name:"email",type:"email",inputClassName:"border-right-0 pr-0 pl-0_5 text-gray-darker size-16 py-0_5 email-input","aria-label":"Enter Your Email",ref:this.inputRef,isValid:!t,required:!0,defaultValue:s,placeholder:"Email \u2020",onFocus:this.onEmailFormFieldFocus,onBlur:a,className:Me()("input-group",{"mb-0_25":t,"mb-0":!t}),readOnly:n,addon:k.a.createElement(In.a,{addonType:"append",className:"p-0"},k.a.createElement(ct.a,{"data-tracking-id":"submit_sign_up_email",size:"sm",color:"success",type:"submit",className:"px-0_5 rounded-right border-left-0 addon-btn text-transform-none",disabled:r},n?k.a.createElement(gt.a,{size:14,thickness:1,color:"white"}):k.a.createElement("span",{className:"size-16"},o)))}),t&&k.a.createElement("div",{id:`error-email-${this.uniqInputId}`,className:"size-12 text-danger text-left"},t))}),this.getEmailButton=(()=>k.a.createElement(ut.a,{noValidate:!0,onSubmit:this.handleSubmitEmail,className:"mb-1"},k.a.createElement("div",{className:"size-16 font-weight-bold mb-0_5 text-gray-darker mt-1 text-left"},"Save this offer."),this.getInlineEmailForm())),this.getPrintLink=(()=>{const e=this.props.redemptionCertificateUri;return k.a.createElement(ct.a,{color:"link",target:"_blank",className:"text-capitalize size-16 offer-cta-secondary font-weight-normal mt-0 p-0 text-left mb-1_5",href:e,"data-tracking-id":"partner_schedule_dropoff","data-tracking-value":`${this.ctaTextsTracking.PRINT} - MAIN`},k.a.createElement("i",{className:"icon-printer3 pr-0_5"}),Vn.PRINT)}),this.getDisclaimer=((e,t)=>k.a.createElement("div",{className:Me()("size-10",t)},"\u2020 By clicking ",e,", I accept the terms of the"," ",k.a.createElement(Ta.a,{target:"_blank",rel:"noopener noreferrer",to:"/about/visitor-agreement.html",className:"text-gray-darker disclaimer"},k.a.createElement("u",null,"Edmunds Visitor Agreement")),"."," ",k.a.createElement(Ta.a,{target:"_blank",rel:"noopener noreferrer",to:"/about/privacy.html",className:"text-gray-darker disclaimer"},k.a.createElement("u",null,"Our collection and use of your personal information")),".")),this.getCtas=(()=>{const e=this.props.appointmentUri;return k.a.createElement("div",{className:"offer-footer-cta-wrapper d-flex flex-column"},k.a.createElement(ct.a,{color:"link",target:"_blank",className:"text-decoration-none size-16 font-weight-normal p-0 mt-0 text-left mb-0_5",href:e,"data-tracking-id":"instant_offer_dealer_site_clickout","data-tracking-value":`${this.ctaTextsTracking.SCHEDULE_APPOINTMENT} - OFFER CARD`},k.a.createElement("i",{className:"icon-calendar4 pr-0_5"}),k.a.createElement("u",null,Vn.SCHEDULE_APPOINTMENT)),this.getPrintLink())}),this.uniqInputId=Object(zt.c)(),this.handleSubmitEmail=(async e=>{const t=this.props,a=t.validate,s=t.resetEmailReportStatus;e.preventDefault(),e.stopPropagation();const i=a();i&&s(),this.setState({isSubmitting:i},async()=>{const e=this.props,t=e.isAuthenticated,a=e.doesNotHaveEmail,s=e.updateIdmData,n=e.validateEmailAsync,r=e.fields;await rt({isAuthenticated:t,doesNotHaveEmail:a,isValid:i,emailField:r.email,updateIdmData:s,validateEmailAsync:n,fetchSignInMethodsForEmail:qs.e,fireValidExistingEmailCustomEvent:ne.g}),i&&ee.a.fireTrackAction({event_type:J.b.EVENT_TYPE_ACTION_PROGRESS,event_data:{action_name:J.b.ACTION_SIGN_UP,subaction_name:J.b.SUCCESS_EMAIL_ONLY_SIGN_UP,action_cause:J.b.ACTION_CAUSE_BUTTON_CLICK,creative_id:G.W}})})}),this.inputRef=(e=>{if(e)return this.props.fieldRef(e.props.name,e)});const t=this.props,a=t.condition,s=t.conditionPricing,i=t.valuation,n=s[a],r=An(s,n,i);this.state={appraisalValue:n,offerRangeDisplayType:r,isSubmitting:!1,isSubmitted:!1,isEmailModalOpened:!1},this.ctaTextsTracking=this.props.isSecondary?gi()({},Vn,(e,t)=>`${t}2`):yi()(Vn)}componentDidMount(){const e=this.props.isSecondary,t=this.state.offerRangeDisplayType;if(!e){const e=this.getIsBadDeal();ee.a.fireTrackAction(xn({displayType:t,isBadDeal:e},G.W))}}render(){const e=this.props,t=e.getVehicleData,a=e.code,s=e.expiresDateUtc,i=e.vin,n=e.valuation,r=t(),o=r.makeName,l=r.modelName,c=r.year;return k.a.createElement(x.Fragment,null,k.a.createElement("div",{className:"instant-offer-partner-offer-card rounded px-md-0_5","data-tracking-parent":G.W},k.a.createElement(F.a,{className:"flex-md-row-reverse"},k.a.createElement(q.a,{xs:12,className:"instant-offer-partner-offer-card-wrapper d-flex align-items-center flex-column text-center px-1_5 px-md-1 bg-gray-extra-light py-1_5"},k.a.createElement(Qs.a,{className:"carmax-logo mb-0_5"}),k.a.createElement("div",{className:Me()("text-primary mb-0_25")},k.a.createElement("div",{className:"valuation font-weight-bold"},Object(We.a)(n),"*")),k.a.createElement("div",{className:"vehicle-detail text-gray-darker size-14 text-center"},k.a.createElement("div",{className:"font-weight-bold"},c," ",o," ",l),k.a.createElement("div",{className:"text-uppercase"},"VIN: ",i)),k.a.createElement("div",{className:"buttons-container"}," ",k.a.createElement(x.Fragment,null,this.getEmailButton(),this.getCtas())),k.a.createElement("div",{className:"text-gray-darker size-12 d-flex offer-details"},k.a.createElement("div",null,"Offer Code: ",a),k.a.createElement("div",{className:"ml-0_5 pl-0_5"},"Valid until ",He()(s,"UTC:mm/dd/yyyy")))))),this.getDisclaimer("Send","mt-1_25"))}}wn.propTypes={getVehicleData:w.a.func.isRequired,conditionPricing:w.a.shape({outstanding:w.a.number,rough:w.a.number}).isRequired,valuation:w.a.number.isRequired,code:w.a.string.isRequired,redemptionCertificateUri:w.a.string.isRequired,expiresDateUtc:w.a.string.isRequired,vin:w.a.string.isRequired,emailReportStatus:w.a.string,resetEmailReportStatus:w.a.func,condition:w.a.string,isSecondary:w.a.bool,fields:w.a.shape({}),userEmail:w.a.string,validationErrors:w.a.objectOf(w.a.string),fieldRef:w.a.func.isRequired,validate:w.a.func.isRequired,appointmentUri:w.a.string,validateEmailAsync:w.a.func.isRequired},wn.defaultProps={emailReportStatus:"",resetEmailReportStatus:b.a,condition:G.n.AVERAGE,isMobile:!1,isSecondary:!1,fields:{},userEmail:"",validationErrors:{},appointmentUri:""};const jn=Object(H.a)(wn),Rn=Object(z.c)(e=>({userEmail:T()(e,"profile.data.idm.identifiers.email[0]"),isAuthenticated:e.profile.isAuthenticated,doesNotHaveEmail:!T()(e,"profile.data.idm.identifiers.email[0]")}))(Object(la.a)(jn,nt));a("./site-modules/shared/components/appraisal/trade-in-appraiser-steps/instant-offer-step/instant-offer-partner-offer/instant-offer-partner-offer.scss");class Mn extends x.PureComponent{constructor(){super(...arguments),this.state={offerStrength:kn(this.props.conditionPricing,this.props.conditionPricing[this.props.condition],this.props.valuation)},this.getRangeText=(()=>{let e="",t="",a="";switch(this.state.offerStrength){case _n.GREAT:e="is offering you",t=k.a.createElement("span",{className:"text-primary"},"well above"),a=k.a.createElement(x.Fragment,null,"Edmunds True Market Value\xae for your car");break;case _n.GOOD:e="is offering you",t=k.a.createElement("span",{className:"text-primary"},"above"),a=k.a.createElement(x.Fragment,null,"Edmunds True Market Value\xae for your car");break;case _n.FAIR:case _n.BAD:default:e="has made a",t=k.a.createElement("span",{className:"text-primary"},"no-obligation"),a="offer for your car"}return k.a.createElement(x.Fragment,null,"CarMax ",e," ",k.a.createElement("div",null,t," ",a))})}render(){const e=this.props,t=e.getVehicleData,a=e.code,s=e.redemptionCertificateUri,i=e.expiresDateUtc,n=e.conditionPricing,r=e.valuation,o=e.vin,l=e.emailReportStatus,c=e.className,d=e.isMobile,p=e.isSecondary,m=e.condition,u=e.appointmentUri,h=e.resetEmailReportStatus;return k.a.createElement("div",{className:Me()("instant-offer-partner-offer",c)},k.a.createElement("div",{className:"instant-offer-partner-offer-message text-center mb-1_5"},k.a.createElement("div",null,k.a.createElement("i",{className:"icon-edmunds-car text-primary size-30 mr-0_5"})),k.a.createElement("div",{className:d?"heading-4":"heading-3"},this.getRangeText())),k.a.createElement(F.a,{className:"justify-content-center"},k.a.createElement(q.a,{className:"w-100 instant-offer-partner-offer-card-container"},k.a.createElement(Rn,{getVehicleData:t,conditionPricing:n,valuation:r,code:a,redemptionCertificateUri:s,expiresDateUtc:i,vin:o,emailReportStatus:l,resetEmailReportStatus:h,isMobile:d,isSecondary:p,condition:m,appointmentUri:u}))))}}Mn.propTypes={getVehicleData:w.a.func.isRequired,conditionPricing:w.a.shape({outstanding:w.a.number,rough:w.a.number}).isRequired,valuation:w.a.number.isRequired,code:w.a.string.isRequired,redemptionCertificateUri:w.a.string.isRequired,expiresDateUtc:w.a.string.isRequired,vin:w.a.string.isRequired,emailReportStatus:w.a.string,resetEmailReportStatus:w.a.func,className:w.a.string,condition:w.a.string,isMobile:w.a.bool,isSecondary:w.a.bool,appointmentUri:w.a.string},Mn.defaultProps={emailReportStatus:"",resetEmailReportStatus:b.a,className:"",condition:"",isMobile:!1,isSecondary:!1,appointmentUri:""};var Dn=a("../node_modules/reactstrap/lib/Container.js"),Ln=a.n(Dn),Fn=a("./site-modules/shared/components/drawer/drawer-close-button/drawer-close-button.jsx"),Un=a("./site-modules/shared/components/calendar/calendar.jsx"),qn=a("./site-modules/shared/components/time-selector/time-selector.jsx"),zn=a("./site-modules/shared/utils/date-utils.js");const Bn=0,$n=()=>Object(zn.a)(1),Yn=()=>{const e=Object(zn.a)(1),t=new Date(new Date(e).setDate(e.getDate()+30));return[{before:e},{after:t},{daysOfWeek:[Bn]}]},Hn=()=>{const e=[];for(let t=11;t<=20;t+=.5){const a=Math.floor(t),s=60*(t-a),i=`${`${a>12?a-12:a}:${s>0?s:"00"}`} ${a>=12?"PM":"AM"}`;e.push({title:i,value:i,start:t,end:t+.5})}return e};a("./site-modules/shared/components/appraisal/trade-in-appraiser-steps/instant-offer-step/schedule-appointment-drawer/schedule-appointment.scss");const Zn={email:{test:Je.a.validateEmail,errorText:"Please enter your correct email address."},firstName:{test:Je.a.validateFirstName,errorText:"Please correct your name. Special characters cannot be included."},lastName:{test:Je.a.validateName,errorText:"Please correct your name. Special characters cannot be included."}};class Gn extends x.Component{constructor(){super(...arguments),this.state={selectedAppointmentDate:$n(),selectedAppointmentTime:Hn()[0].value,isSubmitted:!1,uniqId:Object(zt.c)()},this.onDateChange=(e=>this.setState({selectedAppointmentDate:e})),this.onTimeChange=((e,t)=>this.setState({selectedAppointmentTime:t})),this.handleSubmit=(e=>{e.preventDefault();const t=this.props,a=t.validate,s=t.vin,i=this.state,n=i.selectedAppointmentDate,r=i.selectedAppointmentTime;a()&&(this.fireTracking(J.b.SCHEDULE_APPOINTMENT,"success"),this.fireTracking(J.b.APPOINTMENT_DATE,n),this.fireTracking(J.b.APPOINTMENT_TIME,r),this.fireTracking(J.b.APPOINTMENT_VIN,s),this.setState({isSubmitted:!0}))}),this.fireTracking=((e,t)=>{ee.a.fireTrackAction({event_type:J.b.EVENT_TYPE_ACTION_PROGRESS,event_data:{action_name:J.b.ACTION_RECEIVE_EPO,action_category:J.b.USER_ACTION_CATEGORY,action_cause:J.b.ACTION_CAUSE_BUTTON_CLICK,subaction_name:e,creative_id:this.props.trackingCreativeId,value:t}})}),this.inputRef=(e=>{if(e)return this.props.fieldRef(e.props.name,e)})}render(){const e=this.props,t=e.toggleDrawer,a=e.validationErrors,s=e.valuation,i=e.storeInfo,n=e.getVehicleData,r=e.isMobile;if(!i)return null;const o=i.name,l=i.addressLine1,c=i.addressLine2,d=this.state,p=d.selectedAppointmentDate,m=d.selectedAppointmentTime,u=d.isSubmitted,h=d.uniqId,g=a.firstName,f=a.lastName,b=a.email,E=n(),y=E.makeName,v=E.modelName,C=E.year;return k.a.createElement("div",{className:"instant-offer-schedule-appointment text-gray-darker"},(s||u)&&k.a.createElement("div",{className:"heading-2 mb-2"},u?"You're all set!":k.a.createElement(x.Fragment,null,"Redeem Your ",k.a.createElement("span",{className:"text-primary"},Object(We.c)(s),"*")," Cash Offer")),k.a.createElement("div",{className:"heading-4 mb-1_5"},u?`Your appointment has been scheduled on ${He()(p,"mmmm dS, yyyy")} at ${m} with:`:"Schedule your appointment with:"),k.a.createElement(Qs.a,{className:"partner-logo mb-0_75"}),k.a.createElement("div",null,"CarMax ",o),k.a.createElement("div",null,l),k.a.createElement("div",null,c),k.a.createElement("a",{href:`tel:${Object(Si.a)(G.k)}`,"data-tracking-id":"instant_offer_call_dealer","data-tracking-value":Object(Si.b)(G.k),className:"d-block text-primary-darker"},Object(Si.c)(G.k)),u?k.a.createElement(ct.a,{type:"submit",color:"success",size:"lg",className:"text-transform-none mt-2",block:!0,"data-tracking-id":"schedule_appointment_drawer_close",onClick:t},"Got it"):k.a.createElement(x.Fragment,null,k.a.createElement(F.a,{className:"my-2"},k.a.createElement(q.a,{md:6,className:"mb-1 mb-md-0"},k.a.createElement(Un.a,{selectedDate:p,onChange:this.onDateChange,disabledDays:Yn(),deliveryDateClassName:Me()("py-0_5",{"size-16":r,medium:!r})})),k.a.createElement(q.a,{md:6},k.a.createElement(qn.a,{onChange:this.onTimeChange,deliveryTime:m,timeIntervals:Hn(),deliveryTimeClassName:Me()("py-0_5",{"size-16":r,medium:!r})}))),k.a.createElement(ut.a,{noValidate:!0,onSubmit:this.handleSubmit},k.a.createElement(F.a,null,k.a.createElement(q.a,{md:6},k.a.createElement(ra.a,{id:`first-name-${h}`,maxLength:255,name:`first-name-${h}`,type:"text",label:"First Name",labelClassName:"small pl-0_25",inputClassName:Me()({"size-16":r}),ref:this.inputRef,isValid:!g,required:!0}),k.a.createElement(Yt.a,{id:`first-name-${h}-error`,error:g,classes:"mb-1"})),k.a.createElement(q.a,{md:6},k.a.createElement(ra.a,{id:`last-name-${h}`,maxLength:255,name:`last-name-${h}`,type:"text",label:"Last Name",labelClassName:"small pl-0_25",inputClassName:Me()({"size-16":r}),ref:this.inputRef,isValid:!f,required:!0}),k.a.createElement(Yt.a,{id:`last-name-${h}-error`,error:f,classes:"mb-1"}))),k.a.createElement(ra.a,{id:`email-${h}`,maxLength:255,name:`email-${h}`,type:"text",label:"Email",labelClassName:"small pl-0_25",inputClassName:Me()({"size-16":r}),ref:this.inputRef,isValid:!b,required:!0}),k.a.createElement(Yt.a,{id:`email-${h}-error`,error:b,classes:"mb-1"}),k.a.createElement(ct.a,{type:"submit",color:"success",className:"text-transform-none px-0",block:!0,size:"lg","data-tracking-id":"submit_schedule_appointment"},"Schedule Appointment")),k.a.createElement("div",{className:"size-12 text-gray mt-1"},k.a.createElement("div",{className:"mb-1"},"*By clicking Submit, you agree to provide your information to CarMax for the purpose of scheduling an appointment to redeem the offer for your ",C," ",y," ",v,"."),k.a.createElement("div",null,"*The offer from CarMax is contingent on your providing accurate information on Edmunds.com. CarMax will conduct an in-person verification of your vehicle and evaluate other vehicle use and history information prior to finalizing the offer. Any differences between the information you provide about your vehicle and the vehicle's actual condition, use, and history may impact the offer you receive from CarMax."))))}}Gn.propTypes={toggleDrawer:w.a.func.isRequired,getVehicleData:w.a.func.isRequired,fieldRef:w.a.func.isRequired,validate:w.a.func.isRequired,validationErrors:w.a.objectOf(w.a.string),fields:w.a.shape({phoneNumber:w.a.shape({value:w.a.func})}),valuation:w.a.number,storeInfo:w.a.shape({name:w.a.string,addressLine1:w.a.string,addressLine2:w.a.string}),vin:w.a.string,trackingCreativeId:w.a.string,isMobile:w.a.bool},Gn.defaultProps={validationErrors:{},fields:{phoneNumber:{value:b.a}},valuation:0,storeInfo:{},vin:"",trackingCreativeId:"",isMobile:!1};const Wn=Object(la.a)(Gn,Zn),Qn="epo-appointment-drawer";class Kn extends x.Component{constructor(){super(...arguments),this.state={isDrawerComponentLoaded:!1}}static getDerivedStateFromProps(e,t){return e.isOpen&&!t.isDrawerComponentLoaded?{isDrawerComponentLoaded:!0}:null}render(){const e=this.props,t=e.isOpen,a=e.onToggle,s=e.drawerClassNames,i=e.valuation,n=e.storeInfo,r=e.vin,o=e.getVehicleData,l=e.isMobile,c=this.state.isDrawerComponentLoaded;return k.a.createElement(na.a,{side:"right",size:"small","data-tracking-parent":Qn,classNames:{drawerContent:"px-0_5",drawer:s},toggle:a,isOpen:t},c&&k.a.createElement(Ln.a,{className:"mx-auto px-md-0 instant-offer-schedule-appointment-container"},k.a.createElement(Fn.a,{onClick:a,className:"mb-0 mb-md-2 d-block schedule-appointment-close mx-auto",lgBtnClass:"pl-0",smBtnClass:"d-inline-block",trackingId:"schedule_appointment_drawer_close",trackingValue:"x"}),k.a.createElement(Wn,{getVehicleData:o,valuation:i,storeInfo:n,vin:r,toggleDrawer:a,trackingCreativeId:Qn,isMobile:l})))}}Kn.propTypes={isOpen:w.a.bool.isRequired,onToggle:w.a.func.isRequired,getVehicleData:w.a.func.isRequired,drawerClassNames:w.a.string,valuation:w.a.number,storeInfo:w.a.shape({name:w.a.string,addressLine1:w.a.string,addressLine2:w.a.string,city:w.a.string,state:w.a.string}),vin:w.a.string,isMobile:w.a.bool},Kn.defaultProps={drawerClassNames:null,valuation:0,storeInfo:{},vin:"",isMobile:!1};const Xn={OFFER:"offer",NO_OFFER:"no-offer",INELIGIBLE:"ineligible",NO_TMV:"no-tmv"},Jn={[Xn.OFFER]:{header:"We have something special for you!",subheader:"CarMax wants to buy your car and has made you an offer! See how your offer compares to your Edmunds appraisal and decide if it's the right time to sell.",ctaText:"See my car's value"},[Xn.NO_OFFER]:{header:"We have something special for you!",subheader:"CarMax is interested in seeing your car to make an offer! Schedule an appointment to visit your local CarMax and use your Edmunds appraisal to evaluate the CarMax offer.",ctaText:"See my car's value"},[Xn.INELIGIBLE]:{header:"Your appraisal report is ready!",subheader:"We couldn't find a local offer on your vehicle. Use your appraisal to evaluate a dealership's trade-in offer or as a starting point when selling private party.",ctaText:"See my car's value"},[Xn.NO_TMV]:{header:"We couldn't generate an appraisal report for you",subheader:"Your vehicle is either too new, rare or old to generate an appraisal report. Schedule an appointment with CarMax if you're interested in selling your car.",ctaText:"Got it"}};var er=a("./images/inline-svgs/edmunds-logo.jsx");a("./site-modules/shared/components/appraisal/trade-in-appraiser-steps/instant-offer-step/offer-overlay/offer-overlay.scss");function tr(e){let t=e.overlayType,a=e.shouldOpen,s=e.isMobile,n=e.onClosed;const r=Object(x.useState)(!1),o=Object(i.a)(r,2),l=o[0],c=o[1],d=t===Xn.OFFER?"edm-entry-overlay-offer":"edm-entry-overlay-no-offer";function p(e){if(l){const t=e.currentTarget.dataset.trackingValue,a=void 0===t?"":t;ee.a.fireTrackAction({event_type:J.b.EVENT_TYPE_ACTION_COMPLETED,event_data:{action_name:J.b.ACTION_VIEW_CONTENT,subaction_name:J.b.ACTION_VIEW_CONTENT,action_category:J.b.USER_ACTION_CATEGORY,action_cause:J.b.ACTION_CAUSE_BUTTON_CLICK,creative_id:d,value:a}})}c(!l)}Object(x.useEffect)(()=>{a&&c(!0)},[a]);const m=Jn[t],u=m.header,h=m.subheader,g=m.ctaText;return k.a.createElement(gn.a,{className:"instant-offer-overlay mx-auto pt-3 pt-md-3_5",contentClassName:"mt-3_5",onOpened:function(){ee.a.fireTrackAction({event_type:J.b.EVENT_TYPE_WIDGET_VIEW,event_data:{action_name:J.b.ACTION_WIDGET_VIEW,action_cause:J.b.ACTION_CAUSE_BUTTON_CLICK,creative_id:d}})},onClosed:n,isOpen:l,toggle:p,"data-tracking-parent":d},k.a.createElement(bn.a,{className:"text-center px-0 py-3_5 mt-2_5 mb-0_75 mt-md-3_5 mb-md-1_5"},k.a.createElement("figure",{className:"mb-1_5 mx-auto pt-1_5 pos-a rounded-circle"},Object(er.a)()),k.a.createElement("section",{className:"details px-md-0 mx-md-auto px-1_5"},k.a.createElement("header",{className:"header mx-md-auto heading-2 text-black-0_9 mb-1"},u),k.a.createElement("article",{className:"text-gray-darker mb-2_5"},h),k.a.createElement(ct.a,{className:"text-transform-none instant-offer-overlay-button size-16 py-md-1",block:s,color:"success",onClick:p,"data-tracking-value":g},g))))}tr.propTypes={overlayType:w.a.string,shouldOpen:w.a.bool,isMobile:w.a.bool,onClosed:w.a.func},tr.defaultProps={overlayType:Xn.NO_OFFER,shouldOpen:!1,isMobile:!1,onClosed:b.a};var ar=a("./data/models/dealerships.js"),sr=a("./site-modules/shared/utils/dealer-details-utils.js");a("./site-modules/shared/components/appraisal/trade-in-appraiser-steps/instant-offer-step/dealer-locator/dealer-locator.scss");const ir="edm-entry-dealer-locator";class nr extends x.Component{constructor(){super(...arguments),this.getDealerCards=(()=>{const e=this.props,t=e.dealers,a=e.mileOneDealer,s=void 0===a?{}:a,i=T()(t,"results",[]);if(!i.length)return null;if(C()(s))return i.slice(0,3);const r=i.filter(e=>s.rooftopId!==e.rooftopId).slice(0,2);return[Object(n.a)({},s,{isMileOneDealer:!0}),...r.map(e=>T()(e,"parentDealershipName","").includes("MileOne")?Object(n.a)({},e,{isMileOneDealer:!0}):e)]}),this.trackMileOneDealerExists=(e=>{ee.a.fireTrackAction({event_type:J.b.EVENT_TYPE_ACTION_COMPLETED,event_data:{action_name:J.b.ACTION_RECEIVE_EPO,subaction_name:J.b.MILE_ONE_DISPLAYED,action_category:J.b.USER_ACTION_CATEGORY,action_cause:J.b.ACTION_CAUSE_LINK_CLICK,creative_id:ir,value:e}})}),this.trackRooftopId=((e,t)=>()=>{ee.a.fireTrackAction({event_type:J.b.EVENT_TYPE_ACTION_COMPLETED,event_data:{action_name:J.b.ACTION_DEALER_ENGAGEMENT,subaction_name:e,action_category:J.b.USER_ACTION_CATEGORY,action_cause:J.b.ACTION_CAUSE_LINK_CLICK,creative_id:ir,value:t}})}),this.buildDealerCard=(e=>{const t=e.phoneNumbers,a=e.productFeatures,s=e.id,i=e.name,n=e.salesRating,r=e.address,o=e.showroomPage,l=e.isMileOneDealer,c=e.sellYourCarUrl,d=e.rooftopId,p=r.street,m=r.city,u=r.stateCode,h=r.zip,g=Object(sr.a)({phoneNumbers:t,isDirectDealer:a.directDealer}),f=T()(e,"salesReviewCount",0),b=l&&c?c:o;return k.a.createElement(q.a,{xs:12,lg:4,key:s},k.a.createElement("div",{className:"dealer-card text-gray-darker rounded mb-1 mb-md-0"},k.a.createElement("div",{className:"p-1"},k.a.createElement("div",{className:"dealer-name font-weight-bold mb-0_25"},i),k.a.createElement("div",{className:"mb-0_5"},k.a.createElement(ke.a,{rating:n,starClass:"size-12 mr-0_25"}),k.a.createElement("span",{className:"size-12 ml-0_25"},f," Reviews")),k.a.createElement("div",{className:"contact-info"},!C()(r)&&k.a.createElement("div",{className:"address size-14 mb-0_25 mb-md-0 d-flex align-items-baseline"},k.a.createElement("span",{className:"icon-location size-12 text-primary-darker d-block mr-0_5"}),k.a.createElement("div",null,k.a.createElement("span",{className:"d-lg-block mr-0_25 mr-lg-0"},p,","),k.a.createElement("span",{className:"d-lg-block"},m,", ",u," ",h))),g&&k.a.createElement("div",null,k.a.createElement("span",{className:"mr-1_5"},k.a.createElement("span",{className:"icon-phone2 size-12 text-primary-darker"}),k.a.createElement("a",{href:`tel:${Object(Si.a)(g)}`,"data-tracking-id":"call_dealer",onClick:this.trackRooftopId(J.b.CALL_DEALER_ROOFTOP_ID,d),className:"size-14 text-gray-darker"},k.a.createElement("span",{className:"pl-0_5"},Object(Si.c)(g))))))),k.a.createElement("div",{className:"text-center py-0_5 pt-md-0_5 pb-md-1 dealer-card-footer"},k.a.createElement(Ta.a,{to:b,onClick:this.trackRooftopId(J.b.VIEW_DEALER_DETAILS_ROOFTOP_ID,d),target:"_blank",className:"text-primary-darker","data-tracking-id":"click_view_dealer_page"},"Visit Dealer Page"))))})}componentDidUpdate(e){const t=this.props,a=t.dealers,s=t.mileOneDealer;C()(a)||u()(e.dealers,a)||ee.a.fireCustomEvent(J.a),s&&!u()(e.mileOneDealer,s)&&this.trackMileOneDealerExists(!C()(s))}render(){const e=this.getDealerCards();return null===e?null:k.a.createElement("div",{"data-tracking-parent":ir},k.a.createElement("hr",{className:"my-2"}),k.a.createElement("div",{className:"font-weight-bold size-24 text-md-center text-gray-darker mb-1_5"},k.a.createElement("span",{className:"d-block"},"Get the most for your car"),"See if these ",k.a.createElement("span",{className:"text-primary"},"local dealers")," will beat the CarMax offer"),k.a.createElement(F.a,null,e.map(this.buildDealerCard)),k.a.createElement("div",{className:"text-center mt-1_5"},k.a.createElement(Ti.a,{to:"/dealerships/",target:"_blank",className:"text-primary-darker","data-tracking-id":"view_more_dealer_locations"},"View More Locations")))}}nr.propTypes={dealers:w.a.shape({results:w.a.arrayOf(ar.a.Dealer)}),mileOneDealer:ar.a.Dealer},nr.defaultProps={dealers:{},mileOneDealer:void 0};const rr={mileOneDealer:Object($.a)(()=>Object(ar.f)({}),ar.b),dealers:Object($.a)(e=>Object(ar.e)({make:e.makeSlug,directDealer:!0}),ar.b)},or=Object($.b)(nr,rr);var lr=a("./images/kbb-logo/KBB_logo.svg"),cr=a.n(lr),dr=a("./images/kbb-logo/KBB_logo_darkmode.svg"),pr=a.n(dr);function mr(e){let t=e.themeTypeOverride,a=e.className;return k.a.createElement("picture",null,k.a.createElement(Ae.a,{name:"ads-5469-dark-theme",showDefault:!0},k.a.createElement(Ae.c,{name:"ctrl",isDefault:!0}),k.a.createElement(Ae.c,{name:"chal"},"light"!==t&&k.a.createElement("source",{srcSet:pr.a}))),k.a.createElement("img",{className:a,src:cr.a,alt:"Kelly Blue Book"}))}mr.propTypes={themeTypeOverride:w.a.string,className:w.a.string},mr.defaultProps={themeTypeOverride:null,className:""};const ur=Object(z.c)(e=>({themeTypeOverride:T()(e,"visitor.themeTypeOverride")}))(mr);a("./site-modules/shared/components/appraisal/trade-in-appraiser-steps/instant-offer-step/multi-offer-cards/multi-offer-cards.scss");const hr="edm-entry-unlock-offers",gr=[{offerCode:"ODJWID",distanceToNearestStore:1.8},{offerCode:"CNEJVU",distanceToNearestStore:.2}],fr="edmunds_card",br="carmax_card",Er="kbb_card";class yr extends x.Component{constructor(){super(...arguments),this.getWufooUrl=(()=>{const e=this.props,t=e.make,a=e.model,s=e.year,i=e.zipCode;return`https://tier3.wufoo.com/forms/z6dgkto1lz3tv5/def/field43=${e.vin}&field40=${i}&field49=${t}&field50=${a}&field51=${s}`}),this.getKellyBlueBookUrl=(()=>{const e=this.props;return`https://www.kbb.com/${e.make}/${e.model}/${e.year}/styles/?intent=trade-in-sell&vin=${e.vin}&mileage=${e.mileage}`}),this.getCarmaxCard=(()=>{const e=this.props,t=e.offerPrice,a=e.distanceToNearestStore;return{offerPrice:t,offerCode:e.offerCode,distanceToNearestStore:a,offerExpDate:e.offerExpDate,url:e.redemptionCertificateUri,dataTrackingId:"partner_schedule_dropoff",dataTrackingValue:br,name:"CarMax",logoElement:k.a.createElement(Qs.a,{className:"carmax-logo mt-1 mb-2"})}}),this.getKellyBlueBookCard=(()=>({url:this.getKellyBlueBookUrl(),dataTrackingId:"partner_schedule_dropoff",dataTrackingValue:Er,name:"Kelly Blue Book",logoElement:k.a.createElement(ur,{className:"kbb-logo mb-1"})})),this.getEdmundsCard=(()=>({handler:this.props.unblockEdmundsApprasal,dataTrackingId:"unlock_appraisal",dataTrackingValue:fr,name:"Edmunds",logoElement:k.a.createElement(Ks.a,{className:"edmunds-logo mt-1 mb-2"})})),this.getOfferCard=((e,t)=>{const a=this.props.offerExpDate;return Object(n.a)({},gr[e],{offerExpDate:a,url:this.getWufooUrl(),dataTrackingId:"unlock_offers",dataTrackingValue:t})}),this.getSecondOfferCard=(()=>this.getOfferCard(0,"second_card")),this.getThirdOfferCard=(()=>this.getOfferCard(1,"third_card")),this.buildOfferCardEval3573Chal1=((e,t)=>{const a=this.props,s=a.isMobile,i=a.eval3573Recipe,n=e.offerPrice,r=e.distanceToNearestStore,o=e.offerCode,l=e.offerExpDate,c=e.url,d=e.dataTrackingId,p=e.dataTrackingValue;return k.a.createElement(q.a,{xs:12,lg:4,key:`${o}-${t}`},k.a.createElement(Ta.a,{className:"offer-card-link",target:"_blank",to:c,"data-tracking-id":d,"data-tracking-value":p},k.a.createElement("div",{className:Me()("offer-card text-center text-gray-darker rounded mb-1 mb-md-0 mx-0 py-0_75 py-md-1",{"bg-gray-extra-light":"chal1"===i})},n?k.a.createElement("div",{className:"offer-price size-30 font-weight-bold text-primary mt-0_25 mt-md-0_5 mb-0_5"},Object(We.a)(n),"*"):k.a.createElement(hs.a,{imageId:"chal1"===i?"img/eva/unlock-offer-blur.svg":"img/eva/unlock-offer-sticker.svg",source:Ze.d.STATIC,alt:"Offer Reveal",className:"price-reveal"}),r&&k.a.createElement("div",{className:"mt-0_25 mb-0_25 my-md-0_5 size-12 text-gray"},r," miles away"),k.a.createElement("div",{className:Me()("font-weight-bold size-14 mb-0_5 mb-md-0",{"mt-2":n&&!r})},n?k.a.createElement(x.Fragment,null,k.a.createElement("span",{className:"d-md-block"},"Your offer from "),k.a.createElement(Qs.a,{className:"carmax-logo"})):k.a.createElement(x.Fragment,null,k.a.createElement("span",{className:"d-md-block"},"Your ",1===t?"2nd":"3rd"," offer from a "),"trusted partner")),k.a.createElement("div",{className:Me()("offer-code size-12 mt-0_75",{"d-inline":s})},"Offer Code: ",o),k.a.createElement("span",{className:"size-12 mx-0_5 hidden-md-up"},"|"),k.a.createElement("div",{className:Me()("offer-exp-date size-12",{"d-inline":s})},"Valid until ",He()(l,"UTC:mm/dd/yyyy")))))}),this.buildOfferCardContent=(e=>{const t=e.offerPrice,a=e.url,s=e.handler,i=e.dataTrackingId,n=e.dataTrackingValue,r=e.name,o=e.logoElement;return k.a.createElement("div",{className:"offer-card text-center rounded mb-1 mb-md-0 mx-0 pt-0_75 pt-md-1 pb-1_5 bg-gray-extra-light"},k.a.createElement("div",{className:"text-gray-darker size-14 mb-0_5"},k.a.createElement("span",{className:"d-md-block mb-0_25"},"Your appraisal from ",k.a.createElement("strong",null,r)),k.a.createElement("hr",{className:"mt-0_5"})),k.a.createElement("div",{className:"logo-eval3573chal2"},o),t?k.a.createElement("div",{className:"offer-price-eval3573chal2 text-primary"},Object(We.a)(t),"*"):k.a.createElement(hs.a,{imageId:"img/eva/unlock-offer-blur.svg",source:Ze.d.STATIC,alt:"Offer Reveal",className:"price-reveal"}),k.a.createElement("div",{className:"text-center mt-1_5"},a&&k.a.createElement(ct.a,{color:"success",target:"_blank",block:!1,className:"offer-card-btn text-transform-none py-0_5 px-1 size-16",href:a,"data-tracking-id":i,"data-tracking-value":n},"Unlock appraisal"),!a&&s&&k.a.createElement(ct.a,{color:"success",target:"_blank",block:!1,className:"offer-card-btn text-transform-none py-0_5 px-1 size-16",onClick:s,"data-tracking-id":i,"data-tracking-value":n},"Unlock appraisal")))}),this.buildOfferCard=((e,t)=>{const a=e.url,s=e.handler,i=e.dataTrackingId,n=e.dataTrackingValue;return k.a.createElement(q.a,{xs:12,lg:4,key:`${n}-${t}`},a&&k.a.createElement(Ta.a,{className:"offer-card-link",target:"_blank",to:a,"data-tracking-id":i,"data-tracking-value":n},this.buildOfferCardContent(e)),!a&&s&&k.a.createElement("div",{className:"offer-card-link",onClick:s,role:"button","data-tracking-id":i,"data-tracking-value":n,tabIndex:t},this.buildOfferCardContent(e)))})}componentDidMount(){ee.a.fireCustomEvent(J.a)}render(){const e=this.props,t=e.make,a=e.year,s=e.isMobile,i=e.eval3573Recipe,n="chal1"===i,r="chal2"===i;let o;return o=n?[this.getCarmaxCard(),this.getSecondOfferCard(),this.getThirdOfferCard()]:[this.getCarmaxCard(),r?this.getKellyBlueBookCard():this.getEdmundsCard(),r?this.getEdmundsCard():this.getKellyBlueBookCard()],k.a.createElement("div",{"data-tracking-parent":hr},k.a.createElement("hr",{className:"my-2"}),k.a.createElement("div",{className:"font-weight-bold size-24 text-center text-gray-darker mb-1_5"},k.a.createElement("span",{className:"d-block"},"Unlock ",k.a.createElement("span",{className:"text-primary"},"2 more ",n?"real offers":"appraisals")," ","to compare to CarMax"),"for your ",a," ",t),k.a.createElement(F.a,null,o.map(n?this.buildOfferCardEval3573Chal1:this.buildOfferCard)),n&&k.a.createElement("div",{className:"text-center mt-0_5 mt-md-1_5"},k.a.createElement(ct.a,{color:"success",target:"_blank",block:s,className:"text-uppercase py-0_5 py-md-0_75 px-1 size-16",href:this.getWufooUrl(),"data-tracking-id":"unlock_offers","data-tracking-value":"Unlock Your Offers"},"Unlock your offers")))}}yr.propTypes={offerPrice:w.a.number,distanceToNearestStore:w.a.number,offerCode:w.a.string,offerExpDate:w.a.string,make:w.a.string,model:w.a.string,year:w.a.number,zipCode:w.a.string,vin:w.a.string,mileage:w.a.string,redemptionCertificateUri:w.a.string,isMobile:w.a.bool,eval3573Recipe:w.a.string,unblockEdmundsApprasal:w.a.func},yr.defaultProps={offerPrice:null,distanceToNearestStore:null,offerCode:"",offerExpDate:"",make:"",model:"",year:null,zipCode:"",vin:"",mileage:"",redemptionCertificateUri:"",isMobile:!1,eval3573Recipe:"chal1",unblockEdmundsApprasal:b.a};var vr=a("./site-modules/shared/components/animated-sticky/animated-sticky.jsx"),Cr=a("./site-modules/shared/components/form-field-mask/form-field-mask.jsx");a("./site-modules/shared/components/appraisal/trade-in-appraiser-steps/instant-offer-step/instant-offer-send-to-phone/instant-offer-send-to-phone.scss");const Sr={phoneNumber:{test:Je.a.validatePhoneNumber,errorText:"Please enter a valid phone number."}},Tr={pattern:"999.999.9999",toValue:!0},Ir={SEND:"Send",SENDING:"Sending"},_r={IS_ERROR:"is-error",IS_SENT:"is-sent",DEFAULT:"default"},Nr={[_r.DEFAULT]:{header:"Send your CarMax offer to your phone!",subHeader:"We'll text you a link to your offer so you can access it anytime."},[_r.IS_ERROR]:{header:"Something went wrong",subHeader:"We're sorry, we couldn\u2019t text you your offer at this time. Please try again."},[_r.IS_SENT]:{header:"Sent!",subHeader:"Check your phone for your CarMax offer. Hurry, it expires in 7 days!"}};class Or extends x.Component{constructor(){super(...arguments),this.state={sentTypeKey:_r.DEFAULT,isSending:!1},this.handleSubmit=(e=>{e.preventDefault();const t=(0,this.props.validate)();this.firePhoneValidationTracking(t),t&&this.setState({isSending:!0,sentTypeKey:_r.DEFAULT},this.handleSendSms)}),this.handleBlur=(()=>{(0,this.props.validate)()}),this.handleSendSms=(async()=>{const e=this.props,t=e.redemptionCertificateUri,a=e.fields.phoneNumber,s=e.location;try{await Object(se.k)(Object(Si.a)(a.value()),`${t}&print=false`,s),this.setState({isSending:!1,sentTypeKey:_r.IS_SENT})}catch(e){this.setState({isSending:!1,sentTypeKey:_r.IS_ERROR})}}),this.firePhoneValidationTracking=(e=>{ee.a.fireTrackAction({event_type:J.b.EVENT_TYPE_ACTION_COMPLETED,event_data:{action_name:J.b.ACTION_RECEIVE_EPO,action_category:J.b.USER_ACTION_CATEGORY,subaction_name:e?J.b.PHONE_INPUT_SUCCESS:J.b.PHONE_INPUT_FAIL,creative_id:G.W}})}),this.phoneNumberRef=(e=>this.props.fieldRef("phoneNumber",e))}render(){const e=this.props,t=e.toggleModal,a=e.validationErrors,s=e.isSecondary,i=this.state,n=i.isSending,r=i.sentTypeKey,o=i.errorMessage,l=a.phoneNumber||o;return k.a.createElement("div",{className:"instant-offer-send-to-phone text-gray-darker p-0_5","data-tracking-parent":G.W},k.a.createElement("div",{className:"pos-r heading-5 mb-0_75 pr-1_75"},k.a.createElement("span",null,Nr[r].header),k.a.createElement(ct.a,{color:"link",size:"lg",className:"close-btn p-0_25 text-decoration-none text-gray","aria-label":"Close",onClick:t},k.a.createElement("i",{className:"icon-cross2 size-16"}))),k.a.createElement("p",{className:"size-14 mb-1_25"},Nr[r].subHeader),r!==_r.IS_ERROR&&k.a.createElement(x.Fragment,null,r===_r.IS_SENT?k.a.createElement("div",{className:"d-flex justify-content-center text-offer-message"},k.a.createElement(hs.a,{imageId:"img/eva/your-offer.svg",source:Ze.d.STATIC,alt:"See your offer",className:"see-your-offer-image"})):k.a.createElement(x.Fragment,null,k.a.createElement(ut.a,{noValidate:!0,onSubmit:this.handleSubmit},k.a.createElement("div",{className:"phone-field-wrapper"},k.a.createElement(Cr.a,{id:"phoneNumber",name:"phoneNumber",type:"tel",placeholder:Tr.pattern,label:"Phone",isValid:!l,mask:Tr,ref:this.phoneNumberRef,className:"phone-form-group",inputClassName:"phone-number-input pr-1",onBlur:this.handleBlur}),k.a.createElement(ct.a,{type:"submit",color:"success",className:"send-btn text-transform-none px-0","data-tracking-id":"partner_send_to_phone","data-tracking-value":s?`${Ir.SEND}2`:Ir.SEND,disabled:n},k.a.createElement("div",{className:"d-flex justify-content-center align-items-center"},k.a.createElement("span",{className:Me()({"pr-0_25":n})},n?Ir.SENDING:Ir.SEND),n&&k.a.createElement(gt.a,{size:14,thickness:1,color:"white"})))),l&&k.a.createElement("p",{className:"small text-danger"},l)),k.a.createElement("div",{className:"size-10"},"Your phone number will only be used to send you this message, nothing else."))))}}Or.propTypes={toggleModal:w.a.func.isRequired,redemptionCertificateUri:w.a.string.isRequired,fieldRef:w.a.func.isRequired,validate:w.a.func.isRequired,validationErrors:w.a.objectOf(w.a.string),fields:w.a.shape({phoneNumber:w.a.shape({value:w.a.func})}),isSecondary:w.a.bool,location:w.a.shape({})},Or.defaultProps={validationErrors:{},fields:{phoneNumber:{value:b.a}},isSecondary:!1,location:{}};const Pr=Object(z.c)(e=>({location:T()(e,"pageContext.location")}))(Object(la.a)(Or,Sr));a("./site-modules/shared/components/appraisal/trade-in-appraiser-steps/instant-offer-step/instant-offer-step.scss");function Ar(e){return{partnerOfferData:{},conditionQuestionResponses:{},conditionPricing:{},submitPartnerError:!1,isSubmittingAppraisal:!1,isAppraisalSubmitComplete:!1,isSubmittingFinished:!1,isScheduleAppointmentModalOpen:!1,store:e.partnerOfferEligibilityResponse.store,noAppraisalReport:!1,disableSticky:!1,isSendToPhoneModalOpen:!1,isHideOffer:["chal2","chal3"].includes(e.eval3573Recipe)}}const xr=/storeid=\d+&/g,kr="appraiser-report-step-extended-divider";class Vr extends x.Component{constructor(){var e;e=super(...arguments),this.state=Ar(this.props),this.onStickyStateChange=(e=>{this.stickyState=e,this.state.isSendToPhoneModalOpen||(this.setState({disableSticky:this.checkDisableStickyState()}),this.stickyState.position===vr.b.UNDER&&this.stickyState.status===vr.c.STICKY&&ee.a.fireTrackAction({event_type:J.b.ACTION_WIDGET_VIEW,event_data:{action_name:J.b.ACTION_WIDGET_VIEW,action_cause:J.b.ACTION_CAUSE_SCROLL,creative_id:"edm-entry-docked-offer-bar"}}))}),this.getPartnerAppraisalMetadataPayload=(()=>{const e=this.props,t=e.clientIp,a=e.getVehicleData,s=e.eval2657Recipe,i=a().styleId,n=[`EVAL-2657:${s}`];return{metadata:{remote_host_request_id:"EVAL-1950",remote_host_client_id:t?this.hashPartnerAppraisalData(t):"",ab_test:n.join(","),edmunds_style_id:String(i),sem_campaign:`${ei.a.isSemCampaignAppraisals}`}}}),this.getOfferOverlayType=((e,t,a)=>a?Xn.NO_TMV:t?Xn.INELIGIBLE:e?Xn.OFFER:Xn.NO_OFFER),this.setLoadingStatus=(()=>{this.setState({isAppraisalSubmitComplete:!0})}),this.checkDisableStickyState=(()=>this.stickyState.position!==vr.b.UNDER),this.stickyState={},this.openSendToPhoneModal=(()=>this.setState(()=>({isSendToPhoneModalOpen:!0,disableSticky:!0}))),this.closeSendToPhoneModal=(()=>{this.setState(()=>({isSendToPhoneModalOpen:!1,disableSticky:this.checkDisableStickyState()}))}),this.updateStore=(e=>{if(!e)return;const t=this.state.partnerOfferData,a=t.appointmentUri,s=t.redemptionCertificateUri.replace(xr,`storeid=${e.id}&`),i=a.replace(xr,`storeid=${e.id}&`);this.setState({store:e,partnerOfferData:Object(n.a)({},t,{appointmentUri:i,redemptionCertificateUri:s})},()=>{this.props.updateStepsState("partnerOfferEmailData",Object(n.a)({},this.state.partnerOfferData))})}),this.toggleScheduleAppointDrawerFromOnClick=(e=>{e.preventDefault(),this.toggleScheduleAppointmentDrawer()}),this.toggleScheduleAppointmentDrawer=(()=>this.setState(e=>({isScheduleAppointmentModalOpen:!e.isScheduleAppointmentModalOpen}))),this.initialize=(()=>{this.setState(Ar(this.props)),ee.a.fireTrackAction(Object(G.z)(G.y)),C()(this.props.tmvConditions)?(this.triggerError(),this.fireNoOfferWidgetViewTracking(),this.fireNoOfferVinTracking()):this.submitPartnerAppraisal()}),this.fireWidgetViewTracking=(()=>{const e=this.state.partnerOfferData;if(C()(e))this.fireNoOfferWidgetViewTracking();else{const t=e.offerValuation;t?this.fireOfferWidgetViewTracking(t):this.fireNoOfferWidgetViewTracking()}}),this.fireNoOfferWidgetViewTracking=(()=>this.state.noAppraisalReport?ee.a.fireTrackAction(G.V):ee.a.fireTrackAction(this.isNoOfferNoAppointment()?G.Q:G.S)),this.fireNoOfferVinTracking=(()=>ee.a.fireTrackAction(Object(G.T)(this.props.vin))),this.fireOfferWidgetViewTracking=(e=>{ee.a.fireTrackAction(ui()({},G.P,{vin:this.props.vin,event_data:{value:e}})),this.props.fireFbSignal&&ee.a.fireTrackAction(G.w)}),this.scrollToPartnerOffer=(()=>{this.props.scrollToElement(`.${G.ib}.${G.x}`)}),this.scrollToEdmundsAppraisal=(()=>{this.props.scrollToElement(`#${kr}`)}),this.submitPartnerAppraisal=(()=>{const e=this.props,t=e.getPartnerAppraisalPayload,a=e.fireMinMaxRangeTracking,s=e.mechanicalStyle,i=e.saveInstantOfferDataToIdm,r=e.tmvConditions,o=e.chromeStyleSku,l=e.isEval3446Chal1Enabled,c=e.vehicleFeatures,d=e.partnerOfferQuoteId,p=e.updatePartnerOfferQuoteId,m=e.options,u=e.partnerOfferEligibilityResponse.isEligible,h=e.isPartnerOfferEligibleVin;this.setState({isSubmittingAppraisal:!0,isSubmittingFinished:!1},async()=>{const e=String(T()(s,"attributeGroups.PARTNER_MAPPING.properties.CHROME_ID",null)),g="null"!==e?e.split(",").length:0,f=Te(r),b=s.engineCylinder,E=void 0===b?"":b,y=s.engineSize,v=void 0===y?"":y,S=s.engineType,I=void 0===S?"":S,_=s.engineCompressorType,N=void 0===_?"":_,O=s.transmissionType,P=void 0===O?"":O,A=Object(n.a)({},t(),{conditionPricing:f,bodyStyleCategory:T()(s,"attributeGroups.STYLE_INFO.properties.VEHICLE_STYLE",""),numberOfDoors:T()(s,"attributeGroups.DOORS.properties.NUMBER_OF_DOORS",""),cylinders:String(E),engineSize:String(v),engineType:I,engineCompressorType:N,transmissionType:P,chromeStyleId:e,driveTrain:T()(s,"attributeGroups.DRIVE_TYPE.properties.DRIVEN_WHEELS",""),chromeStyleSku:o,isEval3446Chal1Enabled:l},this.getPartnerAppraisalMetadataPayload()),x=Object(n.a)({},t(!0),{isEval3446Chal1Enabled:l,chromeStyleSku:o,isEligibleYmmz:u,lastQuoteId:d,updatePartnerOfferQuoteId:p,isPartnerOfferEligibleVin:h,visitorId:null,ciamId:null,drive:c&&c.driveTrain},this.getPartnerAppraisalMetadataPayload());if(l&&o){const e=await Object(se.m)({chromeStyleSku:o,selectedOptions:m}),t=e.availableOptionCodes,a=e.standardOptionCodes;x.standardOptions=a,x.availableOptions=t}const k=await Object(se.l)(l?x:A);let V=!1;if(C()(k))this.triggerError(),this.fireNoOfferVinTracking();else{const e=k.valuation,t=k.expiresDateUtc,s=k.conditionQuestionResponses,n=k.appointmentUri,r=k.code,o=k.redemptionCertificateUri,l=k.vin,c=k.expiresDisplayDate,d=this.state.store||{},p={offerValuation:e,offerVin:l,offerCode:r,offerExpiredDate:c,offerStoreName:d.name,offerStoreAddressLine1:d.addressLine1,offerStoreAddressLine2:d.addressLine2,offerExpiredTs:t,appointmentUri:n,redemptionCertificateUri:o};this.setState({conditionQuestionResponses:s,conditionPricing:f,partnerOfferData:p,submitPartnerError:!1,isSubmittingAppraisal:!1,isSubmittingFinished:!0}),this.updatePartnerOfferEmailDataState(p),a(f),e?V=!0:this.fireNoOfferVinTracking(),i(this.generateIdmInstantOfferData(k))}ee.a.fireTrackAction(Object(G.M)(g,V))})}),this.triggerError=(()=>this.setState({submitPartnerError:!0,isSubmittingAppraisal:!1,isSubmittingFinished:!0})),this.updatePartnerOfferEmailDataState=(e=>{const t=this.props.updateStepsState,a=e.offerValuation,s=e.redemptionCertificateUri,i=e.appointmentUri;t("partnerOfferEmailData",Object(n.a)({},e,{redemptionCertificateUri:a?s:"",appointmentUri:a?i:""}))}),this.hashPartnerAppraisalData=(e=>yn()("sha256",K.a.get("appraiser").partnerAppraisalKey).update(e).digest("base64")),this.generateIdmInstantOfferData=(e=>{const t=e.sourceId,a=e.vin,s=e.code,i=e.valuation,n=e.createdDateUtc,r=e.expiresDateUtc,o=e.appointmentUri,l=e.redemptionCertificateUri,c=this.state.store||{},d=c.name,p=c.addressLine1,m=c.addressLine2;return{sourceId:t,vin:a,createdTs:new Date(n).toISOString(),expireTs:new Date(r).toISOString(),offerPrice:i,offerCode:s,appointmentUrl:o,redemptionCertificateUrl:l,storeName:d,storeAddressLine1:p,storeAddressLine2:m}}),this.resetState=(()=>{this.setState({isSubmittingAppraisal:!1,isAppraisalSubmitComplete:!1,isSubmittingFinished:!1})}),this.isNoOfferNoAppointment=(()=>{const e=this.props,t=e.isPartnerOfferEligibleVin,a=e.partnerOfferEligibilityResponse,s=a.isEligible,i=a.reason,n=e.isEval3446Chal1Enabled,r=e.chromeStyleSku;return!t||!s||i===G.vb||n&&!r}),this.unblockEdmundsApprasalEval3573Chal2=(()=>{this.setState({isHideOffer:!1},this.scrollToEdmundsAppraisal)}),this.renderNoOfferMessage=(e=>{const t=this.props,a=t.isMobile,s=t.eval2657Recipe,i=t.getVehicleData;if(e)return null;if(this.isNoOfferNoAppointment()){const e=i(),t=e.makeName,a=e.modelName,s=e.year;return k.a.createElement("div",{className:"no-offer-message"},k.a.createElement("div",{className:"heading-3 mb-1"},"We were unable to find a local offer for your ",s," ",t," ",a),k.a.createElement("div",null,"Use your estimated appraisal as a reference point to see if a dealership's trade-in offer is in the ballpark, or as a starting point when selling private party."))}const n=this.state,r=n.conditionPricing,o=n.partnerOfferData.appointmentUri,l=n.store;return k.a.createElement("div",{"data-tracking-parent":G.R,className:"offer-retarget-card text-gray-darker text-center pt-2_5 pb-1_5 px-2 mb-2"},k.a.createElement("span",{className:"icon-edmunds-car text-primary size-30"}),k.a.createElement("h2",{className:"size-24"},"We weren't able to make an online offer"),k.a.createElement("p",{className:"size-16 mb-2"},"Online offers are based on recent appraisals of cars like yours and we haven't seen many like yours lately. Schedule an appointment to complete your appraisal at your local CarMax."),k.a.createElement(Vi,{conditionPricing:r,isMobile:a,store:l,eval2657Recipe:s,appointmentUri:o,renderNoOffer:!0,toggleScheduleAppointmentDrawer:this.toggleScheduleAppointDrawerFromOnClick}))}),this.renderNoAppraisalReportMessage=(e=>{this.setState({noAppraisalReport:e})}),this.renderDockerBarContainer=((e,t)=>k.a.createElement(vr.a,{className:"docked-bar",stickyClassName:"px-0",stickyWrapperClassName:Me()("w-100 bg-white bottom",{hidden:this.state.disableSticky}),onStateChange:this.onStickyStateChange},k.a.createElement("div",{className:"docked-bar-container d-flex justify-content-between align-items-center px-1_5","data-tracking-parent":"edm-entry-docked-offer-bar"},k.a.createElement("div",null,k.a.createElement(Qs.a,null),k.a.createElement("div",{className:"text-gray-darker"},k.a.createElement("span",{className:"size-24 font-weight-bold mr-0_25"},Object(We.a)(t),"*"),k.a.createElement("span",{className:"size-14"},"Offer"))),k.a.createElement("div",null,e)))),this.renderOffer=function(t){let a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const s=e.props,i=s.getVehicleData,n=s.isPartnerOfferEligibleVin,r=s.vin,o=s.partnerOfferEligibilityResponse.nearestStores,l=s.isMobile,c=s.handleEmailReportClick,d=s.emailReportStatus,p=s.resetEmailReportStatus,m=s.condition,u=s.eval2657Recipe,h=e.state,g=h.submitPartnerError,f=h.partnerOfferData,E=f.offerValuation,y=f.offerCode,v=f.appointmentUri,S=f.redemptionCertificateUri,T=f.offerExpiredTs,I=h.conditionPricing,_=h.isSubmittingFinished,N=h.noAppraisalReport,O=h.store,P=h.isSendToPhoneModalOpen,A=!(n&&!g&&!!E&&!C()(I)),x=N?null:e.renderNoOfferMessage(a),V=A?x:k.a.createElement(Vt.a,null,a&&k.a.createElement("hr",{className:"my-2"}),k.a.createElement(Mn,{getVehicleData:i,conditionPricing:I,valuation:E,code:y,redemptionCertificateUri:S,expiresDateUtc:T,vin:r,emailReportStatus:d,resetEmailReportStatus:p,isSecondary:a,isMobile:l,condition:m.toLowerCase(),appointmentUri:v}),l&&!a&&k.a.createElement(Ae.a,{name:"EVAL-3528",showDefault:!0},k.a.createElement(Ae.c,{name:"ctrl",isDefault:!0}),k.a.createElement(Ae.c,{name:"chal0"}),k.a.createElement(Ae.c,{name:"chal1"},e.renderDockerBarContainer(k.a.createElement(ct.a,{color:"success",className:"py-0_5 view-offer-btn","data-tracking-id":"view_offer",onClick:e.scrollToPartnerOffer},k.a.createElement("span",{className:"size-16 text-capitalize text-white"},"View Offer")),E)),k.a.createElement(Ae.c,{name:"chal2"},e.renderDockerBarContainer(k.a.createElement(ct.a,{color:"success",className:"py-0_5 view-offer-btn","data-tracking-id":"partner_send_to_phone",onClick:e.openSendToPhoneModal},k.a.createElement("span",{className:"size-16 text-capitalize text-white"},"Text Offer")),E))),k.a.createElement(ki,{appointmentUri:v,redemptionCertificateUri:S,nearestStores:o,store:O,isMobile:l,handleEmailReportClick:c,emailReportStatus:d,isSecondary:a,handleOpenSendToPhoneModal:e.openSendToPhoneModal,updateStore:e.updateStore,toggleScheduleAppointmentDrawer:"chal"!==u||C()(O)?void 0:e.toggleScheduleAppointDrawerFromOnClick}),!a&&k.a.createElement(gn.a,{className:"instant-offer-send-to-phone-modal",isOpen:P,toggle:e.closeSendToPhoneModal},k.a.createElement(bn.a,null,k.a.createElement(Pr,{toggleModal:e.closeSendToPhoneModal,redemptionCertificateUri:S,isSecondary:a}))));return k.a.createElement("div",{className:Me()({"pb-2":a&&A})},t?k.a.createElement(Sn,{className:"pb-1",setLoadingStatus:b.a,isSubmittingFinished:_,isMobile:l}):V)},this.renderDealerLocator=(()=>{const e=this.props,t=e.vin,a=e.mileage,s=e.eval3573Recipe,i=e.getVehicleData,n=e.isMobile,r=e.partnerOfferEligibilityResponse.nearestStores,o=e.vehicle,l=e.zipCode,c=this.state.partnerOfferData,d=c.offerValuation,p=c.offerCode,m=c.redemptionCertificateUri,u=c.offerExpiredTs,h=i(),g=h.makeName,f=h.modelName,b=h.year,E=T()(o,"make.slug");return"ctrl"===s?k.a.createElement(or,{makeSlug:E}):k.a.createElement(yr,{offerPrice:d,distanceToNearestStore:T()(r,"[0].distance"),offerCode:p,offerExpDate:u,make:g,model:f,year:b,zipCode:l,vin:t,mileage:a,redemptionCertificateUri:m,isMobile:n,eval3573Recipe:s,unblockEdmundsApprasal:this.unblockEdmundsApprasalEval3573Chal2})})}static getDerivedStateFromProps(e,t){return{isAppraisalSubmitComplete:e.isStepActive&&t.isSubmittingFinished&&t.isAppraisalSubmitComplete||!1===e.isStepActive}}componentDidMount(){this.props.isStepActive&&this.initialize()}componentDidUpdate(e,t){const a=this.props,s=a.isStepActive,i=a.isPartnerOfferEligibleVin,n=a.addOfferTagToRecorder,r=a.setAppraiseFinished,o=a.isStepFinal,l=this.state,c=l.submitPartnerError,d=l.partnerOfferData.offerValuation,p=l.isAppraisalSubmitComplete,m=s!==e.isStepActive,u=!s&&m;s&&m?this.initialize():u&&this.resetState();const h=i&&!c&&!!d;t.partnerOfferData.offerValuation!==d&&h&&n(),o&&s&&r(p),s&&p&&!t.isAppraisalSubmitComplete&&this.fireWidgetViewTracking()}render(){const e=this.props,t=e.isPartnerOfferEligibleVin,a=e.hideDelightedSurvey,i=e.handleDelightedSurveyClick,n=e.appraisalReportProps,r=e.isStepActive,o=e.vin,l=e.eval2657Recipe,c=e.getVehicleData,d=e.isMobile,p=e.partnerOfferEligibilityResponse,m=p.isEligible,u=p.reason,h=e.isEval3446Chal1Enabled,g=e.chromeStyleSku,f=this.state,b=f.submitPartnerError,E=f.partnerOfferData.offerValuation,y=f.isSubmittingFinished,v=f.isAppraisalSubmitComplete,S=f.conditionPricing,T=f.isScheduleAppointmentModalOpen,I=f.store,_=f.noAppraisalReport,N=f.isHideOffer,O=t&&!b&&!!E&&!C()(S),P=!O,A=r&&!v,V=!m||u===G.vb||!t||h&&!g,w=P&&!A&&V,j=this.getOfferOverlayType(O,V,_);return k.a.createElement(F.a,null,k.a.createElement(q.a,{xs:12,className:"instant-offer-step"},this.renderOffer(A),k.a.createElement("div",{className:Me()({"d-none":A})},!_&&!P&&k.a.createElement("div",{className:Me()({"mb-2_5":N})},this.renderDealerLocator()),!N&&!C()(n)&&k.a.createElement(Vt.a,null,!_&&k.a.createElement("hr",{className:"my-2",id:kr}),k.a.createElement(zi,Object(s.a)({},n,{showReportExtendedPriceOnly:!0,renderNoAppraisalReportMessage:this.renderNoAppraisalReportMessage,toggleScheduleAppointmentDrawer:this.toggleScheduleAppointDrawerFromOnClick}))),!N&&this.renderOffer(A,!0),!P&&!a&&k.a.createElement(x.Fragment,null,k.a.createElement("hr",null),k.a.createElement(di,{onClick:i,isEpo:!0})))),!_&&w&&k.a.createElement(q.a,{xs:12,className:"px-0"},k.a.createElement(F.a,null,k.a.createElement(q.a,{xs:12,className:"px-0"},k.a.createElement("hr",null),k.a.createElement(Li,{getVehicleData:c})))),"chal"===l&&!C()(I)&&k.a.createElement(Kn,{getVehicleData:c,onToggle:this.toggleScheduleAppointmentDrawer,isOpen:T,storeInfo:I,valuation:E,vin:o,isMobile:d}),k.a.createElement(tr,{overlayType:j,shouldOpen:r&&y,isMobile:d,onClosed:this.setLoadingStatus}))}}Vr.propTypes={getPartnerAppraisalPayload:w.a.func.isRequired,getVehicleData:w.a.func.isRequired,condition:w.a.string,options:w.a.arrayOf(w.a.shape({})),color:w.a.shape({name:w.a.string}),isMobile:w.a.bool,isStepActive:w.a.bool,isPartnerOfferEligibleVin:w.a.bool,vin:w.a.string,zipCode:w.a.string,mileage:w.a.string,partnerOfferEligibilityResponse:se.a.Eligibility,hideDelightedSurvey:w.a.bool,handleDelightedSurveyClick:w.a.func,appraisalReportProps:w.a.shape({}),fireMinMaxRangeTracking:w.a.func,updateStepsState:w.a.func,addOfferTagToRecorder:w.a.func,mechanicalStyle:te.b.MechanicalStyleEntity,handleEmailReportClick:w.a.func.isRequired,saveInstantOfferDataToIdm:w.a.func.isRequired,emailReportStatus:w.a.string,resetEmailReportStatus:w.a.func,clientIp:w.a.string,tmvConditions:w.a.shape({}),eval2657Recipe:w.a.string,eval3573Recipe:w.a.string,fireFbSignal:w.a.bool,vehicle:w.a.shape({}),chromeStyleSku:w.a.string,isEval3446Chal1Enabled:w.a.bool,setAppraiseFinished:w.a.func,isStepFinal:w.a.bool,scrollToElement:w.a.func,vehicleFeatures:te.b.VehicleFeatures,partnerOfferQuoteId:w.a.string,updatePartnerOfferQuoteId:w.a.func},Vr.defaultProps={isStepActive:!1,condition:"",color:{},isMobile:!1,isPartnerOfferEligibleVin:!1,partnerOfferMileage:null,mileage:null,vin:null,zipCode:null,options:[],partnerOfferEligibilityResponse:{store:{},isEligible:{},reason:null,nearestStores:[]},hideDelightedSurvey:!1,handleDelightedSurveyClick:null,appraisalReportProps:{},fireMinMaxRangeTracking:b.a,updateStepsState:b.a,addOfferTagToRecorder:b.a,mechanicalStyle:{},emailReportStatus:"",resetEmailReportStatus:b.a,clientIp:"",tmvConditions:null,eval2657Recipe:"ctrl",eval3573Recipe:"ctrl",fireFbSignal:!1,vehicle:{},chromeStyleSku:"",isEval3446Chal1Enabled:!1,setAppraiseFinished:b.a,isStepFinal:!1,scrollToElement:b.a,vehicleFeatures:void 0,partnerOfferQuoteId:null,updatePartnerOfferQuoteId:b.a};const wr={vehicleFeatures:Object($.a)(e=>{let t=e.vehicle;const a=T()(t,"style.id");return a?Object(te.w)(a):""},te.c)},jr=Object(z.c)((e,t)=>{const a=t.getVehicleData().styleId;return{clientIp:T()(e,"visitor.clientIp"),tmvConditions:T()(e.vehicle,Object(te.D)(a)),partnerOfferQuoteId:Object(se.i)(e)}})(Object($.b)(Vr,wr));class Rr extends x.Component{componentDidUpdate(e){const t=this.props,a=t.isStepFinal,s=t.isStepActive,i=t.setAppraiseFinished,n=s!==e.isStepActive;a&&(s&&n)&&i(!0)}render(){const e=this.props,t=e.isMobile,a=e.appraisalReportProps,i=e.stepId,n=e.trackingCreativeId;return k.a.createElement(zi,Object(s.a)({},a,{isMobile:t,stepId:i,trackingCreativeId:n}))}}Rr.propTypes={stepId:w.a.string,trackingCreativeId:w.a.string,appraisalReportProps:w.a.shape({isEscapeHatch:w.a.bool,licensePlateAndVinProps:w.a.shape({})}),isStepActive:w.a.bool,isMobile:w.a.bool,setAppraiseFinished:w.a.func,isStepFinal:w.a.bool},Rr.defaultProps={stepId:"",trackingCreativeId:"",appraisalReportProps:{},isStepActive:!1,isMobile:!1,setAppraiseFinished:b.a,isStepFinal:!1};var Mr=a("./site-modules/shared/components/feature-flag/feature-flag.jsx");function Dr(e){let t=e.stepId,a=e.locationAndStyleProps,i=e.optionsAndColorsProps,n=e.conditionAndMileageProps,r=e.appraisalReportProps,o=e.licensePlateAndVinProps,l=e.offerConditionsProps,c=e.instantOfferProps,d=e.escapeHatchProps,p=e.isMobile,m=e.isExtendedReport;switch(t){case G.F:{const e=a.isQueryPredefinedVin,t=a.hasOneOrLessStyleId;return!m||e&&t?k.a.createElement(Tt,a):k.a.createElement(ja,a)}case G.m:return k.a.createElement(ns,Object(s.a)({},i,{isMobile:p}));case G.p:return k.a.createElement(ms,n);case G.ab:return k.a.createElement(zi,r);case G.A:return k.a.createElement(Mr.a,{name:"EVAL-3712-AddressToVin"},e=>k.a.createElement(ri,Object(s.a)({},o,{isMobile:p,isLicencePlateAndVinStep:!0,isAddressToVinEnabled:e})));case G.N:return k.a.createElement(un,l);case G.x:return d.vin?k.a.createElement(Ae.a,{name:"EVAL-3573",showDefault:!0},k.a.createElement(Ae.c,{name:"ctrl",isDefault:!0},k.a.createElement(jr,Object(s.a)({},c,{isMobile:p,fireFbSignal:!0}))),k.a.createElement(Ae.c,{name:"chal1"},k.a.createElement(jr,Object(s.a)({},c,{isMobile:p,fireFbSignal:!0,eval3573Recipe:"chal1"}))),k.a.createElement(Ae.c,{name:"chal2"},k.a.createElement(jr,Object(s.a)({},c,{isMobile:p,fireFbSignal:!0,eval3573Recipe:"chal2"}))),k.a.createElement(Ae.c,{name:"chal3"},k.a.createElement(jr,Object(s.a)({},c,{isMobile:p,fireFbSignal:!0,eval3573Recipe:"chal3"})))):k.a.createElement(Rr,Object(s.a)({},d,{isMobile:p,stepId:t,trackingCreativeId:G.C}));default:return null}}Dr.propTypes={stepId:w.a.string.isRequired,locationAndStyleProps:w.a.shape({}).isRequired,optionsAndColorsProps:w.a.shape({}).isRequired,conditionAndMileageProps:w.a.shape({}).isRequired,appraisalReportProps:w.a.shape({}).isRequired,licensePlateAndVinProps:w.a.shape({}).isRequired,offerConditionsProps:w.a.shape({}).isRequired,instantOfferProps:w.a.shape({}).isRequired,escapeHatchProps:w.a.shape({}).isRequired,isMobile:w.a.bool,isExtendedReport:w.a.bool},Dr.defaultProps={isMobile:!1,isExtendedReport:!1};a("./site-modules/shared/components/appraisal/trade-in-appraiser/trade-in-appraiser.scss");a.d(t,"TradeInAppraiserUI",function(){return Zr}),a.d(t,"stateToPropsConfig",function(){return Gr}),a.d(t,"mapDispatchToProps",function(){return Wr}),a.d(t,"mapStateToProps",function(){return Qr}),a.d(t,"TradeInAppraiserIdmWrapper",function(){return Kr}),a.d(t,"TradeInAppraiser",function(){return Xr});const Lr={BUTTON_CLICK:{action_category:J.b.USER_ACTION_CATEGORY,action_cause:J.b.ACTION_CAUSE_BUTTON_CLICK},USER_INPUT:{action_category:J.b.USER_ACTION_CATEGORY,action_cause:J.b.ACTION_CAUSE_USER_INPUT}},Fr=[G.F,G.m,G.p],Ur="edm-entry-appraisal-estimate",qr=!0,zr={DRAWER:G.h,EXTENDED:G.L};function Br(e){let t=e.zipCode,a=e.isZipCodeValid,s=e.selectedStyle,i=e.errorMap,r=void 0===i?new Map:i,o=e.isPartnerOfferEligible,l=void 0!==o&&o,c=e.location,d=e.isPrepopulatedQueryParams,p=void 0!==d&&d,m=e.showStepBaseTitle,u=void 0!==m&&m,h=e.isExtendedReport,g=e.hasVinMismatchError,f=void 0!==g&&g,b=e.isVinFromDrawer,E=void 0!==b&&b,y=e.isEscapeHatch,v=void 0===y?qr:y,C=e.predefinedVin,S=void 0===C?{}:C;const T=Object(Ee.a)(c),I=T.zip,_=T.colorId,N=T.mileage,O=T.condition,P=void 0===O?"":O,A=T.styleIds,x=p?{mileage:N||"",condition:G.n[P.toUpperCase()]||G.n.AVERAGE,color:_?{id:_}:{}}:{mileage:"",condition:G.n.AVERAGE,color:{}},k=h?zr.EXTENDED:zr.DRAWER;return Object(n.a)({steps:k,zipCode:I||t,vehicle:{style:s},isZipCodeValid:a,isPartnerOfferEligible:l},x,{options:[],style:"",styleIds:A,isMileageValid:!0,allConditionTotalPrices:{},appraisalEmailData:{},partnerOfferEmailData:{redemptionCertificateUri:"",appointmentUri:""},emailReportStatus:"",payoffAmount:0,errorMap:r,isPartnerOfferEligibleVin:null,isActiveInventory:null,isVinValid:!0,showStepBaseTitle:u,areQuestionnaireResponsesValid:!0,partnerEquipment:[],partnerConditionPricing:{},partnerOfferEligibilityResponse:{},partnerQuestionnaireResponses:{},vin:S.vin||"",hideVACDelightedSurvey:!1,hideEPODelightedSurvey:!1,hasVinMismatchError:f,isVinFromDrawer:E,isRecordingStarted:!1,appraisalReason:"",selectedReportType:G.kb,showAddEquipment:!0,isEscapeHatch:v,isLoadingColorsAndOptions:!1,isAllowedToPredefineVin:!0,chromeStyleIds:null,chromeStyleSku:null,transmissionType:null,engineSize:null,isTransmissionTypeTranslationOverride:!1,isEngineSizeTranslationOverride:!1})}const $r=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=e.isEval3460Enabled,a=e.profileOfferVin,s=e.location,i=Object(Ee.a)(s).vin;return{vin:i||t&&a||"",isQueryPredefinedVin:!!i}},Yr=null,Hr={VAC:"vacDelightedSurveyViewed",EPO:"epoDelightedSurveyViewed"};class Zr extends x.Component{constructor(){var e;e=super(...arguments),this.state=Br({zipCode:this.props.isUnknownVisitorZip?"":this.props.zipCode,selectedStyle:this.props.selectStyle?this.props.estimatedVehicle:{},location:this.props.location,isUnknownVisitorZip:this.props.isUnknownVisitorZip,isZipCodeValid:!0,isPrepopulatedQueryParams:!0,isExtendedReport:this.props.isExtendedReport,predefinedVin:$r(this.props)}),this.onVehicleOverride=(async(e,t)=>{const a=e.make,s=e.model,i=e.year,n=e.style;await this.setGeneralVehicleData(a,s,i,n,!0);const r=this.getActiveStep().nextId;this.changeStep({stepId:r,creativeId:t||Ur})}),this.onPropsZipCodeChange=(e=>this.setState({zipCode:e},()=>this.setValidatedZipStatus(!0))),this.onMileageBlur=(()=>{this.setState(e=>({mileage:Object(ce.p)(e.mileage),isMileageValid:Object(ce.o)(G.p,ce.g,e.mileage,{styleYear:T()(e.vehicle,"style.year")})}),()=>{const e=this.state,t=e.mileage;if(e.isMileageValid){const e=this.props.isExtendedReport;fe.a.fireEvent("update_mileage",{event_data:Object(n.a)({},Lr.USER_INPUT,{creative_id:e?G.c:G.t,value:t})})}})}),this.setValidatedZipStatus=function(t){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:b.a;e.setState({isZipCodeValid:t},()=>{a(),e.toggleStepDone(e.isLocationAndStyleStepValid(),G.F)})},this.setVehicleDataForExtendedReport=(()=>{const e=this.props,t=e.isExtendedReport,a=e.estimatedVehicle,s=T()(this.state,"vehicle.style"),i=C()(s)?null:s;t&&a&&this.setGeneralVehicleData(a.make,a.model,{year:a.year.toString()},i,!0)}),this.setGeneralVehicleData=((e,t,a,s,i)=>{const n=this.state.vehicle;e&&n.make&&!i&&this.clearStepsData();const r={make:e,model:t,year:a,style:s};s&&!u()(n.style,s)&&this.setLoadingColorsAndOptions(!0),this.setState({vehicle:r},()=>this.toggleStepDone(this.isLocationAndStyleStepValid(),G.F))}),this.setAdditionalStepsData=((e,t)=>this.setState(()=>({[e]:t}))),this.setPartnerOfferEligibility=(e=>this.setState({isPartnerOfferEligible:e})),this.setPartnerOfferVinEligibility=(e=>this.setState({isPartnerOfferEligibleVin:e},()=>{e||this.state.hasVinMismatchError||(this.fireSavingAppraisalDataToIdm(),fe.a.fireEvent("partner_submit_vin",{event_data:{creative_id:G.B,value:G.gb.vin_ineligible}}))})),this.setChromeStyleIds=(e=>this.setState({chromeStyleIds:e})),this.setChromeStyleSku=(e=>this.setState({chromeStyleSku:e})),this.setTranslationTransmissionType=(e=>{let t=e.transmissionType,a=e.isOverride,s=void 0!==a&&a;return this.setState(()=>({transmissionType:t,isTransmissionTypeTranslationOverride:s}))}),this.setTranslationEngineSize=(e=>{let t=e.engineSize,a=e.isOverride,s=void 0!==a&&a;return this.setState(()=>({engineSize:t,isEngineSizeTranslationOverride:s}))}),this.setActiveInventory=(e=>this.setState({isActiveInventory:e},()=>{this.fireSavingAppraisalDataToIdm()})),this.getLocationAndStyleData=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const a=e.state,s=a.zipCode,i=a.isZipCodeValid,n=a.errorMap,r=a.styleIds,o=a.vehicle,l=a.partnerOfferEligibilityResponse,c=a.isPartnerOfferEligibleVin,d=a.vin,p=a.hasVinMismatchError,m=a.isAllowedToPredefineVin,u=a.isLoadingColorsAndOptions,h=e.props,g=h.estimatedVehicle,f=h.selectStyle,b=h.isExtendedReport,E=h.isMobile,y=h.isEval3460Enabled,v=$r(e.props),C=v.vin,S=v.isQueryPredefinedVin;return{zipCode:s,estimatedVehicle:g,vehicle:o,selectStyle:f,isZipCodeValid:i,onZipCodeChange:e.changeZipCode,onDropdownsSelect:e.setGeneralVehicleData,errorMap:n,isExtendedReport:b,isMobile:E,updateStepsState:e.setAdditionalStepsData,hasOneOrLessStyleId:!r||1===r.split(",").length,changeStep:e.changeStep,vin:d,isQueryPredefinedVin:S,clearVin:()=>e.changeVin(""),updateVinAndContinue:async t=>{await e.changeVin(t)},isStepActive:t.isActive,isPartnerOfferEligibleVin:c,isEligibleHardcodeYmmBypass:T()(l,"reason")===G.vb,onPartnerOfferVinEligibilityUpdate:e.setPartnerOfferVinEligibility,onActiveInventoryCheck:e.setActiveInventory,updateErrorMapAndScrollToInvalid:e.updateErrorMapAndScrollToInvalid,isProfileOfferVinPrepopulationEnabled:y&&!S,hasVinMismatchError:p,queryVin:C,isAllowedToPredefineVin:m,checkVinMismatchError:e.checkVinMismatchError,isLoadingColorsAndOptions:u}},this.getOptionsAndColorsData=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const a=e.state,s=a.vehicle,i=a.errorMap,n=a.isZipCodeValid,r=a.color,o=e.props,l=o.isExtendedReport,c=o.isEval3446Chal1Enabled,d=o.drawerCreativeId;return{onOptionsSelect:e.selectOptions,onColorSelect:e.selectColors,updateStepsState:e.setAdditionalStepsData,isStepActive:t.isActive,vehicle:s,errorMap:i,onPartnerOfferEligibilityUpdate:e.setPartnerOfferEligibility,isExtendedReport:l,isZipCodeValid:n,preSelectedColor:r,setLoadingColorsAndOptions:e.setLoadingColorsAndOptions,setTranslationTransmissionType:e.setTranslationTransmissionType,setTranslationEngineSize:e.setTranslationEngineSize,setChromeStyleIds:e.setChromeStyleIds,isEval3446Chal1Enabled:c,drawerCreativeId:d}},this.getConditionAndMileageData=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const a=e.state,s=a.mileage,i=a.condition,n=a.isMileageValid,r=a.errorMap,o=a.vehicle.style,l=a.isPartnerOfferEligible,c=a.chromeStyleIds,d=a.transmissionType,p=a.engineSize,m=a.isTransmissionTypeTranslationOverride,u=a.isEngineSizeTranslationOverride,h=a.partnerOfferEligibilityResponse,g=o||{},f=g.makeName,b=g.modelName,E=g.year,y=g.id,v=e.props.isExtendedReport;return{mileage:s,condition:i,isMileageValid:n,onMileageChange:e.changeMileage,onConditionChange:e.selectCondition,getMileageRef:e.getMileageRef,onMileageBlur:e.onMileageBlur,errorMap:r,isExtendedReport:v,isStepActive:t.isActive,isPartnerOfferEligible:l,setChromeStyleSku:e.setChromeStyleSku,transmissionType:d,engineSize:p,isTransmissionTypeTranslationOverride:m,isEngineSizeTranslationOverride:u,styleId:y,chromeStyleIds:c,isEligibleHardcodeYmmBypass:T()(h,"reason")===G.vb,make:f,model:b,year:E,activeStepId:e.getActiveStep().id}},this.getAppraisalReportData=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const a=e.state,s=a.mileage,i=a.color,n=a.condition,r=a.options,o=a.partnerEquipment,l=a.zipCode,c=a.isZipCodeValid,d=a.isMileageValid,p=a.emailReportStatus,m=a.isPartnerOfferEligible,u=a.hideVACDelightedSurvey,h=a.selectedReportType,g=a.partnerOfferEligibilityResponse,f=a.vin,b=a.showAddEquipment,E=e.props,y=E.isMobile,v=E.isExtendedReport,C=E.sellYourCarConfig,S=E.sellingPrice,T=E.msrp,I=E.residualValue,_=E.isPurchase,N=E.isUsed,O=E.onDone,P=E.mechanicalStyle,A=$r(e.props).vin,x=o.length>0;return{getVehicleData:e.getVehicleData.bind(e),changeStep:e.changeStep,options:r,showAddEquipment:b,hasPartnerEquipment:x,color:i,mileage:s,condition:n,zipCode:l,isExtendedReport:v,isMobile:y,isZipCodeValid:c,isMileageValid:d,isAllStepsCompleted:e.checkStepsCompleteness(),onReportFormed:e.toggleStepDone,updateStepsState:e.setAdditionalStepsData,emailReportStatus:p,resetEmailReportStatus:e.resetEmailReportStatus,sellYourCarConfig:C,isReportActive:t.isActive&&t.id===G.ab,stepNextId:t.nextId,isPartnerOfferEligible:m,hideDelightedSurvey:u,handleDelightedSurveyClick:e.handleVACDelightedSurveyClick,onPayoffChange:e.handlePayoffChange,sellingPrice:S,msrp:T,residualValue:I,isPurchase:_,queryVin:A,isUsed:N,selectedReportType:h,partnerOfferEligibilityResponse:g,vin:f,toggleAppraiserDrawer:O,getPartnerAppraisalPayload:e.getPartnerAppraisalPayload.bind(e),mechanicalStyle:P}},this.getLicensePlateAndVinData=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const a=t.nextId,s=t.trackingParentId,i=t.isDone,n=e.state,r=n.vin,o=n.vehicle,l=n.partnerOfferEligibilityResponse,c=n.isVinFromDrawer,d=n.hasVinMismatchError,p=n.isPartnerOfferEligibleVin,m=n.isAllowedToPredefineVin,u=e.props,h=u.isExtendedReport,g=u.isMobile,f=$r(e.props),b=f.vin,E=f.isQueryPredefinedVin;return{vehicle:o,isStepActive:t.isActive&&t.id===G.A,stepNextId:a,updateVinAndContinue:async function(t){let i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];await e.changeVin(t),i||e.changeStep({stepId:a,creativeId:s})},clearVin:()=>e.changeVin(""),changeStep:e.changeStep,onPartnerOfferVinEligibilityUpdate:e.setPartnerOfferVinEligibility,onActiveInventoryCheck:e.setActiveInventory,updateErrorMapAndScrollToInvalid:e.updateErrorMapAndScrollToInvalid,onValueChange:e.toggleLicensePlateAndVinStepDone,vin:r,isExtendedReport:h,isEligibleHardcodeYmmBypass:T()(l,"reason")===G.vb,queryVin:b,isQueryPredefinedVin:E,isVinFromDrawer:c,hasVinMismatchError:d,isStepDone:i,isPartnerOfferEligibleVin:p,updateStepsState:e.setAdditionalStepsData,isMobile:g,isAllowedToPredefineVin:m}},this.getOfferConditionsData=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const a=e.state,s=a.errorMap,i=a.vin,n=a.vehicle,r=a.partnerOfferEligibilityResponse,o=a.isVinFromDrawer,l=$r(e.props).vin;return{isStepActive:t.isActive&&t.id===G.N,updateQuestionnaireResponses:e.updateQuestionnaireResponses,onPartnerOfferVinEligibilityUpdate:e.setPartnerOfferVinEligibility,vehicle:n,vin:i,errorMap:s,isVinFromDrawer:o,isEligibleHardcodeYmmBypass:T()(r,"reason")===G.vb,predefinedVin:l,activeStepId:e.getActiveStep().id}},this.getPartnerAppraisalPayload=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const a=e.state,s=a.vehicle.style,n=a.zipCode,r=a.vin,l=a.condition,c=a.options,d=a.mileage,p=a.partnerEquipment,m=a.partnerQuestionnaireResponses,u=a.color,h=a.transmissionType,g=parseInt(d,10),f=(new Date).toISOString(),b=D()(`${g}|${r}|${f}`,G.v);if(t){return{sourceId:b,createdDateUtc:f,vin:r,mileage:g,zipCode:n,transmission:h,exteriorColorCode:99,conditionQuestions:Object.entries(m).map(e=>{let t,a=Object(i.a)(e,2),s=a[0],n=a[1];if("object"==typeof n){if(C()(n))return null;t=Object.keys(n).filter(e=>!!n[e]).map(e=>parseInt(e,10))}else t=[n];return{id:parseInt(s,10),answers:t}}).filter(e=>!!e)}}const E=s.makeName,y=s.modelName,v=s.year,S=s.name,I=s.trimName,_={},N={};return p.forEach(e=>{const t=!!c.find(t=>t.name===e);_[e]=t}),Object.keys(m).forEach(e=>{const t=m[e],a=he[e];if(a)if("object"==typeof t){if(!C()(t)){const e=a;Object.keys(o()(t,e=>e)).forEach(t=>{const a=parseInt(t,10)-1,s=T()(e,[a,"v1Key"]);s&&(N[s]="true")})}}else{const e=a.v1Key,s=a.v1ValueByV2AnswerId;N[e]=s[t]}}),{sourceId:b,vin:r,mileage:g,make:E,model:y,year:v,color:u.name||null,style:S,trim:I,condition:l,zipCode:n,createdDateUtc:f,equipment:_,conditionQuestionResponses:N}},this.getInstantOfferData=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const a=e.props,s=a.isExtendedReport,i=a.mechanicalStyle,r=a.isMobile,o=a.setAppraiseFinished,l=a.isEval3446Chal1Enabled;if(!s)return{};const c=e.state,d=c.color,p=c.condition,m=c.isPartnerOfferEligibleVin,u=c.vin,h=c.partnerOfferMileage,g=c.partnerOfferEligibilityResponse,f=c.mileage,E=c.options,y=c.zipCode,v=c.hideEPODelightedSurvey,C=c.emailReportStatus,S=c.vehicle,T=c.chromeStyleSku,I=t.isActive&&t.id===G.x,_=Object(n.a)({},e.getAppraisalReportData(t),{onReportFormed:b.a,stepId:G.x,creativeId:G.f,isReportActive:I});return{getVehicleData:e.getVehicleData.bind(e),getPartnerAppraisalPayload:e.getPartnerAppraisalPayload.bind(e),condition:p,color:d,partnerOfferMileage:h,partnerOfferEligibilityResponse:g,mileage:f,vin:u,options:E,zipCode:y,isStepActive:I,isPartnerOfferEligibleVin:m,hideDelightedSurvey:v,handleDelightedSurveyClick:e.handleEPODelightedSurveyClick,updateStepsState:e.setAdditionalStepsData,fireMinMaxRangeTracking:e.fireMinMaxRangeTracking,addOfferTagToRecorder:e.addOfferTagToRecorder,handleEmailReportClick:e.handleEmailReportClick,saveInstantOfferDataToIdm:e.saveInstantOfferDataToIdm,emailReportStatus:C,resetEmailReportStatus:e.resetEmailReportStatus,mechanicalStyle:i,appraisalReportProps:_,vehicle:S,isMobile:r,chromeStyleSku:T,isEval3446Chal1Enabled:l,setAppraiseFinished:o,isStepFinal:t.isFinal,scrollToElement:e.scrollToElement,updatePartnerOfferQuoteId:e.updatePartnerOfferQuoteId}},this.getEscapeHatchData=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const a=e.props,s=a.isExtendedReport,i=a.setAppraiseFinished;if(!s)return{};const r=t.isActive&&t.id===G.x,o=e.state.vin,l=e.getLicensePlateAndVinData(t);return{isStepActive:r,vin:o,appraisalReportProps:Object(n.a)({},e.getAppraisalReportData(t),{onReportFormed:b.a,isEscapeHatch:qr,isReportActive:r,licensePlateAndVinProps:Object(n.a)({},l,{trackingCreativeId:G.C,updateVinAndContinue:async t=>{await e.changeVin(t,qr),e.scrollToNextStep()},clearVin:()=>e.changeVin("",qr),onValueChange:b.a,isStepActive:r,stepId:t.id})}),setAppraiseFinished:i,isStepFinal:t.isFinal}},this.setVehicleId=(()=>{const e=T()(this.state.vehicle,"style.id");e&&this.lastSavedStyleId!==e&&(this.lastSavedStyleId=e,this.vehicleId=R()())}),this.getMileageRef=(e=>{this.mileage=e}),this.getActiveStep=(()=>this.state.steps.find(e=>e.isActive)),this.getValidationErrors=(e=>{const t=this.state,a=t.zipCode,s=t.vehicle,i=t.color,n=t.mileage,r=t.condition,o=t.isZipCodeValid,l=t.partnerQuestionnaireResponses,c=T()(s,"make"),d=T()(s,"model"),p=T()(s,"year"),m=T()(s,"style"),u={make:c,model:d,year:p,zipCode:a,style:m,color:T()(i,"id"),mileage:n,condition:r,[ce.b]:l},h={styleYear:T()(m,"year")},g=new Map;return ce.k[e]&&ce.k[e].forEach(t=>{let a=t.fieldName;const s="zipCode"===a&&!o;if(y()(u,a)&&!Object(ce.o)(e,a,u[a],h)||s){const t=s?"":u[a];g.set(a,Object(ce.n)(e,a,t,h))}}),g}),this.getVehicleData=(()=>{const e=this.state.vehicle,t=T()(e,"make.name",""),a=T()(e,"model.name",""),s=T()(e,"style.makeSlug",""),i=T()(e,"style.modelSlug",""),n=T()(e,"style.name",""),r=T()(e,"style.id",""),o=T()(e,"style.submodels.name","");return{makeName:t,modelName:a,makeSlug:s,modelSlug:i,styleName:n,year:T()(e,"style.year",null),type:o,styleId:r,publicationState:T()(e,"style.publicationState","")}}),this.getVehicleStyle=(()=>this.state.vehicle&&this.state.vehicle.style&&this.state.vehicle.style.slug||null),this.getVehicleYear=(()=>this.state.vehicle&&this.state.vehicle.year&&this.state.vehicle.year.year||null),this.getVehicleColorManufactureCode=(()=>this.state.color&&this.state.color.manufactureOptionCode||null),this.getVehicleOptionsCount=(()=>this.state.optionsCount),this.getSelectedOptionsCount=(()=>this.state.options.length),this.getTotalPrices=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.state.allConditionTotalPrices;const a=e.state.condition;return a&&t&&t[a.toLowerCase()]||{}},this.setLocalStorage=(e=>{let t=e.tradeIn;const a=this.getVehicleMMY();this.storage.set(W.y.LEASE_PREFERENCES,Object(n.a)({},this.storage.get(W.y.LEASE_PREFERENCES),a,{tradeIn:t})),this.storage.set(W.y.LOAN_PREFERENCES,Object(n.a)({},this.storage.get(W.y.LOAN_PREFERENCES),a,{tradeIn:t}))}),this.getVehicleMMY=(()=>{const e=this.state.vehicle;return{make:e.make.name,model:e.model.name,year:e.year.year}}),this.setComputedEvalExperimentsTags=(()=>{const e=Z.a.getComputedExperiments(),t=Object.keys(e).filter(e=>/EVAL/gim.test(e)).map(t=>({[t.toLowerCase()]:e[t].recipe.value}));ye.a.addTag(t),t.some(e=>"ctrl"!==Object.values(e)[0])&&ye.a.addTag("hasABTestEVALChallenger")}),this.setLoadingColorsAndOptions=(e=>{this.setState({isLoadingColorsAndOptions:e})}),this.updatePartnerOfferQuoteId=(e=>this.props.setModelValue("partnerOfferQuoteId",se.b,e)),this.fireRetargetTracking=(()=>{ee.a.fireTrackAction({event_type:J.b.EVENT_TYPE_ACTION_COMPLETED,event_data:{action_name:J.b.ACTION_APPRAISE_VEHICLE,action_category:J.b.USER_ACTION_CATEGORY,action_cause:J.b.ACTION_CAUSE_BUTTON_CLICK,subaction_name:J.b.FLOW_VARIANT,creative_id:G.c,value:J.b.USE_SAVED_INFO}})}),this.fireSavingAppraisalDataToIdm=(()=>{const e=this.props,t=e.tmvConditions,a=e.isExtendedReport,s=this.state,i=s.options,n=s.vehicle;if(a&&!g()(t)&&!C()(n.style)){const e=!0,a=Ne(t,i),s=Oe(a);this.saveAppraiserDataToIdm(s,e)}}),this.resetEmailReportStatus=(()=>this.setState({emailReportStatus:""})),this.addOfferTagToRecorder=(()=>{this.props.isSessionRecorderActive&&ye.a.addTag("offer")}),this.activateSessionRecorder=(()=>{const e=this.props,t=e.visitorId,a=e.isSessionRecorderActive,s=e.isExtendedReport,i=this.state.isRecordingStarted;if(!s||!a||i)return;const n=K.a.get("appraiser").sessionRecorder,r=n.debug,o=n.wid;ye.a.track(o,{tag:["Appraisal Partner Offer session",{visitorId:t}],debug:r}),this.setComputedEvalExperimentsTags(),this.setState({isRecordingStarted:!0})}),this.generateIdmDataToSave=function(t,a){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const i=e.props.isAuthenticated,r=e.state.payoffAmount,o=void 0===r?0:r,l=e.getTotalPrices(t),c=C()(l)?{}:Object(ge.a)({tradeIn:l[G.kb],tradeInOwedAmount:o}),d=Object(n.a)({},at(e.state,e.vehicleId,l,t,s),i?{}:{isAnonymous:!0},c);return a&&(d.pii=function(e,t){const a=e.vehicle.style,s=a.year,i=a.name,n=a.makeNiceName,r=a.modelNiceName,o=a.submodels.slug;return{vehicles:{[t]:{savedTs:et(),niceMake:n,niceModel:r,niceSubModel:o,styleName:i,year:String(s),appraisalRef:tt(t),currentVehicle:!0}}}}(e.state,e.vehicleId)),d},this.saveEstimatedPayments=(()=>{const e=this.state,t=e.allConditionTotalPrices,a=e.payoffAmount,s=e.appliedTradeIn,i=e.vehicle,n=this.props,r=n.onTradeInUpdate,o=n.onDone,l=n.onVehicleUpdate,c=n.isAuthenticated,d=this.getTotalPrices()[G.kb],p=d+a;this.setVehicleId();const m=this.generateIdmDataToSave(t,!0);if(this.setLocalStorage({tradeIn:p}),null!==c){(c?this.updateIdmDataWrapper:this.authenticate)(m),Object(ne.c)(p)}r&&r(X.yb,p,Yr,this.getVehicleMMY(),{[X.c]:d,[X.kb]:Math.abs(a),[X.b]:s}),l&&l(i),G.db.event_data.value=p,ee.a.fireTrackAction(G.db),o&&o()}),this.authenticate=async function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{await e.props.signInAnonymousAndSaveProfile(t,G.c)}catch(e){Object(B.a)("warn","Appraisal wasn't saved properly",e)}},this.saveAppraiserDataToIdm=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.setVehicleId();const s=e.props.isAuthenticated,i=e.getTotalPrices(t);if(!C()(i)&&(a&&e.setLocalStorage({tradeIn:i[G.kb]}),null!==s)){const a=e.generateIdmDataToSave(t,!1);(s?e.updateIdmDataWrapper:e.authenticate)(a),Object(ne.c)(i[G.kb])}},this.saveInstantOfferDataToIdm=(e=>{const t=this.props,a=t.isAuthenticated,s=t.isExtendedReport,i=t.tmvConditions,r=this.vehicleId,o=this.state.options;if(null!==a&&s){const t=tt(r),s=Object(n.a)({},e,{appraisalRef:t});let l={};if(!g()(i)){const t=e.offerPrice,a=Ne(i,o),s=Oe(a);l=this.generateIdmDataToSave(s,!1,t)}const c=Object(n.a)({},l,function(e){return{appraisalOffersHistory:[e]}}(s),{appraisalOffers:s,leads:{[r]:{type:"Appraisal",submittedTs:(new Date).toISOString(),appraisalRef:t}}});(a?this.updateIdmDataWrapper:this.authenticate)(c)}}),this.emailReport=(async e=>{try{this.setState(()=>({emailReportStatus:G.u.IN_PROGRESS}));const t=it(this.state);await Object(oe.a)({data:t,campaignName:t.redemptionCertificateUri?"offer_email":"appraisal_email",email:e||this.props.userEmail}),this.setState(()=>({emailReportStatus:G.u.SENT}))}catch(e){this.setState(()=>({emailReportStatus:G.u.SENT})),Object(B.a)("warn","Appraisal email wasn't sent properly",e)}}),this.customEventEmailReport=(e=>{let t=e.detail;this.emailReport(t.email)}),this.handleEmailReportClick=(()=>{const e=this.props;(0,e.toggleAuthenticatedModal)({isAppraisalEmailCTA:!0,email:e.userEmail})}),this.toggleStepDone=function(t,a){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=e.state.steps,n=A()(i,{id:a}),r=n+1,o=i.length;i[n].isDone=t,i[n].skipStep=s;for(let e=r;e<o;e+=1)i[e].isDone=!1;e.setState({steps:i}),e.updateErrors(a)},this.checkStepsCompleteness=(()=>{const e=this.state.steps,t=e.length;return e.slice(0,t-1).every(e=>e.isDone)}),this.checkReportActive=(()=>{const e=this.state.steps;return e[e.length-1].isActive}),this.scrollTo=((e,t)=>{if(document){const a=document.querySelector(e);a&&a.scrollIntoView(Object(n.a)({behavior:"smooth",block:"start"},t))}}),this.scrollToNextStep=(()=>{const e=this.getActiveStep();this.scrollTo(`.${G.jb} .${e.id}`)}),this.scrollToReportStep=(()=>{setTimeout(()=>{this.scrollTo(`.${G.jb} .${G.ab}`)},1e3)}),this.scrollToTradeInTitle=(()=>{this.props.isMobile&&this.scrollTo(`[name="${G.hb}"]`)}),this.scrollToInvalid=(()=>{const e=this.state.errorMap;for(let t=0;t<ce.i.length;t+=1){const a=ce.i[t];if(e.has(a.input))return void this.scrollToElement(`.${G.jb} ${a.selector}`,a.options)}}),this.scrollToElement=((e,t)=>{this.scrollTo(e,t)}),this.debouncedScroll=_()(this.scrollToNextStep,500),this.updateErrors=(e=>{this.state.errorMap.size&&this.setState({errorMap:this.getValidationErrors(e)})}),this.fireActiveStepEvents=(e=>{e===G.N&&ee.a.fireTrackAction(G.O)}),this.fireActiveStepEndEvents=((e,t)=>{let a=t.style,s=t.colorManufactureCode,i=t.selectedOptionsCount,r=t.condition,o=t.mileage,l=t.creativeId,c=t.userSelectedPreviousStep,d=t.zipCode,p=t.vehicleYear;e===G.p&&(fe.a.fireEvent("submit_mileage",{event_data:Object(n.a)({},Lr.BUTTON_CLICK,{creative_id:l,value:o})}),fe.a.fireEvent("submit_condition",{event_data:Object(n.a)({},Lr.BUTTON_CLICK,{creative_id:l,value:r})})),e===G.F&&(fe.a.fireEvent("submit_style",{event_data:Object(n.a)({},Lr.BUTTON_CLICK,{creative_id:l,value:a})}),fe.a.fireEvent("submit_year",{event_data:Object(n.a)({},Lr.BUTTON_CLICK,{creative_id:l,value:p})}),d&&!c&&fe.a.fireEvent("submit_zipcode",{event_data:Object(n.a)({},Lr.BUTTON_CLICK,{creative_id:l,value:d})})),e===G.m&&(fe.a.fireEvent("submit_color",{event_data:Object(n.a)({},Lr.BUTTON_CLICK,{creative_id:l,value:s?`manufactureOptionCode: "${s}"`:"none"})}),fe.a.fireEvent("submit_options",{event_data:Object(n.a)({},Lr.BUTTON_CLICK,{creative_id:l,value:i})})),e===G.N&&fe.a.fireEvent("partner_condition_questions_validation",{event_data:Object(n.a)({},Lr.BUTTON_CLICK,{creative_id:l,value:"success"})})}),this.fireActiveStepEndInvalidatedEvents=((e,t)=>{let a=t.creativeId;e===G.N&&fe.a.fireEvent("partner_condition_questions_validation",{event_data:Object(n.a)({},Lr.BUTTON_CLICK,{creative_id:a,value:"failure"})})}),this.fireMinMaxRangeTracking=(e=>{let t=e.rough,a=e.clean;const s={action_category:J.b.USER_ACTION_CATEGORY,action_cause:J.b.ACTION_CAUSE_BUTTON_CLICK,creative_id:G.W};fe.a.fireEvent("partner_appraisal_range_min",{event_data:Object(n.a)({},s,{value:t})}),fe.a.fireEvent("partner_appraisal_range_max",{event_data:Object(n.a)({},s,{value:a})})}),this.checkVinMismatchError=(e=>{const t=this.state.vehicle,a=T()(t,"make.slug",""),s=T()(t,"model.slug",""),i=T()(t,"year.year",""),n=T()(e,"[0]",{}),r=n.makeNiceId,o=n.modelNiceId,l=n.year;this.setState({hasVinMismatchError:3!==p()([a,r,s,o,i,`${l}`]).length})}),this.checkVinStylesMismatchError=(()=>{const e=this.props,t=e.estimatedVehicle,a=t.make,s=t.model,i=t.year,n=e.vinStyles,r=T()(n,"[0]",{}),o=r.makeNiceId,l=r.modelNiceId,c=r.year;this.setState({hasVinMismatchError:3!==p()([o,a.slug,l,s.slug,c,i]).length})}),this.processStepsUpdate=((e,t,a,s)=>{const i=this.state,r=i.hasVinMismatchError,o=i.isVinFromDrawer,l=$r(this.props).vin,d=(l||o)&&!r;let p;return e.map(e=>{const i=Object(n.a)({},e,{isDone:e.isDone||!s&&e.id===t,isActive:e.id===a});if(p=e.skipToStepObj||p,!d||C()(p)||s)return i;const r=e.id===t,m=p,u=m.shouldSkipHappen,h=m.skipToStepId,g=m.markCompleteId,f=m.hasBeenSkipped,b=u({queryVin:l,isVinFromDrawer:o,hasBeenSkipped:f})&&a===g,E=b&&e.id===h;return i.isDone=e.isDone||r||b,i.isActive=e.id===a&&!b||E,c()(i.skipToStepObj)||(i.skipToStepObj=Object(n.a)({},p,{hasBeenSkipped:r})),i})}),this.changeStep=(e=>{let t=e.currentTarget,a=e.stepId,s=e.creativeId;const i=this.props,n=i.onEstimatedValuesWidgetHide,r=i.isExtendedReport,o=i.isMobile,l=i.onPartnerFaqQuestionsShow,c=i.onLinkWidgetHide,d=this.state,p=d.condition,m=d.mileage,u=d.vin,h=d.zipCode,g=d.isPartnerOfferEligible,f=this.getVehicleStyle(),b=this.getVehicleYear(),E=this.getVehicleColorManufactureCode(),y=this.getSelectedOptionsCount(),v=this.getVehicleOptionsCount(),C=this.getActiveStep(),S=C.id;let T=a;t&&(T=t.getAttribute("data-index"));const I=!!C.skipStep,_=C.prevIds.includes(T),N=this.getValidationErrors(S),P=t?Object(be.c)(t):s;if(I||_||!N.size){const e=T;S===G.F&&(this.updateLocationStyleTitle(),n&&n(),c()),S!==G.p||_||this.updateAllTmvParams(),this.fireActiveStepEvents(e),this.fireActiveStepEndEvents(S,{style:f,colorManufactureCode:E,selectedOptionsCount:y,optionsCount:v,condition:p,mileage:m,creativeId:P,vin:u,userSelectedPreviousStep:_,zipCode:h,vehicleYear:b}),this.setState(t=>{const a=t.steps;return{steps:this.processStepsUpdate(a,S,e,_),errorMap:new Map}},()=>{const e=this.getActiveStep().id;r?this.debouncedScroll():o&&e===G.ab?this.scrollToReportStep():this.scrollToTradeInTitle(),l&&l(r&&g&&O()(G.J,e))})}else this.updateErrorMapAndScrollToInvalid(N),this.fireActiveStepEndInvalidatedEvents(S,{creativeId:P})}),this.updateErrorMapAndScrollToInvalid=(e=>this.setState({errorMap:e},this.scrollToInvalid)),this.clearStepsData=(()=>{const e=this.props,t=e.isExtendedReport,a=e.location,s=this.state,i=s.zipCode,r=s.errorMap,o=s.vehicle.style,l=s.isZipCodeValid,c=s.isPartnerOfferEligible,d=s.showStepBaseTitle,p=s.partnerQuestionnaireResponses,m=s.areQuestionnaireResponsesValid,u=s.vin,h=s.isPartnerOfferEligibleVin,g=s.isVinFromDrawer,f=s.isEscapeHatch,b=s.isAllowedToPredefineVin,E=Br({zipCode:i,isZipCodeValid:l,selectedStyle:o,errorMap:r,location:a,isExtendedReport:t,showStepBaseTitle:d,isVinFromDrawer:g,predefinedVin:$r(this.props)});this.mileage.reset(),this.setState(t?Object(n.a)({},E,{isPartnerOfferEligible:c,isPartnerOfferEligibleVin:h,partnerQuestionnaireResponses:p,areQuestionnaireResponsesValid:m,vin:u,isEscapeHatch:f,isAllowedToPredefineVin:b}):E)}),this.updateLocationZip=(e=>this.props.setModelValue("location",Y.c,{zipCode:e})),this.updateLocationAddressZip=(e=>this.props.setModelValue("location.address",Y.c,{zipCode:e})),this.updateAllTmvParams=(async()=>{const e=this.state,t=e.vehicle.style.id,a=e.mileage,s=e.color.id,i=e.condition,n=e.options,r=e.zipCode,o=n.map(e=>e.id).join(",");this.props.setModelValue("allTmvParams",te.c,{styleId:t,condition:i,mileage:a,zipCode:r,optionIds:o,colorId:s})}),this.updateLocationStyleTitle=(()=>{this.setState({showStepBaseTitle:!0})}),this.changeZipCode=(e=>{let t=e.target.value;this.setState(()=>({zipCode:t})),Object(ce.t)(t)?this.updateLocationZip(t).then(()=>this.setValidatedZipStatus(!0)).catch(()=>this.setValidatedZipStatus(!1)):this.setValidatedZipStatus(!1)}),this.isLocationAndStyleStepValid=(()=>this.state.isZipCodeValid&&!C()(this.state.vehicle.make)&&!C()(this.state.vehicle.style)),this.isConditionAndMileageStepValid=(()=>!(!(this.state.mileage&&this.state.isMileageValid&&this.state.condition)||O()(G.H,this.state.condition))),this.changeMileage=(e=>{let t=e.target.value;this.setState(e=>{let a=e.errorMap,s=e.vehicle;const i={styleYear:T()(s,"style.year")},n=Object(ce.o)(G.p,ce.g,t,i);return n||a.set(ce.g,Object(ce.n)(G.p,ce.g,t,i)),{mileage:t,isMileageValid:n,errorMap:a}},()=>{const e=this.isConditionAndMileageStepValid();this.toggleStepDone(e,G.p)})}),this.selectCondition=(e=>{let t=e.target.value;this.setState({condition:t},()=>{const e=this.isConditionAndMileageStepValid();this.toggleStepDone(e,G.p)})}),this.selectOptions=((e,t)=>this.setState({options:e,optionsCount:t},()=>{this.toggleStepDone(!0,G.m)})),this.selectColors=(e=>this.setState({color:e},()=>{this.toggleStepDone(!0,G.m)})),this.changeVin=((e,t)=>this.setState(a=>{let s=a.errorMap;return!C()(s)&&s.has(ce.d)&&s.delete(ce.d),{vin:e,isVinValid:Object(ce.s)(e),errorMap:s,isEscapeHatch:!!t}},()=>{t||this.toggleLicensePlateAndVinStepDone()})),this.updateQuestionnaireResponses=(e=>{this.setState({partnerQuestionnaireResponses:e,areQuestionnaireResponsesValid:Object(ce.r)(e)},()=>{const e=this.isPartnerOfferConditionsStepValid();this.toggleStepDone(e,G.N)})}),this.isLicensePlateAndVinStepValid=(()=>{const e=this.state,t=e.vin,a=e.isVinValid,s=e.hasVinMismatchError;return!(!t||!a||s)}),this.isPartnerOfferConditionsStepValid=(()=>this.state.areQuestionnaireResponsesValid),this.toggleLicensePlateAndVinStepDone=(()=>{const e=this.getActiveStep().id;if(![G.N,G.A].includes(e))return!1;const t=this.isLicensePlateAndVinStepValid();return this.toggleStepDone(t,G.A)}),this.updateIdmDataWrapper=(async e=>{try{await this.props.updateIdmData(e)}catch(e){Object(B.a)("warn","Profile data wasn't saved properly",e)}}),this.handlePayoffChange=((e,t)=>{this.setState(()=>({payoffAmount:e,appliedTradeIn:t}))}),this.checkDelightedSurvey=(()=>{this.setState({hideVACDelightedSurvey:!!this.sessionStorage.get(Hr.VAC),hideEPODelightedSurvey:!!this.sessionStorage.get(Hr.EPO)})}),this.handleDelightedSurveyClick=(e=>{const t=e?Hr.EPO:Hr.VAC,a=e?"hideEPODelightedSurvey":"hideVACDelightedSurvey";this.sessionStorage.set(t,!0),this.setState({[a]:!0})}),this.handleVACDelightedSurveyClick=(()=>{this.handleDelightedSurveyClick()}),this.handleEPODelightedSurveyClick=(()=>{this.handleDelightedSurveyClick(!0)}),this.renderTradeInAppraiserItem=((e,t)=>{const a=this.props,i=a.onDone,n=a.isMobile,r=a.isExtendedReport,o=this.state,l=o.isPartnerOfferEligibleVin,c=o.isVinValid,d=o.appliedTradeIn,p=o.isEscapeHatch,m=o.isVinFromDrawer,u=o.styleIds,h=o.vin,g=o.isLoadingColorsAndOptions,f=this.getTotalPrices(),b=$r(this.props),E=b.vin,y=b.isQueryPredefinedVin;return k.a.createElement(Et,Object(s.a)({id:e.id,stepCounter:t+1,onDone:i,onContinue:this.changeStep,onSave:this.saveEstimatedPayments,hasTotalPayment:!!f[G.kb],key:e.id,isExtendedReport:r,isPartnerOfferEligibleVin:l,isVinValid:c,appliedTradeIn:d,predefinedVin:E,isQueryPredefinedVin:y,isVinFromDrawer:m,styleIds:u,isEscapeHatch:p&&!h,isMobile:n,isLoadingColorsAndOptions:g},e),k.a.createElement(Dr,{stepId:e.id,isMobile:n,isExtendedReport:r,locationAndStyleProps:this.getLocationAndStyleData(e),optionsAndColorsProps:this.getOptionsAndColorsData(e),conditionAndMileageProps:this.getConditionAndMileageData(e),appraisalReportProps:this.getAppraisalReportData(e),licensePlateAndVinProps:this.getLicensePlateAndVinData(e),offerConditionsProps:this.getOfferConditionsData(e),instantOfferProps:this.getInstantOfferData(e),escapeHatchProps:this.getEscapeHatchData(e)}))})}componentDidMount(){const e=this.props,t=e.location,a=e.vinStyles,s=e.estimatedVehicle,i=this.state.zipCode;this.storage=new Q.a("localStorage"),this.sessionStorage=new Q.a("sessionStorage"),this.checkDelightedSurvey();const n=Object(Ee.a)(t),r=n.zip,o=n.styleIds,l=n.colorId,c=n.condition,d=n.mileage;r&&o&&l&&c&&d&&this.fireRetargetTracking(),this.setValidatedZipStatus(Object(ce.t)(i),this.setVehicleDataForExtendedReport),a.length&&s&&this.checkVinStylesMismatchError(),ee.a.on(Pe.d,this.customEventEmailReport),this.activateSessionRecorder()}componentDidUpdate(e,t){const a=this.props,s=a.tmvConditions,i=a.zipCode,n=a.vehicleOverride,r=a.setMMY,o=a.setAppraiseFinished,l=a.creativeIdOverride,c=a.profileOfferVin,d=a.isEval3460Enabled,p=a.vinStyles,m=a.estimatedVehicle,h=this.state,g=h.zipCode,f=h.vehicle,b=h.isAllowedToPredefineVin;if(u()(s,e.tmvConditions)||this.fireSavingAppraisalDataToIdm(),e.zipCode!==i&&g!==i&&this.onPropsZipCodeChange(i),ue(t.vehicle,f)||r(f),C()(n)||ue(e.vehicleOverride,n)||this.onVehicleOverride(n,l),o){const e=this.getActiveStep();if(!T()(e,"isFinal")){const a=(t.steps||[]).find(e=>e.isActive)||{};e.id!==a.id&&o(!1)}}const E=!$r(this.props).isQueryPredefinedVin&&d&&c;b&&E&&!u()(e.profileOfferVin,c)&&(this.changeVin(c),ee.a.fireTrackAction({event_type:J.b.EVENT_TYPE_ACTION_COMPLETED,event_data:{action_name:J.b.ACTION_APPRAISE_VEHICLE,subaction_name:J.b.VIN_AUTOFILL,creative_id:G.c,action_category:J.b.USER_ACTION_CATEGORY}})),b&&E&&p&&p.length&&m&&!u()(e.vinStyles,p)&&this.checkVinStylesMismatchError()}render(){const e=this.props,t=e.isMobile,a=e.className,s=e.columnsSize,i=e.headerText,n=e.subHeaderText,r=e.isExtendedReport,o=this.state,l=o.steps,c=o.isPartnerOfferEligible,d=o.isPartnerOfferEligibleVin,p=o.partnerOfferEligibilityResponse,m=this.getActiveStep().id,u=p.isEligible,h=p.reason,g=!u&&h||h===G.vb;return k.a.createElement("div",{className:a},k.a.createElement(ot,{subHeaderText:n,headerText:i,isExtendedReport:r}),k.a.createElement(F.a,null,k.a.createElement(q.a,s,k.a.createElement("div",{className:"trade-in-appraiser pos-r","data-partner-offer-eligible":c},l.map((e,t)=>k.a.createElement(x.Fragment,{key:`tia-item-${e.id}`},this.renderTradeInAppraiserItem(e,t))),r&&!Fr.includes(m)&&k.a.createElement(x.Fragment,null,m!==G.x?k.a.createElement(ze,{isMobile:t,className:"my-2"}):k.a.createElement(x.Fragment,null,!g&&d&&k.a.createElement(ze,{isMobile:t,className:"mb-2"})))))),k.a.createElement(Ae.a,{name:"EVAL-3460",showDefault:!0},k.a.createElement(Ae.c,{name:"ctrl",isDefault:!0}),k.a.createElement(Ae.c,{name:"chal0"}),k.a.createElement(Ae.c,{name:"chal1"})))}}Zr.propTypes={setModelValue:w.a.func.isRequired,updateIdmData:w.a.func.isRequired,signInAnonymousAndSaveProfile:w.a.func.isRequired,toggleAuthenticatedModal:w.a.func.isRequired,setMMY:w.a.func,className:w.a.string,zipCode:w.a.string,isAuthenticated:w.a.bool,isMobile:w.a.bool,selectStyle:w.a.bool,onDone:w.a.func,onTradeInUpdate:w.a.func,onVehicleUpdate:w.a.func,columnsSize:w.a.shape({xs:w.a.number,md:w.a.number,lg:w.a.number,xl:w.a.number}),isExtendedReport:w.a.bool,tmvConditions:w.a.shape({}),estimatedVehicle:te.b.StyleWithoutSubmodels,mechanicalStyle:te.b.MechanicalStyleEntity,headerText:w.a.string,subHeaderText:w.a.string,onEstimatedValuesWidgetHide:w.a.func,onPartnerFaqQuestionsShow:w.a.func,setAppraiseFinished:w.a.func,userEmail:w.a.string,sellYourCarConfig:le.e,anonymousSignInCreativeId:w.a.string,location:w.a.shape({search:w.a.string}).isRequired,isSessionRecorderActive:w.a.bool,visitorId:w.a.string,isUnknownVisitorZip:w.a.bool,isUsed:w.a.bool,vehicleOverride:w.a.shape({make:w.a.shape({}),model:w.a.shape({}),year:w.a.shape({}),style:w.a.shape({})}),onLinkWidgetHide:w.a.func,vinStyles:w.a.arrayOf(w.a.shape({id:w.a.number,year:w.a.number,makeName:w.a.string,makeNiceId:w.a.string,modelName:w.a.string,modelNiceId:w.a.string})),isEval3446Chal1Enabled:w.a.bool,drawerCreativeId:w.a.string,profileOfferVin:w.a.string},Zr.defaultProps={zipCode:"",className:"",onDone:null,onTradeInUpdate:null,onVehicleUpdate:null,isAuthenticated:!1,isMobile:!1,selectStyle:!1,columnsSize:{xs:12,md:11,lg:9,xl:8},isExtendedReport:!1,tmvConditions:null,mechanicalStyle:{},estimatedVehicle:null,headerText:"How much is your car worth?",subHeaderText:"Complete the form to generate an appraisal report",onEstimatedValuesWidgetHide:null,onPartnerFaqQuestionsShow:null,setAppraiseFinished:null,userEmail:"",sellYourCarConfig:{},anonymousSignInCreativeId:G.c,isSessionRecorderActive:!1,visitorId:"",isUnknownVisitorZip:!1,isUsed:!1,vehicleOverride:null,setMMY:b.a,onLinkWidgetHide:b.a,vinStyles:[],isEval3446Chal1Enabled:!1,drawerCreativeId:null,profileOfferVin:""};const Gr={zipCode:Object($.a)("location.zipCode",Y.c),visitorId:Object($.a)("id",Y.c),tmvConditions:Object($.a)(e=>{let t=e.allTmvParams;return t?Object(te.D)(t.styleId):""},te.c),mechanicalStyle:Object($.a)(e=>{let t=e.allTmvParams;return e.isExtendedReport&&t?Object(te.p)(t.styleId):""},te.c),vinStyles:Object($.a)(e=>{let t=e.location,a=e.isEval3460Enabled,s=e.profileOfferVin;const i=$r({location:t,isEval3460Enabled:a,profileOfferVin:s}).vin;return Object(ae.d)({vin:i})},ae.b)},Wr=e=>({toggleAuthenticatedModal:t=>e(Object(re.d)(ie.a.SIGN_UP_MODAL,t))}),Qr=e=>{const t=T()(e,"pageContext.location");return{profileOfferVin:T()(e,"profile.data.idm.appraisalOffersHistory[0].vin"),allTmvParams:T()(e,"vehicle.allTmvParams"),isMobile:e.mobile,userEmail:T()(e,"profile.data.idm.identifiers.email[0]",""),location:t,isUnknownVisitorZip:Object(ve.b)(T()(e,"visitor.location")),isSessionRecorderActive:ye.a.isActive(t,"appraiser"),isEval3460Enabled:"chal1"===Z.a.getForcedOrAssignedRecipeName({state:e,campaignName:"EVAL-3460",defaultVal:"ctrl"})}},Kr=Object(H.a)(Zr),Xr=Object(z.c)(Qr,Wr)(Object($.b)(Kr,Gr))},"./site-modules/shared/components/appraisal/trade-in-appraiser/trade-in-appraiser.scss":function(e,t,a){},"./site-modules/shared/components/appraisal/transaction-type-select/transaction-type-select.jsx":function(e,t,a){"use strict";a.d(t,"a",function(){return p});var s=a("../node_modules/react/index.js"),i=a.n(s),n=a("../node_modules/prop-types/index.js"),r=a.n(n),o=a("../node_modules/classnames/index.js"),l=a.n(o),c=a("./site-modules/shared/components/styled-select/styled-select.jsx"),d=a("./site-modules/shared/constants/appraisal/appraisal.js");a("./site-modules/shared/components/appraisal/transaction-type-select/transaction-type-select.scss");function p(e){let t=e.onChange,a=e.className,s=e.selected,n=e.labelText,r=e.labelClassName,o=e.isLabelHidden;return i.a.createElement("div",{className:l()("transaction-type-select form-group",a)},i.a.createElement(c.a,{name:"transactionType",labelText:n,onChange:t,options:d.mb,value:s,className:"select form-control text-gray-darker pr-2",labelClassName:r,isLabelHidden:o}))}p.propTypes={onChange:r.a.func.isRequired,className:r.a.string,selected:r.a.string,labelText:r.a.string,labelClassName:r.a.string,isLabelHidden:r.a.bool},p.defaultProps={className:"",selected:"",labelText:"Transaction type",labelClassName:"mb-0 small text-gray-darker",isLabelHidden:!1}},"./site-modules/shared/components/appraisal/transaction-type-select/transaction-type-select.scss":function(e,t,a){},"./site-modules/shared/components/appraisal/zip-field/zip-field.jsx":function(e,t,a){"use strict";a.d(t,"a",function(){return h});var s=a("../node_modules/@babel/runtime/helpers/esm/extends.js"),i=a("../node_modules/react/index.js"),n=a.n(i),r=a("../node_modules/prop-types/index.js"),o=a.n(r),l=a("./site-modules/shared/components/form-field/form-field.jsx"),c=a("./site-modules/shared/components/field-error/field-error.jsx"),d=a("./site-modules/shared/utils/appraiser/appraiser-validation-helper.js"),p=a("./utils/seed-randomizers.js"),m=a("../node_modules/classnames/index.js"),u=a.n(m);a("./site-modules/shared/components/appraisal/zip-field/zip-field.scss");class h extends i.Component{constructor(){super(...arguments),this.state={isEmptyZipCode:!this.props.zipCode,touched:!1},this.onZipCodeBlur=(()=>{this.setState(()=>({touched:!0}))})}render(){const e=this.props,t=e.zipCode,a=e.isZipCodeValid,i=e.onZipCodeChange,r=e.errorMap,o=e.zipClassName,m=e.labelClassName,h=e.disabled,g=e.isMobile,f=e.inputClassName,b=e.zipWrapperClassName,E=this.state,y=E.isEmptyZipCode,v=E.touched,C=r.get(d.m),S=`${d.m}-error-${Object(p.c)()}`,T=`zip-${Object(p.c)()}`;return g?n.a.createElement("div",{className:u()(b)},n.a.createElement(l.a,Object(s.a)({type:"number",inputMode:"numeric",pattern:"[0-9]*",id:T,name:"zip",label:" ","aria-label":"zip code",className:`appraiser-zip-field ${o}`,inputClassName:u()("value-zip-input",f),labelClassName:m,value:t,placeholder:"Enter Zip Code",isValid:!C&&(a||!a&&y&&!v),onChange:i,onBlur:this.onZipCodeBlur,disabled:h},C?{ariaDescribedBy:S,ariaInvalid:!0}:{})),n.a.createElement(c.a,{id:S,error:C,classes:"mt-0_5"})):n.a.createElement("div",{className:u()(b)},n.a.createElement(l.a,Object(s.a)({type:"number",inputMode:"numeric",pattern:"[0-9]*",id:T,name:"zip",label:"Zip",className:`appraiser-zip-field ${o}`,inputClassName:"value-zip-input",labelClassName:m,value:t,placeholder:"Enter Zip Code",isValid:!C&&(a||!a&&y&&!v),onChange:i,onBlur:this.onZipCodeBlur,disabled:h},C?{ariaDescribedBy:S,ariaInvalid:!0}:{})),n.a.createElement(c.a,{id:S,error:C,classes:"mt-0_5 zip-error-message-desktop"}))}}h.propTypes={isZipCodeValid:o.a.bool.isRequired,onZipCodeChange:o.a.func.isRequired,zipCode:o.a.string,errorMap:o.a.objectOf(o.a.string),zipClassName:o.a.string,labelClassName:o.a.string,disabled:o.a.bool,isMobile:o.a.bool,inputClassName:o.a.string,zipWrapperClassName:o.a.string},h.defaultProps={zipCode:"",errorMap:new Map,zipClassName:"",labelClassName:"small mb-0_25",disabled:!1,isMobile:!1,inputClassName:"",zipWrapperClassName:""}},"./site-modules/shared/components/appraisal/zip-field/zip-field.scss":function(e,t,a){},"./site-modules/shared/components/arrow-link/arrow-link.jsx":function(e,t,a){"use strict";a.d(t,"a",function(){return m});var s=a("../node_modules/@babel/runtime/helpers/esm/extends.js"),i=a("../node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js"),n=a("../node_modules/react/index.js"),r=a.n(n),o=a("../node_modules/prop-types/index.js"),l=a.n(o),c=a("../node_modules/classnames/index.js"),d=a.n(c),p=a("./site-modules/shared/components/link/link.jsx");a("./site-modules/shared/components/arrow-link/arrow-link.scss");function m(e){let t=e.to,a=e.children,o=e.className,l=e.isArrowLeft,c=Object(i.a)(e,["to","children","className","isArrowLeft"]);return r.a.createElement("span",{className:d()("arrow-link text-primary-darker d-block text-nowrap size-16",o)},l&&r.a.createElement(n.Fragment,null,r.a.createElement("i",{className:"icon-arrow-left4 size-10"}),"\xa0"),r.a.createElement(p.a,Object(s.a)({className:"text-wrap",to:t},c),a),!l&&r.a.createElement(n.Fragment,null,"\xa0",r.a.createElement("i",{className:"icon-arrow-right4 size-10"})))}m.propTypes={to:l.a.string,children:l.a.node,className:l.a.string,isArrowLeft:l.a.bool},m.defaultProps={to:"",children:"",className:"",isArrowLeft:!1}},"./site-modules/shared/components/arrow-link/arrow-link.scss":function(e,t,a){},"./site-modules/shared/components/calculator/checkbox-group/checkbox-group.scss":function(e,t,a){},"./site-modules/shared/components/calculator/credit-score/credit-score.jsx":function(e,t,a){"use strict";var s=a("../node_modules/@babel/runtime/helpers/esm/extends.js"),i=a("../node_modules/react/index.js"),n=a.n(i),r=a("../node_modules/classnames/index.js"),o=a.n(r),l=a("../node_modules/prop-types/index.js"),c=a.n(l),d=a("../node_modules/lodash/isEqual.js"),p=a.n(d),m=a("../node_modules/reactstrap/lib/ButtonGroup.js"),u=a.n(m),h=a("../node_modules/reactstrap/lib/Button.js"),g=a.n(h);a("./site-modules/shared/components/calculator/checkbox-group/checkbox-group.scss");function f(e){let t=e.onClick,a=e.onKeyPress,s=e.selected,i=e.values,r=e.id,l=e.disabled,c=e.trackingId,d=e.classes;return n.a.createElement(u.a,{className:o()("d-flex justify-content-between checkbox-group",d),"data-toggle":"buttons","aria-label":r},i.map(e=>{let i=e.rate,d=e.name,m=e.disabled;const u=(e=>p()(s,e))(d),h=!u&&l||m;return n.a.createElement(g.a,{disabled:h,key:d,name:r,value:d,outline:!u,size:"md",tabIndex:0,onClick:t,onKeyPress:a,color:u?"primary":"secondary",className:o()("checkbox-group-tab px-0_25 d-flex flex-column align-items-center w-100",{active:u,"bg-white":!u}),"data-tracking-id":h?"":c,"data-tracking-value":h?"":`${d} ${i}`},n.a.createElement("span",{className:o()("medium",{"text-gray-darker":!u})},d),n.a.createElement("span",{className:o()("small font-weight-normal",{"text-gray-darker":!u})},i))}))}f.propTypes={onClick:c.a.func,onKeyPress:c.a.func,values:c.a.arrayOf(c.a.shape({name:c.a.string,rate:c.a.string})).isRequired,selected:c.a.string,id:c.a.string.isRequired,disabled:c.a.bool,trackingId:c.a.string,classes:c.a.string},f.defaultProps={onClick:null,onKeyPress:null,selected:"",disabled:!1,trackingId:null,classes:""};var b=a("../node_modules/reactstrap/lib/Label.js"),E=a.n(b),y=a("./site-modules/shared/components/tooltip-item/tooltip-item.jsx");a("./site-modules/shared/components/calculator/credit-score/credit-score.scss");function v(e){const t=e.titleClasses,a=e.title,i=e.id,r=e.tooltip,l=e.tooltipClass,c=e.tooltipIconClass;return n.a.createElement("div",{className:"credit-score"},n.a.createElement(E.a,{className:"mb-1"},n.a.createElement("span",{className:t},a),n.a.createElement(y.a,{id:i,item:r,className:o()("tooltip-text",l),iconClassName:c})),n.a.createElement(f,Object(s.a)({},e,{trackingId:"input_credit_score"})))}a.d(t,"a",function(){return v}),v.propTypes={onClick:c.a.func,onKeyPress:c.a.func,values:c.a.arrayOf(c.a.shape({name:c.a.string,rate:c.a.string})).isRequired,selected:c.a.string.isRequired,id:c.a.string.isRequired,title:c.a.string.isRequired,tooltip:c.a.shape({text:c.a.string.isRequired,placement:c.a.string.isRequired}).isRequired,disabled:c.a.bool,titleClasses:c.a.string,tooltipClass:c.a.string,tooltipIconClass:c.a.string},v.defaultProps={onClick:null,onKeyPress:null,disabled:!1,titleClasses:"mr-0_5",tooltipClass:"",tooltipIconClass:""}},"./site-modules/shared/components/calculator/credit-score/credit-score.scss":function(e,t,a){},"./site-modules/shared/components/calculator/lease-calculator-form/lease-calculator-form.scss":function(e,t,a){},"./site-modules/shared/components/calculator/loan-calculator-form/loan-calculator-form.scss":function(e,t,a){},"./site-modules/shared/components/calculator/monthly-payment/monthly-payment.scss":function(e,t,a){},"./site-modules/shared/components/calculator/payment-calculator/payment-calculator.jsx":function(e,t,a){"use strict";var s=a("../node_modules/@babel/runtime/helpers/esm/extends.js"),i=a("../node_modules/@babel/runtime/helpers/esm/objectSpread.js"),n=a("../node_modules/lodash/noop.js"),r=a.n(n),o=a("../node_modules/lodash/isNumber.js"),l=a.n(o),c=a("../node_modules/lodash/isNull.js"),d=a.n(c),p=a("../node_modules/lodash/get.js"),m=a.n(p),u=a("../node_modules/lodash/omit.js"),h=a.n(u),g=a("../node_modules/lodash/debounce.js"),f=a.n(g),b=a("../node_modules/react/index.js"),E=a.n(b),y=a("../node_modules/prop-types/index.js"),v=a.n(y),C=a("../node_modules/reactstrap/lib/Row.js"),S=a.n(C),T=a("../node_modules/reactstrap/lib/Col.js"),I=a.n(T),_=a("../node_modules/classnames/index.js"),N=a.n(_),O=a("../node_modules/react-scroll/lib/modules/index.js"),P=a("./data/models/incentives.js"),A=a("./data/models/inventory.js"),x=a("./tracking/constant.js"),k=a("./engagement-handlers/inventory-engagement-handler/inventory-engagement-handler.js"),V=a("../node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js"),w=a("../node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),j=a("../node_modules/lodash/isNil.js"),R=a.n(j),M=a("../node_modules/lodash/isFinite.js"),D=a.n(M),L=a("../node_modules/lodash/every.js"),F=a.n(L),U=a("../node_modules/lodash/pickBy.js"),q=a.n(U),z=a("../node_modules/lodash/pick.js"),B=a.n(z),$=a("../node_modules/lodash/isEqual.js"),Y=a.n($),H=a("./data/api/api-client.js"),Z=a("./utils/event-toolbox.js"),G=a("./utils/isomorphic-logger.js"),W=a("./site-modules/shared/utils/storage.js"),Q=a("./utils/metrics-header.js"),K=a("./site-modules/shared/utils/calculator/calculator-helper.js"),X=a("./site-modules/shared/utils/calculator/form-helper.js"),J=a("./site-modules/shared/utils/inventory-utils/is-new.js"),ee=a("./site-modules/shared/utils/inventory-utils/get-vehicle-age.js"),te=a("./site-modules/shared/utils/car-buying/calculator-util.js"),ae=a("./site-modules/shared/components/profile/insider-methods.jsx"),se=a("./data/luckdragon/redux/react-binding.jsx"),ie=a("./data/models/version.js"),ne=a("./data/models/page.js"),re=a("./data/models/car-buying.js"),oe=a("./site-modules/shared/constants/inventory/price-analysis.js"),le=a("./site-modules/shared/constants/calculator/calculator.js"),ce=a("./site-modules/shared/constants/car-buying/index.js"),de=a("./site-modules/shared/constants/calculator/events.js"),pe=a("./site-modules/shared/constants/car-buying/models.js"),me=a("./site-modules/shared/utils/car-buying/digital-retail-payment-service.js");const ue=["apr","numberOfMonths","downPayment","tradeIn","creditScore"];let he="",ge="";class fe extends b.Component{constructor(e){super(e),this.getSharedSelections=(()=>{const e=this.props.selections,t=l()(e.tradeIn)?e.tradeIn:this.tradeInFromStorage,a=l()(t)?t:le.I,s=l()(e.downPayment)?e.downPayment:this.downPaymentFromStorage;return{tradeIn:a,downPayment:l()(s)?s:le.C,customVehiclePrice:l()(e.customVehiclePrice)?e.customVehiclePrice:""}}),this.getAPR=(()=>{const e=this.state.loanPayments,t=e.apr,a=e.creditScore,s=this.props.baseAPR;return l()(s)?s:a?m()(this.aprValues,`${this.state.loanPayments.numberOfMonths}[0].apr`,0):t||0}),this.getAPRs=(async()=>{const e=this.props,t=e.offer,a=t.taxesAndFeesZipCode,s=t.styleId,i=t.year,n=t.mileage,r=t.type,o=e.pageName,l=e.venomVersion,c=this.state.loanPayments.creditScore,d=Object(J.a)(r),p=await H.c.fetchJson(`/${d?"newaprs":"usedaprs"}/v1/?styleId=${s||le.G}&zipCode=${a}&vehicleAge=${Object(ee.a)(i)}&creditScore=${c}&vehicleMileage=${n}`,{headers:Object(Q.a)(`${d?"loanAPRsNew":"loanAPRsUsed"}`,o,l)});return p&&p.terms}),this.getUrl=(e=>{let t=e.customVehiclePrice,a=e.price,s=e.primaryIncentiveAmountValue,i=e.params,n=e.additionalParams,r=void 0===n?"":n;const o="/calculators/v2/loanpayment/?";return t?s?[`${o}salesPrice=${t}&primaryIncentiveAmount=0${i}${r}`,`${o}salesPrice=${a}&primaryIncentiveAmount=${s}${i}${r}`]:`/car-buying/v1/aggregation/calculate/loanpayment?salesPrices=${t},${a}&primaryIncentiveAmount=${s}${i}${r}`:`${o}salesPrice=${a}&primaryIncentiveAmount=${s}${i}${r}`}),this.getLoanPaymentsApiUrl=(()=>{const e=this.state.loanPayments.numberOfMonths,t=this.props.offer,a=t.taxesAndFeesZipCode,s=t.styleId,i=t.marketValue,n=t.docFee,r=t.price,o=t.type,l=this.props,c=l.isTaxesAndFeesEnabled,d=l.selectedLoanIncentives,p=l.msrp,m=this.getSharedSelections(),u=m.tradeIn,h=m.downPayment,g=m.customVehiclePrice,f=d?d.filter(e=>{return e.primary}):[],b=d?d.filter(e=>{return!e.primary}):[],E=Object(te.h)(f),y=Object(te.h)(b),v=Object(J.a)(o)?"New":"Used",C=`&msrp=${p}&numberOfMonths=${e}&downPayment=${h}&tradeIn=${u}&financeRate=${this.getAPR()}&conditionalIncentiveAmount=${y}&titleFees=0&applyLimits=true&calculatorType=${v}`;if(c){if(!a)return"";const e=`&zipCode=${a}${s?`&styleId=${s}`:"&withTaxesAndFees=false"}&marketValue=${i}&docFee=${Object(te.k)(n)}${C}`;return this.getUrl({customVehiclePrice:g,price:r,primaryIncentiveAmountValue:E,params:e})}return this.getUrl({customVehiclePrice:g,price:r,primaryIncentiveAmountValue:E,params:C,additionalParams:"&withTaxesAndFees=false"})}),this.getPayments=(async e=>{const t=this.props,a=t.venomVersion,s=t.pageName,i=await Promise.all(e.map(e=>H.c.fetchJson(e,{headers:Object(Q.a)("loanPayments",s,a)}).catch(e=>(this.updateSelection({loanMonthlyPayment:null,downPayment:null,tradeIn:null,numberOfMonths:null,financeRate:null,widgetLoanMonthlyPayment:null,calculatedOffer:null}),Object(G.a)("error",`Get loan payments error - ${e}`),null)))),n=Object(w.a)(i,2);return{customPayment:n[0],payment:n[1]}}),this.getLoanPayments=(async()=>{const e=this.getLoanPaymentsApiUrl();if(!e)return null;const t=this.props,a=t.pageName,s=t.venomVersion,n=t.onMonthlyPaymentUpdate,r=t.offer,o=t.usePaymentWithTaxesAndFeesForTabs;if(this.updateSelection({}),Array.isArray(e)){const t=await this.getPayments(e),a=t.customPayment,s=t.payment,l=a.calculationCriteria,c=a.loanAmount,d=a.loanMonthlyPayment,p=a.limitCriteria,u=a.loanMonthlyPaymentWithTaxes,h=a.totalTaxesAndFees,g=a.taxes,f=a.fees,b=this.state.limitCriteria,E=l.financeRate,y=l.numberOfMonths,v=l.downPayment,C=l.tradeIn;this.limitMessages=Object(X.c)(p,r.type),Object(K.k)({cur:{limitCriteria:p},prev:{limitCriteria:b}},[le.ab,le.Z],le.h),this.updateSelection({loanMonthlyPayment:d,downPayment:v,tradeIn:C,numberOfMonths:y,financeRate:E,widgetLoanMonthlyPayment:m()(s,"loanMonthlyPayment"),calculatedOffer:s});const S=u||d;return n(o?S:d,"loan"),this.setState(e=>{let t=e.loanPayments;return{loanPayments:Object(i.a)({},t,{loan:c,monthly:d,monthlyWithTaxes:S,totalTaxesAndFees:h,taxes:g,fees:Object(i.a)({},f,{docFee:this.props.offer.docFee})}),limitCriteria:p,drawerOffer:Object(i.a)({},s)}},()=>this.fireCalculatorPaymentsChangeEvent(l,p))}return H.c.fetchJson(e,{headers:Object(Q.a)("loanPayments",a,s)}).then(e=>{const t=Object(K.f)(e),a=t.calculationCriteria,s=t.loanAmount,l=t.loanMonthlyPayment,c=t.limitCriteria,d=t.loanMonthlyPaymentWithTaxes,p=t.totalTaxesAndFees,u=t.taxes,h=t.fees,g=this.state.limitCriteria,f=a.financeRate,b=a.numberOfMonths,E=a.downPayment,y=a.tradeIn;this.limitMessages=Object(X.c)(c,r.type),Object(K.k)({cur:{limitCriteria:c},prev:{limitCriteria:g}},[le.ab,le.Z],le.h),this.updateSelection({loanMonthlyPayment:l,downPayment:E,tradeIn:y,numberOfMonths:b,financeRate:f,widgetLoanMonthlyPayment:m()(Object(K.f)(e,!0),"loanMonthlyPayment"),calculatedOffer:Object(K.f)(e,!0)});const v=d||l;return n(o?v:l,"loan"),this.setState(t=>{let a=t.loanPayments;return{loanPayments:Object(i.a)({},a,{loan:s,monthly:l,monthlyWithTaxes:v,totalTaxesAndFees:p,taxes:u,fees:Object(i.a)({},h,{docFee:this.props.offer.docFee})}),limitCriteria:c,drawerOffer:Object(i.a)({},Object(K.f)(e,!0))}},()=>this.fireCalculatorPaymentsChangeEvent(a,c))}).catch(e=>{this.updateSelection({loanMonthlyPayment:null,downPayment:null,tradeIn:null,numberOfMonths:null,financeRate:null,widgetLoanMonthlyPayment:null,calculatedOffer:null}),Object(G.a)("error",`Get loan payments error - ${e}`)})}),this.limitMessages={},this.updateIdmDataWrapper=(async e=>{try{await this.props.updateIdmData(e)}catch(e){Object(G.a)("warn","Profile data wasn't saved properly",e)}}),this.authenticate=(async e=>{try{await this.props.signInAnonymousAndSaveProfile(e,"edm-entry-payment-calculator")}catch(e){Object(G.a)("warn","Appraisal wasn't saved properly",e)}}),this.saveTradeInDataToIdm=(()=>{const e=this.props.isAuthenticated,t=Object(i.a)({},e?{}:{isAnonymous:!0});null!==e&&(e?this.updateIdmDataWrapper:this.authenticate)(t)}),this.updateSelection=(e=>{let t=e.loanMonthlyPayment,a=e.downPayment,s=e.tradeIn,n=e.numberOfMonths,r=e.financeRate,o=e.widgetLoanMonthlyPayment,l=e.calculatedOffer;const c=this.props,d=c.onSelectionUpdate,p=c.selections,u=this.state.loanPayments.creditScore,h={monthlyPayment:t,downPayment:Number(a),tradeIn:Number(s),numberOfMonths:Number(n),financeRate:Number(r),customVehiclePrice:m()(p,"customVehiclePrice",""),widgetMonthlyPayment:Number(o),calculatedOffer:l,apr:this.getAPR(),creditScore:u,storedSelections:this.storage.get(ce.y.LOAN_PREFERENCES)||{}};d({loan:Object(i.a)({},h,{isCustomized:function(e,t,a){const s=e.numberOfMonths;return F()(e,e=>D()(e))&&!(a===le.C&&s===le.H&&t===le.I)}(h,s,a)})}),d.flush()}),this.fireCalculatorPaymentsChangeEvent=((e,t)=>{const a=this.props,s=a.offer.vin,n=a.creativeId;Z.a.fireCustomEvent(de.a.CALCULATE_PAYMENT,{vin:s,type:le.h,creativeId:n,payments:Object(i.a)({},this.state.loanPayments,e),limitCriteria:t})}),this.resetAppliedIncentives=(()=>{const e=this.props,t=e.vin,a=e.setModelValue,s=e.selectedLoanIncentives,i=e.selectedLeaseIncentives,n=e.updateGetThisDealBtn;if(s){const e=s.filter(e=>{return e.primary})||[];a(re.b.SELECTED_LOAN_INCENTIVES({vin:t}),re.a,{vin:t,incentives:e})}if(i){const e=i.filter(e=>{return!e.conditionCategory})||[];a(re.b.SELECTED_LEASE_INCENTIVES({vin:t}),re.a,{vin:t,incentives:e})}a(re.b.RESET_CUSTOM_VEHICLE_PRICE({vin:t}),re.a,!1),n(!0)}),this.changeState=(e=>{let t=e.value,a=e.name,s=e.additionalValue;const n=this.props,r=n.onSharedInputUpdate,o=n.unselectFinancingPromotions,l=n.baseTermMonths,c=n.updateGetThisDealBtn;if(!(this.state.loanPayments[a]!==t))return null;const d=Object(i.a)({[a]:t},s),p=Object(K.j)(a);return l&&!p&&o&&o(oe.d.CHECKBOX),a===le.t&&(t?this.resetAppliedIncentives(t):c(!1)),p?(r(a,t,le.g),a===le.yb&&this.saveTradeInDataToIdm(),null):this.setState(e=>({loanPayments:Object(i.a)({},e.loanPayments,d)}),()=>{(0,this.props.clearMMYFromStorage)(),this.storage.set(ce.y.LOAN_PREFERENCES,q()(Object(i.a)({},this.storage.get(ce.y.LOAN_PREFERENCES),d,{isUsed:!1}),e=>!R()(e)))})});const t=e.baseAPR,a=e.baseTermMonths,s=e.offer,n=e.useDefaults;this.storage=new W.a("localStorage"),he=`${t}_${a}`;const r=!n&&this.storage.get(ce.y.LOAN_PREFERENCES)||{},o=r.numberOfMonths,c=r.apr,d=r.creditScore,p=r.tradeIn,u=r.downPayment;this.tradeInFromStorage=p,this.downPaymentFromStorage=u;const h=!d&&c?c:null,g=s.type,f=Object(J.a)(g)?le.q[le.l].value:le.q[le.n].value;this.state={loanPayments:{apr:t||h,numberOfMonths:a||o||le.H,loan:null,monthly:null,creditScore:Object(me.a)(d)||(c?null:f)},limitCriteria:{},drawerOffer:{}},this.isAprReqInProgress=!1}static getDerivedStateFromProps(e,t){let a=e.baseAPR,s=e.baseTermMonths,n=t.loanPayments;return(ge=`${a}_${s}`)!==he?{loanPayments:Object(i.a)({},n,{numberOfMonths:s||n.numberOfMonths})}:null}async componentDidMount(){const e=this.props.offer.taxesAndFeesZipCode,t=this.state.loanPayments.creditScore;e&&(t&&(this.isAprReqInProgress=!0,this.aprValues=await this.getAPRs(),this.isAprReqInProgress=!1),this.getLoanPayments())}async componentDidUpdate(e,t){let a=t.loanPayments;const s=this.props,i=s.offer,n=s.isTaxesAndFeesEnabled,r=s.selectedLoanIncentives,o=s.updateGetThisDealBtn,l=s.resetCustomVehiclePrice,c=s.onSharedInputUpdate,d=s.vin,p=this.state.loanPayments,u=p.creditScore,h=e.vin&&d!==e.vin;i.taxesAndFeesZipCode&&u&&(a.creditScore!==u||!e.offer.taxesAndFeesZipCode||h)&&(this.aprValues=await this.getAPRs());const g=m()(e,"selectedLoanIncentives"),f=!Y()(r,g),b=B()(a,ue),E=B()(p,ue),y=!Y()(b,E),v=le.tb.some(t=>e.selections[t]!==this.props.selections[t]),C=n&&e.offer.taxesAndFeesZipCode!==i.taxesAndFeesZipCode,S=e.offer.conditionalIncentiveAmount!==i.conditionalIncentiveAmount;e.resetCustomVehiclePrice!==l&&l&&(o(!1),c(le.t,"")),(y||C||S||ge!==he||v||f||h)&&!this.isAprReqInProgress&&(he=ge,this.getLoanPayments())}render(){const e=this.state,t=e.loanPayments,a=t.creditScore,s=(t.apr,Object(V.a)(t,["creditScore","apr"])),n=e.limitCriteria,r=e.drawerOffer,o=this.getSharedSelections(),l=o.tradeIn,c=o.downPayment,d=o.customVehiclePrice;return E.a.createElement("div",null,E.a.cloneElement(this.props.children,{payments:Object(i.a)({},s,this.props.offer,{apr:this.getAPR(),tradeIn:l,downPayment:c,customVehiclePrice:d}),baseCreditScore:Object(K.e)(a),limitMessages:this.limitMessages,onChange:this.changeState,limitCriteria:n,drawerOffer:r}))}}fe.propTypes={setModelValue:v.a.func.isRequired,vin:v.a.string.isRequired,offer:v.a.shape({price:v.a.oneOfType([v.a.string,v.a.number]).isRequired,type:v.a.string.isRequired,year:v.a.oneOfType([v.a.string,v.a.number]),taxesAndFeesZipCode:v.a.string,styleId:v.a.string,marketValue:v.a.number,conditionalIncentiveAmount:v.a.number,primaryIncentiveAmount:v.a.number,docFee:v.a.number,mileage:v.a.number}).isRequired,selections:v.a.shape({apr:v.a.oneOfType([v.a.string,v.a.number]),numberOfMonths:v.a.oneOfType([v.a.string,v.a.number]),downPayment:v.a.oneOfType([v.a.string,v.a.number]),tradeIn:v.a.oneOfType([v.a.string,v.a.number]),customVehiclePrice:v.a.oneOfType([v.a.string,v.a.number])}),onMonthlyPaymentUpdate:v.a.func.isRequired,onSelectionUpdate:v.a.func.isRequired,onSharedInputUpdate:v.a.func.isRequired,children:v.a.node.isRequired,venomVersion:v.a.string.isRequired,pageName:v.a.string.isRequired,creativeId:v.a.string.isRequired,baseAPR:v.a.number,baseTermMonths:v.a.number,msrp:v.a.number.isRequired,isTaxesAndFeesEnabled:v.a.bool,isAuthenticated:v.a.bool,updateIdmData:v.a.func.isRequired,signInAnonymousAndSaveProfile:v.a.func.isRequired,unselectFinancingPromotions:v.a.func,clearMMYFromStorage:v.a.func,selectedLoanIncentives:v.a.arrayOf(pe.j),selectedLeaseIncentives:v.a.arrayOf(pe.j),updateGetThisDealBtn:v.a.func,resetCustomVehiclePrice:v.a.bool,usePaymentWithTaxesAndFeesForTabs:v.a.bool,useDefaults:v.a.bool},fe.defaultProps={payments:{year:"",taxesAndFeesZipCode:"",styleId:"",marketValue:0,conditionalIncentiveAmount:0,primaryIncentiveAmount:0,docFee:null},selections:{apr:"",numberOfMonths:"",downPayment:"",tradeIn:"",customVehiclePrice:""},onInputChange:null,onRecalculationCall:null,baseAPR:null,baseTermMonths:null,shouldRecalculate:!1,isTaxesAndFeesEnabled:!1,isAuthenticated:null,unselectFinancingPromotions:null,clearMMYFromStorage:r.a,selectedLoanIncentives:[],selectedLeaseIncentives:[],updateGetThisDealBtn:null,resetCustomVehiclePrice:!1,usePaymentWithTaxesAndFeesForTabs:!1,useDefaults:!1};const be={pageName:Object(se.a)("page.name",ne.a),venomVersion:Object(se.a)("version",ie.a),selectedLoanIncentives:Object(se.a)(re.b.SELECTED_LOAN_INCENTIVES,re.a),selectedLeaseIncentives:Object(se.a)(re.b.SELECTED_LEASE_INCENTIVES,re.a),resetCustomVehiclePrice:Object(se.a)(e=>{let t=e.vin;return!!t&&re.b.RESET_CUSTOM_VEHICLE_PRICE({vin:t})},re.a)},Ee=Object(ae.a)(fe),ye=Object(se.b)(Ee,be);var ve=a("../node_modules/lodash/findKey.js"),Ce=a.n(ve);const Se=["numberOfMonths","downPayment","tradeIn","creditScore"];class Te extends b.Component{constructor(e){super(e),this.getLoanPaymentsApiUrl=(()=>{const e=this.state.loanPayments,t=e.numberOfMonths,a=e.creditScore,s=this.props.dealerZipCode,i=this.props.offer,n=i.taxesAndFeesZipCode,r=i.styleId,o=i.marketValue,l=i.docFee,c=i.price,d=this.props,p=d.isTaxesAndFeesEnabled,m=d.selectedLoanIncentives,u=this.getSharedSelections,h=u.tradeIn,g=u.downPayment,f=u.customVehiclePrice,b=(m?m.filter(e=>{return!e.primary}):[]).map(e=>e.id&&e.id).join(",");return n?`/loan/v2/lowestmonthlypayment/?salesPrice=${f||c}&customerZipCode=${n}&dealerZipCode=${s}&styleId=${r}&marketValue=${o}&conditionalIncentives=${b}&numberOfMonths=${t}&downPayment=${g}&tradeIn=${h}&creditScore=${a}${p?`&docFee=${Object(te.k)(l)}`:""}`:""}),this.getLoanPayments=(()=>{const e=this.getLoanPaymentsApiUrl();if(!e)return null;const t=this.props,a=t.pageName,s=t.venomVersion,n=t.onMonthlyPaymentUpdate,r=t.offer,o=t.usePaymentWithTaxesAndFeesForTabs;return this.updateSelection({}),H.c.fetchJson(e,{headers:Object(Q.a)("loanPayments",a,s)}).then(e=>{const t=e.calculationCriteria,a=e.loanAmount,s=e.loanMonthlyPayment,l=e.limitCriteria,c=e.loanMonthlyPaymentWithTaxes,d=e.totalTaxesAndFees,p=e.taxes,m=e.fees,u=this.state.limitCriteria,h=t.financeRate,g=t.numberOfMonths,f=t.downPayment,b=t.tradeIn,E=t.incentives,y=E?E.map(e=>({id:e})):[];this.limitMessages=Object(X.c)(l,r.type),Object(K.k)({cur:{limitCriteria:l},prev:{limitCriteria:u}},[le.ab,le.Z],le.h),this.updateSelection({loanMonthlyPayment:s,downPayment:f,tradeIn:b,numberOfMonths:g,financeRate:h,widgetLoanMonthlyPayment:s,calculatedOffer:e});const v=c||s;return n(o?v:s,"loan"),this.setState(e=>{let t=e.loanPayments;return{loanPayments:Object(i.a)({},t,{loan:a,monthly:s,monthlyWithTaxes:v,totalTaxesAndFees:d,taxes:p,fees:Object(i.a)({},m,{docFee:this.props.offer.docFee})}),limitCriteria:l,appliedPrimayLoanIncentives:y}},()=>this.fireCalculatorPaymentsChangeEvent(t,l))}).catch(e=>{this.updateSelection({loanMonthlyPayment:null,downPayment:null,tradeIn:null,numberOfMonths:null,financeRate:null,widgetLoanMonthlyPayment:null,calculatedOffer:null}),Object(G.a)("error",`Get loan payments error - ${e}`)})}),this.limitMessages={},this.updateIdmDataWrapper=(async e=>{try{await this.props.updateIdmData(e)}catch(e){Object(G.a)("warn","Profile data wasn't saved properly",e)}}),this.authenticate=(async e=>{try{await this.props.signInAnonymousAndSaveProfile(e,"edm-entry-payment-calculator")}catch(e){Object(G.a)("warn","Appraisal wasn't saved properly",e)}}),this.saveTradeInDataToIdm=(()=>{const e=this.props.isAuthenticated,t=Object(i.a)({},e?{}:{isAnonymous:!0});null!==e&&(e?this.updateIdmDataWrapper:this.authenticate)(t)}),this.updateSelection=(e=>{let t=e.loanMonthlyPayment,a=e.downPayment,s=e.tradeIn,n=e.numberOfMonths,r=e.financeRate,o=e.widgetLoanMonthlyPayment,l=e.calculatedOffer;const c=this.props,d=c.onSelectionUpdate,p=c.selections,u=this.state.loanPayments.creditScore,h={monthlyPayment:t,downPayment:Number(a),tradeIn:Number(s),numberOfMonths:Number(n),financeRate:Number(r),customVehiclePrice:m()(p,"customVehiclePrice",""),widgetMonthlyPayment:Number(o),calculatedOffer:l,creditScore:u,storedSelections:this.storage.get(ce.y.LOAN_PREFERENCES)};d({loan:Object(i.a)({},h,{isCustomized:function(e,t,a){const s=e.numberOfMonths;return F()(e,e=>D()(e))&&!(a===le.C&&s===le.H&&t===le.I)}(h,s,a)})}),d.flush()}),this.fireCalculatorPaymentsChangeEvent=((e,t)=>{const a=this.props,s=a.offer.vin,n=a.creativeId;Z.a.fireCustomEvent(de.a.CALCULATE_PAYMENT,{vin:s,type:le.h,creativeId:n,payments:Object(i.a)({},this.state.loanPayments,e),limitCriteria:t})}),this.resetAppliedIncentives=(()=>{const e=this.props,t=e.vin,a=e.setModelValue,s=e.selectedLoanIncentives,i=e.selectedLeaseIncentives,n=e.updateGetThisDealBtn;if(s){const e=s.filter(e=>{return e.primary})||[];a(re.b.SELECTED_LOAN_INCENTIVES({vin:t}),re.a,{vin:t,incentives:e})}if(i){const e=i.filter(e=>{return!e.conditionCategory})||[];a(re.b.SELECTED_LEASE_INCENTIVES({vin:t}),re.a,{vin:t,incentives:e})}a(re.b.RESET_CUSTOM_VEHICLE_PRICE({vin:t}),re.a,!1),n(!0)}),this.changeState=(e=>{let t=e.value,a=e.name,s=e.additionalValue;const n=this.props,r=n.onSharedInputUpdate,o=n.updateGetThisDealBtn;if(!(this.state.loanPayments[a]!==t))return null;const l=Object(i.a)({[a]:t},s),c=Object(K.j)(a);return a===le.t&&(t?this.resetAppliedIncentives(t):o(!1)),c?(r(a,t,le.g),a===le.yb&&this.saveTradeInDataToIdm(),null):this.setState(e=>({loanPayments:Object(i.a)({},e.loanPayments,l)}),()=>{(0,this.props.clearMMYFromStorage)(),this.storage.set(ce.y.LOAN_PREFERENCES,q()(Object(i.a)({},this.storage.get(ce.y.LOAN_PREFERENCES),l,{isUsed:!1}),e=>!R()(e)))})});const t=e.offer,a=e.useDefaults;this.storage=new W.a("localStorage");const s=!a&&this.storage.get(ce.y.LOAN_PREFERENCES)||{},n=s.numberOfMonths,r=s.creditScore,o=s.tradeIn,l=s.downPayment;this.tradeInFromStorage=o,this.downPaymentFromStorage=l;const c=t.type,d=Object(J.a)(c)?le.q[le.l].value:le.q[le.n].value;this.state={loanPayments:{numberOfMonths:n||le.H,loan:null,monthly:null,creditScore:r||d},limitCriteria:{}}}async componentDidMount(){this.props.offer.taxesAndFeesZipCode&&this.getLoanPayments()}async componentDidUpdate(e,t){let a=t.loanPayments;const s=this.props,i=s.offer,n=s.isTaxesAndFeesEnabled,r=s.selectedLoanIncentives,o=s.updateGetThisDealBtn,l=s.resetCustomVehiclePrice,c=s.onSharedInputUpdate,d=this.state.loanPayments,p=m()(e,"selectedLoanIncentives"),u=!Y()(r,p),h=B()(a,Se),g=B()(d,Se),f=!Y()(h,g),b=le.tb.some(t=>e.selections[t]!==this.props.selections[t]),E=n&&e.offer.taxesAndFeesZipCode!==i.taxesAndFeesZipCode,y=e.offer.conditionalIncentiveAmount!==i.conditionalIncentiveAmount;e.resetCustomVehiclePrice!==l&&l&&(o(!1),c(le.t,"")),(f||E||y||b||u)&&this.getLoanPayments()}get getSharedSelections(){const e=this.props.selections,t=l()(e.tradeIn)?e.tradeIn:this.tradeInFromStorage,a=l()(t)?t:le.I,s=l()(e.downPayment)?e.downPayment:this.downPaymentFromStorage;return{tradeIn:a,downPayment:l()(s)?s:le.C,customVehiclePrice:l()(e.customVehiclePrice)?e.customVehiclePrice:""}}get storedCreditScore(){const e=this.state.loanPayments.creditScore;return l()(e)?Ce()(le.q,t=>e<=t.max&&e>=t.min):"Unknown"}render(){const e=this.state,t=e.loanPayments,a=(t.creditScore,Object(V.a)(t,["creditScore"])),s=e.limitCriteria,n=e.appliedPrimayLoanIncentives,r=this.getSharedSelections,o=r.tradeIn,l=r.downPayment,c=r.customVehiclePrice;return E.a.createElement("div",null,E.a.cloneElement(this.props.children,{payments:Object(i.a)({},a,this.props.offer,{tradeIn:o,downPayment:l,customVehiclePrice:c}),baseCreditScore:this.storedCreditScore,limitMessages:this.limitMessages,onChange:this.changeState,limitCriteria:s,appliedPrimayLoanIncentives:n}))}}Te.propTypes={setModelValue:v.a.func.isRequired,vin:v.a.string.isRequired,offer:v.a.shape({price:v.a.oneOfType([v.a.string,v.a.number]).isRequired,type:v.a.string.isRequired,year:v.a.oneOfType([v.a.string,v.a.number]),taxesAndFeesZipCode:v.a.string,styleId:v.a.string,marketValue:v.a.number,conditionalIncentiveAmount:v.a.number,primaryIncentiveAmount:v.a.number,docFee:v.a.number,mileage:v.a.number}).isRequired,creativeId:v.a.string.isRequired,selections:v.a.shape({numberOfMonths:v.a.oneOfType([v.a.string,v.a.number]),downPayment:v.a.oneOfType([v.a.string,v.a.number]),tradeIn:v.a.oneOfType([v.a.string,v.a.number]),customVehiclePrice:v.a.oneOfType([v.a.string,v.a.number])}),dealerZipCode:v.a.string.isRequired,onMonthlyPaymentUpdate:v.a.func.isRequired,onSelectionUpdate:v.a.func.isRequired,onSharedInputUpdate:v.a.func.isRequired,children:v.a.node.isRequired,venomVersion:v.a.string.isRequired,pageName:v.a.string.isRequired,isTaxesAndFeesEnabled:v.a.bool,isAuthenticated:v.a.bool,updateIdmData:v.a.func.isRequired,signInAnonymousAndSaveProfile:v.a.func.isRequired,clearMMYFromStorage:v.a.func,selectedLoanIncentives:v.a.arrayOf(pe.j),selectedLeaseIncentives:v.a.arrayOf(pe.j),updateGetThisDealBtn:v.a.func,resetCustomVehiclePrice:v.a.bool,useDefaults:v.a.bool,usePaymentWithTaxesAndFeesForTabs:v.a.bool},Te.defaultProps={payments:{year:"",taxesAndFeesZipCode:"",styleId:"",marketValue:0,conditionalIncentiveAmount:0,primaryIncentiveAmount:0,docFee:null},selections:{numberOfMonths:"",downPayment:"",tradeIn:"",customVehiclePrice:""},onInputChange:null,shouldRecalculate:!1,isTaxesAndFeesEnabled:!1,isAuthenticated:null,clearMMYFromStorage:r.a,selectedLoanIncentives:[],selectedLeaseIncentives:[],updateGetThisDealBtn:null,resetCustomVehiclePrice:!1,usePaymentWithTaxesAndFeesForTabs:!1,useDefaults:!1};const Ie={pageName:Object(se.a)("page.name",ne.a),venomVersion:Object(se.a)("version",ie.a),selectedLoanIncentives:Object(se.a)(re.b.SELECTED_LOAN_INCENTIVES,re.a),selectedLeaseIncentives:Object(se.a)(re.b.SELECTED_LEASE_INCENTIVES,re.a),resetCustomVehiclePrice:Object(se.a)(e=>{let t=e.vin;return t?re.b.RESET_CUSTOM_VEHICLE_PRICE({vin:t}):null},re.a)},_e=Object(ae.a)(Te),Ne=Object(se.b)(_e,Ie);var Oe=a("../node_modules/reactstrap/lib/Form.js"),Pe=a.n(Oe),Ae=a("../node_modules/reactstrap/lib/FormGroup.js"),xe=a.n(Ae),ke=a("./site-modules/shared/components/calculator/payment-input/payment-input.jsx"),Ve=a("./site-modules/shared/components/calculator/radio-group/radio-group.jsx"),we=a("./site-modules/shared/components/calculator/credit-score/credit-score.jsx"),je=a("./site-modules/shared/components/calculator/vehicle-price/vehicle-price.jsx"),Re=a("./constants/inventory-types.js"),Me=a("../node_modules/lodash/isEmpty.js"),De=a.n(Me),Le=a("../node_modules/lodash/isUndefined.js"),Fe=a.n(Le),Ue=a("./site-modules/shared/utils/price-utils.js"),qe=a("./site-modules/shared/components/content-collapse/content-collapse.jsx"),ze=a("./site-modules/shared/components/tooltip-item/tooltip-item.jsx"),Be=a("./site-modules/shared/constants/index.js"),$e=a("./site-modules/shared/components/odometer-wrapper/odometer-wrapper.jsx"),Ye=a("./site-modules/shared/components/spinner/spinner.jsx");a("./site-modules/shared/components/calculator/monthly-payment/monthly-payment.scss");const He="-";function Ze(e){let t=e.price,a=e.disclaimerSymbol,s=e.priceClasses,i=e.monthsClasses,n=e.type,r=e.initialLoading,o=e.allowNegative,l=e.creativeId;Object(b.useEffect)(()=>{r||n!==le.g||t!==le.db||"price-checker-payment-calculator"!==l||Z.a.fireTrackAction({event_type:x.b.EVENT_TYPE_ACTION_COMPLETED,event_data:{subaction_name:"lease_payment_error",action_category:x.b.SYSTEM_ACTION_CATEGORY,value:He,creative_id:l}})},[r,n,t,l]);const c=t>0||o&&Number.isFinite(parseInt(t,10))?E.a.createElement(b.Fragment,null,E.a.createElement($e.OdometerWrapper,{value:t,classNames:N()("monthly-payment-value d-inline-block",s),duration:200}),E.a.createElement("span",{className:i},"/mo",a?E.a.createElement("sup",null,a):"")):E.a.createElement("span",{className:"d-inline-block pb-0_25 text-uppercase"},n===le.g?He:Be.f);return r?E.a.createElement(Ye.a,null):c}Ze.propTypes={disclaimerSymbol:v.a.string,monthsClasses:v.a.string,price:v.a.oneOfType([v.a.string,v.a.number]),priceClasses:v.a.string,type:v.a.string,initialLoading:v.a.bool,allowNegative:v.a.bool,creativeId:v.a.string},Ze.defaultProps={disclaimerSymbol:"",monthsClasses:"",price:0,priceClasses:"",type:"",initialLoading:!1,allowNegative:!1,creativeId:""};a("./site-modules/shared/components/calculator/price-item/price-item.scss");function Ge(e){let t=e.price,a=e.calculatorType,s=e.infoType,i=e.wrapperClasses,n=e.priceClasses,r=e.monthsClasses,o=e.tooltipId,l=e.title,c=e.priceAnimation,d=e.details;const p=le.ub[s];return E.a.createElement(S.a,{className:N()("price-item align-items-center mb-0_5",i)},E.a.createElement(I.a,{xs:8,lg:9,className:"pr-0 pr-md-0_5"},l," ",E.a.createElement(ze.a,{id:`${a}${o}`,className:"tooltip-text",item:p})),E.a.createElement(I.a,{xs:4,lg:3,className:N()("pl-0 text-right",n)},c?E.a.createElement(Ze,{price:t,disclaimerSymbol:"*",monthsClasses:r}):t),!!d&&E.a.createElement(I.a,{xs:12},E.a.createElement("div",{className:"small text-gray"},d)))}Ge.propTypes={calculatorType:v.a.string.isRequired,price:v.a.oneOfType([v.a.string,v.a.number]).isRequired,infoType:v.a.string.isRequired,wrapperClasses:v.a.string,monthsClasses:v.a.string,priceClasses:v.a.string,tooltipId:v.a.string.isRequired,title:v.a.string.isRequired,priceAnimation:v.a.bool,details:v.a.string},Ge.defaultProps={wrapperClasses:"",priceClasses:"",monthsClasses:"",priceAnimation:!1,details:""};var We=a("../node_modules/reactstrap/lib/Label.js"),Qe=a.n(We),Ke=a("../node_modules/reactstrap/lib/Input.js"),Xe=a.n(Ke),Je=a("./site-modules/shared/constants/key-codes.js");class et extends b.Component{constructor(){super(...arguments),this.state={value:"",previousTaxesAndFeesZipCode:""},this.setFallbackZipCode=(()=>{this.setState({value:this.props.taxesAndFeesZipCode})}),this.handleChange=(e=>{let t=e.target.value;this.setState({value:t})}),this.handleZipCodeChange=(e=>{this.props.setZipToStorage(e).catch(()=>{this.setFallbackZipCode()})}),this.handleEnterPress=(e=>{e.keyCode===Je.a?this.callUpdate():e.keyCode===Je.b&&this.setFallbackZipCode()}),this.callUpdate=(()=>{const e=this.props.onValidate,t=this.state.value;e&&e(t)?this.handleZipCodeChange(t):this.setFallbackZipCode()})}static getDerivedStateFromProps(e,t){return t.previousTaxesAndFeesZipCode!==e.taxesAndFeesZipCode?{value:e.taxesAndFeesZipCode,previousTaxesAndFeesZipCode:e.taxesAndFeesZipCode}:null}render(){const e=this.props,t=e.label,a=e.wrapperClasses,i=e.labelClasses,n=e.inputClasses,r=e.inputSize,o=e.calculatorType,l=e.isLabelHidden,c=`${o}-zip`;return E.a.createElement("div",{className:a},t&&!l&&E.a.createElement(Qe.a,{for:c,className:i},t),E.a.createElement(Xe.a,Object(s.a)({id:c,bsSize:r,type:"number",value:this.state.value,onKeyDown:this.handleEnterPress,onBlur:this.callUpdate,onChange:this.handleChange,className:n,"data-tracking-id":"taxes_and_fees_zip_input"},t&&l?{"aria-label":t}:{})))}}et.propTypes={onValidate:v.a.func,label:v.a.string,wrapperClasses:v.a.string,labelClasses:v.a.string,inputClasses:v.a.string,inputSize:v.a.string,taxesAndFeesZipCode:v.a.string,setZipToStorage:v.a.func.isRequired,calculatorType:v.a.string.isRequired,isLabelHidden:v.a.bool},et.defaultProps={onValidate:null,label:"",wrapperClasses:"",labelClasses:"",inputClasses:"",inputSize:"sm",taxesAndFeesZipCode:"",isLabelHidden:!1};var tt=a("./site-modules/shared/components/form-validation/validation.js"),at=a("./site-modules/shared/utils/calculator/taxes-and-fees-helper.js"),st=a("./site-modules/shared/components/car-buying/odometer-payment-value/odometer-payment-value.jsx"),it=a("./site-modules/shared/components/calculator/taxes-and-fees/taxes-and-fees-utils.jsx");a("./site-modules/shared/components/calculator/taxes-and-fees/taxes-and-fees.scss");function nt(e){let t=e.calculatorType,a=e.payments,s=a.monthlyWithTaxes,i=a.totalTaxesAndFees,n=a.taxes,r=a.fees,o=a.type,l=e.taxesAndFeesZipCode,c=e.setZipToStorage,d=e.appliedTradeIn,p=e.tradeInValidationErrorMsg;if(Fe()(s))return null;const m="number"==typeof i,u=t===le.g,h=u?le.P:le.O,g=!u||!De()(n),f=`Payment with ${g?"Taxes and ":""}Fees`,y=g?"paymentWithTaxesAndFees":"paymentWithFees";return E.a.createElement("div",{className:"taxes-and-fees"},E.a.createElement(Ge,{price:m?Object(Ue.a)(i,2,2):at.a,details:m?"":at.b,calculatorType:t,infoType:g?"taxesAndFees":"fees",tooltipId:"TaxesAndFees",title:`Estimated ${g?"Taxes and ":""}Fees`,wrapperClasses:"pt-0_5 mb-1"}),m&&E.a.createElement(et,{onValidate:tt.a.validateZip,taxesAndFeesZipCode:l,label:"For ZIP Code",inputClasses:"zip-input size-16 px-1 text-right",wrapperClasses:"d-flex justify-content-between align-items-center pos-r location-icon",labelClasses:"mb-0",setZipToStorage:c,calculatorType:t}),m&&E.a.createElement(qe.a,{minHeight:"0px",textClosed:"Show Details",textOpen:"Hide Details",justify:"justify-content-start",btnTextClasses:"text-capitalize font-weight-normal text-primary-darker",btnContainerClasses:"",btnArrowClasses:"small",showBtnBelow:!0,isBtnLink:!0},E.a.createElement("div",{className:"mt-1_5"},Object(it.a)(t,n,le.vb,o,!0)),E.a.createElement("div",{className:"mt-1_5"},Object(it.a)(t,r,h,o))),!!d&&E.a.createElement(b.Fragment,null,E.a.createElement("hr",{className:"my-1_5"}),E.a.createElement("div",{className:"d-flex align-items-baseline flex-nowrap justify-content-between no-gutters vehicle-param text-gray-darker body mt-1 mt-md-1_5"},E.a.createElement("div",null,E.a.createElement("span",null,"Applied Trade-In Value:")),E.a.createElement("div",{className:"text-right applied-trade-in font-weight-bold"},E.a.createElement(st.a,{value:d}))),E.a.createElement("div",{className:"disclaimer text-gray-darker mt-0_5"},p)),E.a.createElement("hr",{className:"mt-1_5 mb-2"}),E.a.createElement(Ge,{price:m?s:at.a,calculatorType:t,infoType:y,tooltipId:"PaymentWithTaxesAndFees",title:f,priceClasses:"font-weight-bold",monthsClasses:"font-weight-bold",priceAnimation:m}))}nt.propTypes={calculatorType:v.a.string.isRequired,payments:v.a.shape({monthlyWithTaxes:v.a.number,totalTaxesAndFees:v.a.number,taxes:v.a.shape({}),fees:v.a.objectOf(v.a.oneOfType([v.a.arrayOf(v.a.object),v.a.number])),type:v.a.string}),taxesAndFeesZipCode:v.a.string,setZipToStorage:v.a.func,appliedTradeIn:v.a.number,tradeInValidationErrorMsg:v.a.string},nt.defaultProps={payments:{monthlyWithTaxes:0,totalTaxesAndFees:0,taxes:{},fees:{}},taxesAndFeesZipCode:"",setZipToStorage:null,appliedTradeIn:0,tradeInValidationErrorMsg:""};var rt=a("../node_modules/dateformat/lib/dateformat.js"),ot=a.n(rt);const lt={[le.g]:"Excludes sales tax, title, registration, security deposit, and other fees. Actual monthly\npayments will vary. Does not represent a financing offer or guarantee of credit.",[le.h]:"Excludes sales tax, title, registration and other fees. Actual monthly payments will vary.\nDoes not represent a financing offer or guarantee of credit."},ct={[le.g]:(e,t,a,s)=>{let i=lt[le.g];return e&&t&&(i=`${Object(Ue.a)(t)} total due at lease signing includes down payment, first month payment, and ${Object(Ue.a)(a)} security deposit. Total cost to lessee is ${Object(Ue.a)(e)} over the lease term. ${s?"The payment shown includes estimated sales tax, title, registration and other fees.":"Except as otherwise expressly provided, excludes sales tax, title, registration and other fees."} Lessee is responsible for vehicle maintenance, insurance, repairs and charges for excess wear and tear. Actual monthly payments will vary. Not all lessees may qualify; higher lease rates apply for lessees with lower credit ratings.`),i},[le.h]:()=>"Except as otherwise expressly provided, excludes sales tax, title, registration and other fees. Actual monthly payments will vary. Does not represent a financing offer or guarantee of credit."};function dt(e){let t=e.noPadding,a=e.footnoteSymbol,s=e.size,i=e.openedForm,n=e.leasePromiseEndDate,r=e.isTaxesAndFeesAvailable,o=e.payments;const l=o.totalLeaseCost,c=o.dueAtSigning,d=o.securityDeposit,p=void 0===d?0:d;return E.a.createElement("p",{className:N()("text-gray pt-0_5",s,{"px-1":!t})},a&&E.a.createElement("sup",{className:N()(s)},a," "),function(e){let t=e.openedForm,a=e.totalLeaseCost,s=e.dueAtSigning,i=e.securityDeposit,n=e.leasePromiseEndDate,r=e.isTaxesIncluded,o=e.useExtendedText;const l=n?ot()(new Date(n),"m/d/yyyy"):"";return o?`${ct[t](a,s,i,r)}${l&&` Payment estimate based on lease programs in effect through ${l}.`}`:`${lt[t]}${l&&` Payment estimate based on programs through ${l}.`}`}({openedForm:i,totalLeaseCost:l,dueAtSigning:c,securityDeposit:p,leasePromiseEndDate:n,useExtendedText:r}))}dt.propTypes={noPadding:v.a.bool,leasePromiseEndDate:v.a.number,openedForm:v.a.string,footnoteSymbol:v.a.string,size:v.a.string,isTaxesAndFeesAvailable:v.a.bool,payments:v.a.shape({totalLeaseCost:v.a.number,dueAtSigning:v.a.number,securityDeposit:v.a.number})},dt.defaultProps={noPadding:!1,leasePromiseEndDate:null,openedForm:"",footnoteSymbol:"*",size:"disclaimer",isTaxesAndFeesAvailable:!0,payments:{}};var pt=a("./site-modules/shared/components/report-smth-wrong-link/report-smth-wrong-link.jsx"),mt=a("./site-modules/shared/utils/string.js"),ut=a("../node_modules/reactstrap/lib/Button.js"),ht=a.n(ut);function gt(e){let t=e.appraisalMMYLabel,a=e.onClick;return E.a.createElement(ht.a,{onClick:a,color:"link",className:"d-inline-block medium text-primary-darker form-link p-0","data-tracking-id":"select_appraise","data-test":"what-is-my-car-worth"},Object(K.h)(t))}gt.propTypes={appraisalMMYLabel:v.a.string,onClick:v.a.func.isRequired},gt.defaultProps={appraisalMMYLabel:""};var ft=a("./site-modules/shared/components/car-buying/trade-in/trade-in-popover.jsx");a("./site-modules/shared/components/calculator/loan-calculator-form/loan-calculator-form.scss");const bt=["numberOfMonths","downPayment","tradeIn","monthlyWithTaxes","totalTaxesAndFees","taxes","fees","customVehiclePrice"];class Et extends b.Component{constructor(){var e;e=super(...arguments),this.state={tradeInValidationErrorMsg:"",appliedTradeInMessage:"",tradeInValue:0,amountLimit:0,appliedTradeIn:0},this.isTradeInUpdated=!1,this.handleInputChange=(async e=>{const t=this.props.useBestPaymentService,a=Object(X.a)(e),s=a.value,i=a.name;let n={};if(t||i!==le.d||(n={[le.o]:null}),i===le.yb){this.isTradeInUpdated=!0;const e=await this.calculateLimits(s);this.handleUpdateTradeIn(e,s,!0)}else this.props.onChange({value:s,name:i,additionalValue:n})}),this.calculateLimits=(e=>{const t=this.props,a=t.vehiclePrice,s=t.isUsed,i=t.styleId,n=t.taxesAndFeesZipCode,r=t.pageName,o=t.venomVersion,l=t.msrp;return Object(K.a)({msrp:l,salesPrice:a,isPurchase:!0,isUsed:s,styleId:i,zipCode:n,tradeIn:e,pageName:r,venomVersion:o})}),this.handleUpdateTradeIn=function(t,a){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=e.props.isUsed?Re.a.USED:Re.a.NEW,n=Object(K.i)(m()(t,"limitCriteria",{}),i).tradeInValidationError,r=Object(K.d)(t,le.ab)||a,o=a<0?le.fb:"";s?e.setState({tradeInValue:a,amountLimit:r,tradeInValidationErrorMsg:n?`${n} ${o}`:""},()=>{e.isTradeInUpdated=!1,n||(e.updateAppliedTradeIn(),e.props.onChange({value:a,name:le.yb}))}):e.setState({tradeInValue:a,tradeInValidationErrorMsg:"",appliedTradeIn:r,appliedTradeInMessage:`${n} ${o}`},()=>{e.isTradeInUpdated=!1})},this.handleApplyTradeIn=(()=>{const e=this.state,t=e.tradeInValue,a=e.amountLimit,s=e.tradeInValidationErrorMsg;this.setState({tradeInValidationErrorMsg:"",appliedTradeIn:a,appliedTradeInMessage:s}),this.props.onChange({value:t,name:le.yb})}),this.updateAppliedTradeIn=(()=>{const e=this.state.amountLimit;this.setState({appliedTradeIn:e,appliedTradeInMessage:e<0?le.fb:""})}),this.handleKeyPress=(e=>{Object(X.b)(e)&&e.currentTarget.blur()}),this.handleCreditScoreChange=(e=>{const t=m()(e,"currentTarget.value",le.l);this.props.onCreditScoreChange&&this.props.onCreditScoreChange(oe.d.CHECKBOX);const a={value:le.q[t].value,name:le.o,additionalValue:{[le.d]:null}};this.props.onChange(a)}),this.handleCreditScoreEnterPress=(e=>{Object(X.b)(e)&&this.handleCreditScoreChange(e)})}shouldComponentUpdate(e,t){const a=this.props,s=a.payments,i=a.limitMessages,n=a.appliedIncentives,r=a.taxesAndFeesZipCode,o=a.baseCreditScore,l=a.useBestPaymentService,c=a.internalDrawerConfig,d=this.state,p=d.tradeInValue,m=d.tradeInValidationErrorMsg,u=l?bt:[...bt,"apr"],h=B()(e.payments,u),g=B()(s,u);return!(Y()(h,g)&&Y()(e.limitMessages,i)&&Y()(e.appliedIncentives,n)&&Y()(e.internalDrawerConfig,c)&&e.taxesAndFeesZipCode===r&&e.baseCreditScore===o&&t.tradeInValue===p&&t.tradeInValidationErrorMsg===m)}async componentDidUpdate(){const e=this.props.payments,t=this.state.tradeInValue,a=m()(e,le.yb);if(a!==t&&!this.isTradeInUpdated){this.isTradeInUpdated=!0;const e=this.calculateLimits(a);this.handleUpdateTradeIn(e,a)}return null}render(){const e=this.props,t=e.vehicle,a=e.vehiclePrice,i=e.payments,n=e.onTradeInClick,r=e.limitMessages,o=e.appliedIncentives,l=e.taxesAndFeesZipCode,c=e.setZipToStorage,d=e.styleId,p=e.isNonTMVDealer,m=e.baseCreditScore,u=e.appraisalMMYLabel,h=e.limitCriteria,g=e.useBestPaymentService,f=e.appliedPrimayLoanIncentives,b=e.onChange,y=e.drawerOffer,v=e.internalDrawerConfig,C=e.vehiclePriceProps,S=e.paymentInputProps,T=e.radioGroupProps,I=e.hideTaxesFeesSection,_=this.state,N=_.tradeInValidationErrorMsg,O=_.appliedTradeIn,P=_.appliedTradeInMessage,A=i.apr,x=i.numberOfMonths,k=i.downPayment,V=i.tradeIn,w=i.type,j=i.vin,R=i.customVehiclePrice,M=p?[]:o,D=Object(K.g)({payments:i,taxesAndFeesZipCode:l,calculatorType:le.h,type:w,incentives:M,creditTier:le.k.find(e=>e.name===m)||{name:m}});return E.a.createElement(Pe.a,{className:"loan-calculator-form p-0_75",id:"loan-calc",noValidate:!0},E.a.createElement(xe.a,{className:"mb-1_5"},E.a.createElement(je.a,Object(s.a)({vin:j,vehicle:t,price:a,vehicleType:w,calculatorType:le.h,appliedIncentives:M,isNonTMVDealer:p,payments:i,tradeIn:O,limitCriteria:h,appliedPrimayLoanIncentives:f,useBestPaymentPrimaryIncentives:g,onChange:b,customVehiclePrice:R,drawerOffer:y,internalDrawerConfig:v,paymentInputProps:S},C))),E.a.createElement(xe.a,{className:"mb-1_5"},E.a.createElement(Ve.a,Object(s.a)({trackingId:"select_loan_payment_term",onKeyPress:this.handleKeyPress,onClick:this.handleInputChange,values:le.bb,name:le.eb,title:le.cb.TERM_TITLE,selected:x,selectedValuePostfix:"months"},T))),E.a.createElement(xe.a,{className:"mb-1_5 pos-r trade-in-input"},E.a.createElement(ke.a,Object(s.a)({name:"tradeIn",label:le.cb.TRADE_IN_TITLE,appraisalMMYLabel:u,trackingId:"select_trade_in_value",key:V,value:Object(mt.c)(V),tooltip:le.wb.TRADE_IN,onKeyPress:this.handleKeyPress,onBlur:this.handleInputChange,paymentInputClassNames:N?"is-invalid":"",inputMode:null,isCurrency:!0,inputType:""},S),E.a.createElement(gt,{appraisalMMYLabel:u,onClick:n})),N&&E.a.createElement(ft.a,{tradeInValidationError:N,onApplyTradeIn:this.handleApplyTradeIn,calculator:le.i})),E.a.createElement(xe.a,{className:"mb-1_25"},E.a.createElement(ke.a,Object(s.a)({name:"downPayment",label:le.cb.DOWN_PAYMENT_TITLE,trackingId:"select_loan_down_payment",key:k,value:Object(mt.c)(k),tooltip:le.wb.DOWN_PAYMENT,onKeyPress:this.handleKeyPress,onBlur:this.handleInputChange,limitMessage:r[le.Z],isCurrency:!0,disallowNegative:!0,inputType:""},S))),E.a.createElement(xe.a,{className:"mb-1_5"},E.a.createElement(we.a,{onClick:this.handleCreditScoreChange,onKeyPress:this.handleCreditScoreEnterPress,id:"creditScore",titleClasses:"mr-0_25",title:le.cb.CREDIT_SCORE_TITLE,tooltip:le.wb.CREDIT_SCORE,selected:m,values:le.k})),!g&&E.a.createElement(xe.a,{className:"mb-0_75"},E.a.createElement(ke.a,Object(s.a)({name:le.d,label:le.cb.ANNUAL_RATE_TITLE,trackingId:"select_apr",key:A,value:A,isPercentage:!0,tooltip:le.wb.APR,onKeyPress:this.handleKeyPress,onBlur:this.handleInputChange},S))),!I&&E.a.createElement(xe.a,{className:"mb-0_75"},E.a.createElement(nt,{calculatorType:le.h,payments:i,taxesAndFeesZipCode:l,setZipToStorage:c,appliedTradeIn:O,tradeInValidationErrorMsg:P})),E.a.createElement(dt,{openedForm:le.h,isTaxesAndFeesAvailable:!!d,noPadding:!0}),E.a.createElement(pt.a,{paramsData:D,linkClassName:"align-middle text-decoration-none-hover text-primary-darker",iconClassName:"icon-notification2 mr-0_5 text-gray-darker",trackingId:"payment_feedback",trackingValue:"payment feedback",title:"Payment feedback",form:"payment-feedback"}))}}Et.propTypes={vehiclePrice:v.a.number.isRequired,vehicle:A.b.InventoryVin,payments:v.a.shape({apr:v.a.oneOfType([v.a.number,v.a.string]),numberOfMonths:v.a.oneOfType([v.a.number,v.a.string]),tradeIn:v.a.oneOfType([v.a.number,v.a.string]),downPayment:v.a.oneOfType([v.a.number,v.a.string]),type:v.a.string,monthly:v.a.number,monthlyWithTaxes:v.a.number,totalTaxesAndFees:v.a.number,taxes:v.a.objectOf(v.a.number),fees:v.a.objectOf(v.a.oneOfType([v.a.arrayOf(v.a.object),v.a.number])),customVehiclePrice:v.a.oneOfType([v.a.number,v.a.string])}),onChange:v.a.func,onCreditScoreChange:v.a.func,baseCreditScore:v.a.string,onTradeInClick:v.a.func,limitMessages:v.a.shape({}),appliedIncentives:v.a.arrayOf(v.a.oneOfType([P.b.Incentive,A.b.Incentive])),taxesAndFeesZipCode:v.a.string,setZipToStorage:v.a.func,styleId:v.a.string,isNonTMVDealer:v.a.bool,appraisalMMYLabel:v.a.string,limitCriteria:v.a.shape({}),useBestPaymentService:v.a.bool,appliedPrimayLoanIncentives:v.a.arrayOf(v.a.shape({id:v.a.number})),isUsed:v.a.bool,venomVersion:v.a.string,pageName:v.a.string,drawerOffer:pe.a,internalDrawerConfig:v.a.shape({onToggle:v.a.func,portalSelector:v.a.string,openedDrawer:v.a.string}),vehiclePriceProps:v.a.shape({customLabel:v.a.string,customTooltip:v.a.func,hideDescription:v.a.bool,isReadOnly:v.a.bool}),paymentInputProps:v.a.shape({}),radioGroupProps:v.a.shape({}),hideTaxesFeesSection:v.a.bool},Et.defaultProps={payments:{},vehicle:{},onChange:null,onCreditScoreChange:null,baseCreditScore:"",onTradeInClick:null,limitMessages:{},taxesAndFeesZipCode:"",setZipToStorage:null,appliedIncentives:[],styleId:null,isNonTMVDealer:!1,appraisalMMYLabel:"",limitCriteria:{},useBestPaymentService:!1,appliedPrimayLoanIncentives:[],isUsed:!1,venomVersion:"",pageName:"",drawerOffer:null,internalDrawerConfig:null,vehiclePriceProps:null,paymentInputProps:null,radioGroupProps:null,hideTaxesFeesSection:!1};var yt=a("../node_modules/lodash/xorWith.js"),vt=a.n(yt),Ct=a("../node_modules/lodash/result.js"),St=a.n(Ct),Tt=a("./site-modules/shared/utils/inventory/price-analysis.js"),It=a("./site-modules/shared/utils/car-buying/monthly-payment-calculator-call.js"),_t=a("./site-modules/shared/utils/car-buying/incentives-service.js"),Nt=a("./data/models/visitor.js");const Ot=["numberOfMonths","annualMileage"];class Pt extends b.Component{constructor(e){super(e),this.getSharedSelections=(()=>{const e=this.props.payments,t=l()(e.tradeIn)?e.tradeIn:this.tradeInFromStorage,a=l()(t)?t:le.I,s=l()(e.downPayment)?e.downPayment:this.downPaymentFromStorage;return{tradeIn:a,downPayment:l()(s)?s:le.A,customVehiclePrice:l()(e.customVehiclePrice)?e.customVehiclePrice:""}}),this.getLeaseOffers=(async()=>{const e=this.props,t=e.dealerMapping,a=e.vehicle,s=e.pageName,i=e.venomVersion,n=e.visitorId,r=e.setModelValue,o=e.storedIncentives;if(t)try{const e=a.dealerInfo.address.zip,t=a.vehicleInfo.styleInfo.styleId,l=a.vin;if(!t)return void this.showError("styleId is missing",!1);const c=m()(o,"lease",[]);let d=c?c.filter(e=>{let t=e.conditionCategory;return t&&0!==t.length}):[];const p=m()(o,"primaryLease",[]);let u=c;if(this.isInitialLoading){u=await Object(_t.a)({styleId:t,zip:e,vin:l},{visitorId:n,pageName:s,venomVersion:i});const a=m()(u,"incentives",[]),o=a?a.filter(e=>!e.conditionCategory):[],p=a?a.filter(e=>e.conditionCategory):[],h=c?[...o,...d]:[...o];r(re.b.SELECTED_PRIMARY_LEASE_INCENTIVES({vin:l}),re.a,{vin:l,incentives:o}),r(re.b.CONDITIONAL_LEASE_INCENTIVES({vin:l}),re.a,{vin:l,incentives:p}),this.leaseOffers=await this.getOffers(h)}else d=u?u.filter(e=>{let t=e.conditionCategory;return t&&0!==t.length}):[],this.leaseOffers=await this.getOffers([...p,...d]),this.calculateOffer();if(!this.leaseOffers)return;this.defaultLeaseOffer=Object(It.e)(this.leaseOffers),this.config=Object(te.d)(this.leaseOffers,{isPurchase:!1})}catch(e){this.showError(e,!0)}}),this.setZip=(e=>(this.setState(()=>({customZipCode:e})),this.props.setZip(e))),this.getPayments=(async()=>{const e=this.props,t=e.vehicle,a=e.pageName,s=e.venomVersion,n=e.visitorId,r=e.isNonTMVDealer,o=e.storedIncentives,l=this.state.customZipCode,c=this.getSharedSelections(),d=c.downPayment,p=c.tradeIn,m=c.customVehiclePrice,u={digitalRetailOffers:this.leaseOffers,selectedMileage:this.getSelectedAnnualMileage(),selectedTerm:this.getSelectedNumberOfMonth(),selectedDownPayment:d,selectedTradeIn:p,vehicle:t,zipCode:l,incentives:o},h=await Promise.all([Object(It.h)(Object(i.a)({},u,{customVehiclePrice:m}),{visitorId:n,pageName:a,venomVersion:s,isPurchase:!1,isNonTMVDealer:r})||{},Object(It.h)(Object(i.a)({},u),{visitorId:n,pageName:a,venomVersion:s,isPurchase:!1,isNonTMVDealer:r})||{}]),g=Object(w.a)(h,2);return[g[0],g[1]]}),this.isInitialLoading=!0,this.calculateOffer=(async e=>{const t=this.props,a=t.vehicle,s=t.onSelectionUpdate,n=t.onMonthlyPaymentUpdate,r=t.pageName,o=t.venomVersion,l=t.visitorId,c=t.isNonTMVDealer,d=t.storedIncentives,p=t.setModelValue,u=t.vin,h=t.usePaymentWithTaxesAndFeesForTabs,g=this.state.customZipCode;if(this.leaseOffers){s({lease:{}});try{const t=this.getSharedSelections(),f=t.downPayment,b=t.tradeIn,E=t.customVehiclePrice,y=E?await this.getPayments():await Object(It.h)({digitalRetailOffers:this.leaseOffers,selectedMileage:this.getSelectedAnnualMileage(),selectedTerm:this.getSelectedNumberOfMonth(),selectedDownPayment:f,selectedTradeIn:b,vehicle:a,zipCode:g,incentives:d},{visitorId:l,pageName:r,venomVersion:o,isPurchase:!1,isNonTMVDealer:c})||{},v=Object(K.f)(y);this.setEligibleConditionalIncentives(v);const C=m()(a,"prices"),S=C.tmv,T=C.displayPrice,I=v.paymentWithoutTaxes.baseMonthlyPayment,_=v.paymentWithTaxes.monthlyPayment,N=v.dueAtSigning,O=v.securityDeposit,P=v.term,A=v.annualMileage,x=v.priceCost,k=v.incentives,w=v.limitCriteria,j=Object(V.a)(v,["paymentWithoutTaxes","paymentWithTaxes","dueAtSigning","securityDeposit","term","annualMileage","priceCost","incentives","limitCriteria"]);this.isInitialLoading&&(p(re.b.SELECTED_LEASE_INCENTIVES({vin:u}),re.a,{vin:u,incentives:k}),this.setState({checkedLeaseIncentives:k})),await p(re.b.TOTAL_MONTHLY_PAYMENT({vin:u}),re.a,_);const R=m()(v,"paymentWithTaxes.capitalizedFees",{}),M=m()(v,"paymentWithTaxes.capitalizedTaxes",{}),D=R.combinedFees,L=M.combinedSalesTax,F=S||T,U=this.state.limitCriteria,q=m()(a,"type");this.limitMessages=Object(X.c)(w,q),Object(K.k)({cur:{limitCriteria:w},prev:{limitCriteria:U}},[le.ab,le.Z],le.g);const z=Object(K.f)(y,!0),B=Object(i.a)({},z,{updatedDate:Date.now(),isPurchase:!1});this.setState({type:q,price:F,numberOfMonths:P,annualMileage:A,downPaymentDetails:{monthly:_,dueAtSigning:N,securityDeposit:O},monthly:I,dueAtSigning:N,securityDeposit:O,taxes:Object(i.a)({},M,{totalTaxes:L}),fees:Object(i.a)({},R,{totalFees:D}),totalTaxesAndFees:D+L,monthlyWithTaxes:_,totalLeaseCost:_*(P-1)+N,netCapCost:x,appliedLeaseIncentives:k||[],calculatedOffer:B},()=>this.fireCalculatorPaymentsChangeEvent(Object(i.a)({},j,{downPayment:f,tradeIn:b}),w)),n(h?_:I,"lease"),s({lease:{term:this.getSelectedNumberOfMonth(),downPayment:f,annualMileage:this.getSelectedAnnualMileage(),tradeIn:b,monthlyPayment:I,calculatedOffer:B,creditScore:this.state.creditScore,customVehiclePrice:E||"",widgetMonthlyPayment:m()(z,"paymentWithoutTaxes.baseMonthlyPayment"),storedSelections:this.storage.get(ce.y.LEASE_PREFERENCES)||{}}}),St()(s,"flush")}catch(t){this.showError(t,e)}}}),this.limitMessages={},this.showError=((e,t)=>{const a=this.props,s=a.onSelectionUpdate;(0,a.onMonthlyPaymentUpdate)(le.db,"lease"),s({lease:{term:null,downPayment:null,annualMileage:null,tradeIn:null,monthlyPayment:null,creditScore:null,calculatedOffer:null,widgetMonthlyPayment:null,storedSelections:null}}),"boolean"==typeof t&&t&&Object(G.a)("error",`Get lease payments error - ${"string"==typeof e?e:e.message}`)}),this.fireCalculatorPaymentsChangeEvent=((e,t)=>{const a=this.props,s=a.payments.vin,n=a.creativeId,r=this.state,o=r.appliedLeaseIncentives,l=r.creditScore;Z.a.fireCustomEvent(de.a.CALCULATE_PAYMENT,{vin:s,type:le.g,creativeId:n,payments:Object(i.a)({creditScore:l,term:this.getSelectedNumberOfMonth(),primaryIncentiveAmount:Object(Tt.e)(o),annualMileage:this.getSelectedAnnualMileage()},e),limitCriteria:t})}),this.changeState=(e=>{let t=e.value,a=e.name;const s=this.props.updateGetThisDealBtn;if(this.state[a]===t)return null;if(a===le.t&&(t?this.resetAppliedIncentives(t):s(!1)),!Object(K.j)(a)){const e={[a]:t};return this.setState(()=>Object(i.a)({},e),()=>{(0,this.props.clearMMYFromStorage)(),this.storage.set(ce.y.LEASE_PREFERENCES,Object(i.a)({},this.storage.get(ce.y.LEASE_PREFERENCES),e,{isUsed:!1})),Ot.includes(a)&&this.calculateOffer()})}return this.props.onSharedInputUpdate(a,t,le.h),null}),this.resetAppliedIncentives=(()=>{const e=this.props,t=e.vin,a=e.setModelValue,s=e.selectedLeaseIncentives,i=e.selectedLoanIncentives,n=e.updateGetThisDealBtn;if(i){const e=i.filter(e=>{return e.primary})||[];a(re.b.SELECTED_LOAN_INCENTIVES({vin:t}),re.a,{vin:t,incentives:e})}if(s){const e=s.filter(e=>{return!e.conditionCategory})||[];a(re.b.SELECTED_LEASE_INCENTIVES({vin:t}),re.a,{vin:t,incentives:e})}a(re.b.RESET_CUSTOM_VEHICLE_PRICE({vin:t}),re.a,!1),n(!0)}),this.config={termsMapping:{},mileagesMapping:{}},this.storage=new W.a("localStorage");const t=!this.props.useDefaults&&this.storage.get(ce.y.LEASE_PREFERENCES)||{},a=t.tradeIn,s=t.downPayment,n=t.creditScore,r=t.annualMileage,o=t.numberOfMonths;this.tradeInFromStorage=a,this.downPaymentFromStorage=s,this.state={price:null,downPaymentDetails:null,monthly:null,taxes:null,fees:null,totalTaxesAndFees:null,monthlyWithTaxes:null,dueAtSigning:null,totalLeaseCost:null,customZipCode:e.zipCode,limitCriteria:{},checkedLeaseIncentives:[],creditScore:n&&n>le.q[le.p].max?n:le.q[le.l].leaseValue,annualMileage:r||null,numberOfMonths:o||null}}async componentDidMount(){return this.props.vehicle&&this.props.dealerMapping?(this.leaseOffers||await this.getLeaseOffers(),this.calculateOffer(!0)):null}async componentDidUpdate(e,t){const a=this.props,s=a.resetCustomVehiclePrice,i=a.updateGetThisDealBtn,n=a.onSharedInputUpdate,r=m()(e.vehicle,"vin")&&m()(this.props.vehicle,"vin")!==m()(e.vehicle,"vin"),o=t.creditScore!==this.state.creditScore;if((r||o)&&(this.leaseOffers=null),!e.vehicle&&this.props.vehicle||!e.dealerMapping&&this.props.dealerMapping||!t.customZipCode&&this.state.customZipCode||t.customZipCode!==this.state.customZipCode||!Y()(e.styleLeaseTerms,this.props.styleLeaseTerms)||r||o)return this.leaseOffers||await this.getLeaseOffers(),this.calculateOffer(!0);const l=m()(e,"selectedLeaseIncentives"),c=!De()(vt()(this.props.selectedLeaseIncentives,l,Y.a));return e.resetCustomVehiclePrice!==s&&s&&(i(!1),n(le.t,"")),c&&(this.isInitialLoading?(this.isInitialLoading=!1,De()(vt()(this.props.selectedLeaseIncentives,this.state.checkedLeaseIncentives,Y.a))||this.getLeaseOffers()):this.getLeaseOffers()),le.tb.some(t=>e.payments[t]!==this.props.payments[t])?this.calculateOffer():null}async getOffers(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const t=this.props,a=t.dealerMapping,s=t.vehicle,n=t.pageName,r=t.venomVersion,o=t.visitorId,l=t.styleLeaseTerms,c=t.payments.customSellingPrice,d=s.dealerInfo.address.zip,p=s.vehicleInfo,u=p.styleInfo.styleId,h=p.mileage,g=s.vin,f=l?{annualMileage:l}:null,b=g===A.d?f:await Object(me.b)({creditScore:this.state.creditScore,isLeaseLiteEnabled:!!m()(a,"leaseLite"),styleId:u,vin:g,zipCode:d,mileage:h,filteredIncentives:e},{visitorId:o,pageName:n,venomVersion:r,isPurchase:!1});return b&&c&&(b.annualMileage=Object.entries(b.annualMileage).reduce((e,t)=>{let a=Object(w.a)(t,2),s=a[0],n=a[1];return e[s]=n.map(e=>Object(i.a)({},e,{sellingPrice:c})),e},{})),b}getSelectedAnnualMileage(){return Number(this.config.mileagesMapping[this.state.numberOfMonths]?this.state.annualMileage:this.defaultLeaseOffer.annualMileage)}getSelectedNumberOfMonth(){return Number(this.config.termsMapping[this.state.annualMileage]?this.state.numberOfMonths:this.defaultLeaseOffer.term)}setEligibleConditionalIncentives(e){const t=this.props,a=t.storedConditionalLeaseIncentives,s=t.setModelValue,i=t.vin,n=m()(e,"incentives",[]),r=n?n.filter(e=>!e.conditionCategory):[],o=a?a.filter(e=>!Object(te.p)(r,e,!0)):[];s(re.b.CONDITIONAL_LEASE_INCENTIVES_ELIGIBLE({vin:i}),re.a,{vin:i,incentives:o})}render(){const e=this.state,t=e.numberOfMonths,a=e.annualMileage,s=e.customZipCode,n=e.appliedLeaseIncentives,r=this.getSharedSelections(),o=r.tradeIn,l=r.downPayment,c=r.customVehiclePrice,d=this.state,p=d.creditScore,m=Object(V.a)(d,["creditScore"]);return E.a.createElement("div",null,E.a.cloneElement(this.props.children,{payments:Object(i.a)({},m,{tradeIn:o,downPayment:l,customVehiclePrice:c}),onChange:this.changeState,enabledTerms:this.config.termsMapping[a],enabledMileages:this.config.mileagesMapping[t],appliedLeaseIncentives:n,creditScore:Object(K.e)(p),setZipToStorage:this.setZip,taxesAndFeesZipCode:s,limitMessages:this.limitMessages}))}}Pt.propTypes={setModelValue:v.a.func.isRequired,children:v.a.node.isRequired,dealerMapping:pe.f,onSharedInputUpdate:v.a.func,payments:v.a.shape({downPayment:v.a.oneOfType([v.a.string,v.a.number]),tradeIn:v.a.oneOfType([v.a.string,v.a.number]),customVehiclePrice:v.a.oneOfType([v.a.string,v.a.number])}).isRequired,creativeId:v.a.string.isRequired,onMonthlyPaymentUpdate:v.a.func,onSelectionUpdate:v.a.func,vehicle:A.b.InventoryVin,zipCode:v.a.string.isRequired,setZip:v.a.func,isNonTMVDealer:v.a.bool,clearMMYFromStorage:v.a.func,storedIncentives:v.a.shape({}),vin:v.a.string.isRequired,selectedLeaseIncentives:v.a.arrayOf(pe.j),selectedLoanIncentives:v.a.arrayOf(pe.j),storedConditionalLeaseIncentives:v.a.arrayOf(pe.j),updateGetThisDealBtn:v.a.func,resetCustomVehiclePrice:v.a.bool,styleLeaseTerms:v.a.objectOf(v.a.arrayOf(pe.h)),usePaymentWithTaxesAndFeesForTabs:v.a.bool,useDefaults:v.a.bool},Pt.defaultProps={vehicle:null,onMonthlyPaymentUpdate:r.a,onSharedInputUpdate:r.a,onSelectionUpdate:r.a,dealerMapping:null,setZip:r.a,isNonTMVDealer:!1,clearMMYFromStorage:r.a,storedIncentives:{},selectedLeaseIncentives:[],selectedLoanIncentives:[],storedConditionalLeaseIncentives:[],updateGetThisDealBtn:null,resetCustomVehiclePrice:!1,styleLeaseTerms:null,usePaymentWithTaxesAndFeesForTabs:!1,useDefaults:!1};const At={zipCode:Object(se.a)(re.b.STORED_ZIP_CODE,Nt.c),visitorId:Object(se.a)("id",Nt.c),pageName:Object(se.a)("page.name",ne.a),venomVersion:Object(se.a)("version",ie.a),storedIncentives:Object(se.a)(re.b.SELECTED_INCENTIVES,re.a),storedConditionalLeaseIncentives:Object(se.a)(re.b.CONDITIONAL_LEASE_INCENTIVES,re.a),selectedLeaseIncentives:Object(se.a)(re.b.SELECTED_LEASE_INCENTIVES,re.a),selectedLoanIncentives:Object(se.a)(re.b.SELECTED_LOAN_INCENTIVES,re.a),resetCustomVehiclePrice:Object(se.a)(e=>{let t=e.vin;return t?re.b.RESET_CUSTOM_VEHICLE_PRICE({vin:t}):null},re.a),styleLeaseTerms:Object(se.a)(e=>{let t=e.vin,a=e.vehicle;return t===A.d&&re.b.STYLE_LEASE_TERMS({styleId:m()(a,"vehicleInfo.styleInfo.styleId","")})},re.a),dealerMapping:Object(se.a)(e=>{let t=e.vin,a=e.vehicle;return t&&a&&re.b.DEALER_MAPPING({vin:t,id:m()(a,"dealerInfo.franchiseId")})},re.a)},xt=Object(se.b)(Pt,At);a("./site-modules/shared/components/calculator/lease-calculator-form/lease-calculator-form.scss");const kt=["annualMileage","numberOfMonths","downPayment","tradeIn","monthly","monthlyWithTaxes","totalTaxesAndFees","taxes","fees","totalLeaseCost","dueAtSigning","netCapCost","downPaymentDetails","customVehiclePrice"],Vt=[{label:"First Month's Payment w/ Taxes and Fees",value:"monthly",sign:"+"},{label:"Security Deposit",value:"securityDeposit",sign:"+"},{label:"Total Due At Signing",value:"dueAtSigning",sign:"="}];class wt extends b.Component{constructor(){var e;e=super(...arguments),this.state={tradeInValidationErrorMsg:"",appliedTradeInMessage:"",tradeInValue:0,amountLimit:0,appliedTradeIn:0},this.isTradeInUpdated=!1,this.handleInputChange=(async e=>{const t=Object(X.a)(e),a=t.value,s=t.name;if(s===le.yb){this.isTradeInUpdated=!0;const e=await this.calculateLimits(a);this.handleUpdateTradeIn(e,a,!0)}else this.props.onChange({value:a,name:s})}),this.calculateLimits=(e=>{const t=this.props,a=t.msrp,s=t.taxesAndFeesZipCode,i=t.styleId,n=t.pageName,r=t.venomVersion,o=t.vehiclePrice,l=t.residual;return Object(K.a)({msrp:a,salesPrice:o,residual:l,styleId:i,zipCode:s,tradeIn:e,pageName:n,venomVersion:r})}),this.handleUpdateTradeIn=function(t,a){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=Object(K.i)(m()(t,"limitCriteria",{}),Re.a.NEW).tradeInValidationError,n=Object(K.d)(t,le.ab)||a,r=a<0?le.fb:"";s?e.setState({tradeInValue:a,amountLimit:n,tradeInValidationErrorMsg:i?`${i} ${r}`:""},()=>{e.isTradeInUpdated=!1,i||(e.updateAppliedTradeIn(),e.props.onChange({value:a,name:le.yb}))}):e.setState({tradeInValue:a,tradeInValidationErrorMsg:"",appliedTradeIn:n,appliedTradeInMessage:`${i} ${r}`},()=>{e.isTradeInUpdated=!1})},this.handleApplyTradeIn=(()=>{const e=this.state,t=e.tradeInValue,a=e.amountLimit,s=e.tradeInValidationErrorMsg;this.setState({tradeInValidationErrorMsg:"",appliedTradeIn:a,appliedTradeInMessage:s}),this.props.onChange({value:t,name:le.yb})}),this.updateAppliedTradeIn=(()=>{const e=this.state.amountLimit;this.setState({appliedTradeIn:e,appliedTradeInMessage:e<0?le.fb:""})}),this.handleKeyPress=(e=>{Object(X.b)(e)&&e.currentTarget.blur()}),this.handleCreditScoreChange=(e=>{const t=m()(e,"currentTarget.value",le.l),a={value:le.q[t].leaseValue,name:le.o};this.props.onChange(a)}),this.handleCreditScoreEnterPress=(e=>{Object(X.b)(e)&&this.handleCreditScoreChange(e)})}shouldComponentUpdate(e,t){const a=this.props,s=a.payments,i=a.limitMessages,n=a.appliedLeaseIncentives,r=a.taxesAndFeesZipCode,o=a.creditScore,l=a.internalDrawerConfig,c=this.state,d=c.tradeInValue,p=c.tradeInValidationErrorMsg,m=e.payments,u=e.limitMessages,h=e.appliedLeaseIncentives,g=e.taxesAndFeesZipCode,f=e.internalDrawerConfig,b=e.creditScore;return!(Y()(B()(m,kt),B()(s,kt))&&Y()(u,i)&&Y()(h,n)&&Y()(f,l)&&r===g&&b===o&&t.tradeInValue===d&&t.tradeInValidationErrorMsg===p)}async componentDidUpdate(){const e=this.props.payments,t=this.state.tradeInValue,a=m()(e,le.yb);if(a!==t&&!this.isTradeInUpdated){this.isTradeInUpdated=!0;const e=await this.calculateLimits(a);this.handleUpdateTradeIn(e,a)}return null}render(){const e=this.props,t=e.payments,a=e.vehiclePrice,n=e.onTradeInClick,r=e.enabledTerms,o=e.enabledMileages,l=e.creditScore,c=e.limitMessages,p=e.appliedLeaseIncentives,m=e.taxesAndFeesZipCode,u=e.setZipToStorage,h=e.styleId,g=e.leasePromiseEndDate,f=e.isNonTMVDealer,b=e.appraisalMMYLabel,y=e.vin,v=e.vehicle,C=e.onChange,S=e.internalDrawerConfig,T=e.vehiclePriceProps,I=e.paymentInputProps,_=e.radioGroupProps,N=e.hideTaxesFeesSection,O=this.state,P=O.tradeInValidationErrorMsg,A=O.appliedTradeIn,x=O.appliedTradeInMessage,k=t.numberOfMonths,V=t.downPayment,w=t.downPaymentDetails,j=t.tradeIn,R=t.annualMileage,M=t.monthly,D=t.type,L=t.calculatedOffer,F=t.customVehiclePrice,U=d()(M),q=f?[]:p,z=Object(K.g)({payments:t,taxesAndFeesZipCode:m,calculatorType:le.g,type:D,additionalTooltipContent:"",incentives:q,creditTier:le.k.find(e=>{return e.name===l})||{name:l}});return E.a.createElement(Pe.a,{className:"lease-calculator-form p-0_75",id:"lease-calc",noValidate:!0},U&&E.a.createElement("p",{className:"not-available-text"},"Please contact dealer for current lease programs and payment estimates."),!!a&&!U&&E.a.createElement(xe.a,{className:"mb-1_5"},E.a.createElement(je.a,Object(s.a)({vin:y,vehicle:v,internalDrawerConfig:S,price:a,calculatorType:le.g,appliedIncentives:q,additionalTooltipContent:"",isNonTMVDealer:f,calculatedOffer:L,onChange:C,customVehiclePrice:F,paymentInputProps:I},T))),E.a.createElement(xe.a,{className:"mb-1_5"},E.a.createElement(Ve.a,Object(s.a)({trackingId:"select_lease_payment_term",onClick:this.handleInputChange,onKeyPress:this.handleKeyPress,values:r||le.V,name:le.eb,title:le.X.TERM_TITLE,selected:d()(k)?0:k},_))),E.a.createElement(xe.a,{className:"mb-1_5"},E.a.createElement(Ve.a,Object(s.a)({trackingId:"select_mileage",onClick:this.handleInputChange,onKeyPress:this.handleKeyPress,values:o||le.U,name:"annualMileage",title:le.X.ANNUAL_MILES_TITLE,selected:d()(R)?0:R,tooltip:le.wb.ANNUAL_MILES,id:"leaseAnnualMileage"},_))),E.a.createElement(xe.a,{className:"mb-1_5 pos-r"},E.a.createElement(ke.a,Object(s.a)({name:le.Y,label:le.X.TRADE_IN_TITLE,appraisalMMYLabel:b,trackingId:"select_trade_in_value",key:j,value:d()(j)?0:Object(mt.c)(j),tooltip:le.wb.TRADE_IN,onKeyPress:this.handleKeyPress,onBlur:this.handleInputChange,inputMode:null,isCurrency:!0,paymentInputClassNames:P?"is-invalid":"",inputType:""},I),E.a.createElement(gt,{appraisalMMYLabel:b,onClick:n})),P&&E.a.createElement(ft.a,{tradeInValidationError:P,onApplyTradeIn:this.handleApplyTradeIn,calculator:le.i})),E.a.createElement(xe.a,{className:"mb-1_25"},E.a.createElement(ke.a,Object(s.a)({name:le.S,label:le.X.DOWN_PAYMENT_TITLE,trackingId:"select_lease_down_payment",key:V,value:d()(V)?0:Object(mt.c)(V),tooltip:le.wb.DOWN_PAYMENT,onKeyPress:this.handleKeyPress,onBlur:this.handleInputChange,limitMessage:c[le.Z],isCurrency:!0,disallowNegative:!0,inputType:""},I)),!De()(w)&&E.a.createElement("div",{className:"text-gray medium pl-0_75 pt-0_75"},Vt.map(e=>{const t=e.sign,a=e.value,s=e.label;return E.a.createElement("div",{key:s},t," ",Object(Ue.a)(w[a])," ",s)}))),E.a.createElement(xe.a,{className:"mb-0_5"},E.a.createElement(we.a,{id:"leaseCreditScore",title:le.X.CREDIT_SCORE_TITLE,tooltip:le.wb.CREDIT_SCORE,selected:l,values:[Object(i.a)({},le.k[0],{disabled:!0}),...le.k.slice(1)],onClick:this.handleCreditScoreChange,onKeyPress:this.handleCreditScoreEnterPress})),!U&&!N&&E.a.createElement(xe.a,{className:"mb-0_75"},E.a.createElement(nt,{calculatorType:le.g,payments:t,taxesAndFeesZipCode:m,setZipToStorage:u,appliedTradeIn:A,tradeInValidationErrorMsg:x})),E.a.createElement(dt,{openedForm:le.g,leasePromiseEndDate:g,isTaxesAndFeesAvailable:!!h&&!N,payments:t,noPadding:!0}),E.a.createElement(pt.a,{paramsData:z,linkClassName:"align-middle text-decoration-none-hover text-primary-darker",iconClassName:"icon-notification2 mr-0_5 text-gray-darker",trackingId:"payment_feedback",trackingValue:"payment feedback",title:"Payment feedback",form:"payment-feedback"}))}}wt.propTypes={vehiclePrice:v.a.number,vehicle:A.b.InventoryVin,payments:v.a.shape({numberOfMonths:v.a.oneOfType([v.a.number,v.a.string]),tradeIn:v.a.oneOfType([v.a.number,v.a.string]),downPayment:v.a.oneOfType([v.a.number,v.a.string]),downPaymentDetails:v.a.shape({monthly:v.a.oneOfType([v.a.number,v.a.string]),dueAtSigning:v.a.oneOfType([v.a.number,v.a.string]),securityDeposit:v.a.oneOfType([v.a.number,v.a.string])}),annualMileage:v.a.oneOfType([v.a.number,v.a.string]),calculatedOffer:pe.a,customVehiclePrice:v.a.oneOfType([v.a.number,v.a.string])}),onChange:v.a.func,onTradeInClick:v.a.func,enabledTerms:v.a.arrayOf(v.a.number),enabledMileages:v.a.arrayOf(v.a.number),creditScore:v.a.string,limitMessages:v.a.shape({}),appliedLeaseIncentives:v.a.arrayOf(v.a.oneOfType([P.b.Incentive,A.b.Incentive])),taxesAndFeesZipCode:v.a.string,setZipToStorage:v.a.func,styleId:v.a.string,leasePromiseEndDate:v.a.number,isNonTMVDealer:v.a.bool,appraisalMMYLabel:v.a.string,vin:v.a.string.isRequired,msrp:v.a.number,residual:v.a.number,venomVersion:v.a.string,pageName:v.a.string,paymentInputProps:v.a.shape({}),radioGroupProps:v.a.shape({}),hideTaxesFeesSection:v.a.bool,internalDrawerConfig:v.a.shape({onToggle:v.a.func,portalSelector:v.a.string,openedDrawer:v.a.string}),vehiclePriceProps:v.a.shape({customLabel:v.a.string,customTooltip:v.a.func,hideDescription:v.a.bool,isReadOnly:v.a.bool})},wt.defaultProps={payments:{},vehicle:{},onChange:null,vehiclePrice:null,onTradeInClick:null,enabledTerms:null,enabledMileages:null,limitMessages:{},creditScore:"",taxesAndFeesZipCode:"",setZipToStorage:null,appliedLeaseIncentives:[],leasePromiseEndDate:null,styleId:null,isNonTMVDealer:!1,appraisalMMYLabel:"",msrp:0,residual:0,venomVersion:"",pageName:"",internalDrawerConfig:null,vehiclePriceProps:null,paymentInputProps:null,radioGroupProps:null,hideTaxesFeesSection:!1};a("./site-modules/shared/components/calculator/toggle-button/toggle-button.scss");function jt(e){let t=e.activeClass,a=e.inactiveClass,s=e.trackingId,i=e.value,n=e.name,r=e.isOpen,o=e.onClick,l=e.type,c=e.initialLoading,d=e.creativeId,p=e.ignoreTabFocus;return E.a.createElement(ht.a,{"data-tracking-id":s,"data-tracking-value":i,"data-test-value":`Est. ${n}: $${Math.floor(i)}/mo*`,name:n,onClick:o,size:"responsive",className:N()("toggle-button px-1 w-100",n,{[t]:r,[`${a} inactive`]:!r}),tabIndex:p?-1:void 0},E.a.createElement("div",{className:"payments d-flex justify-content-center flex-column"},E.a.createElement("span",{className:"text-capitalize text-gray small"},"Est. ",n,":"),E.a.createElement("h3",{className:"payments-value heading-2 mb-0 text-lowercase"},E.a.createElement(Ze,{price:i,type:l,disclaimerSymbol:"*",monthsClasses:"small",priceClasses:"",initialLoading:c,creativeId:d,allowNegative:!0}))))}jt.propTypes={trackingId:v.a.string.isRequired,value:v.a.oneOfType([v.a.string,v.a.number]).isRequired,name:v.a.string.isRequired,isOpen:v.a.bool.isRequired,onClick:v.a.func.isRequired,type:v.a.string.isRequired,activeClass:v.a.string,inactiveClass:v.a.string,initialLoading:v.a.bool,ignoreTabFocus:v.a.bool,creativeId:v.a.string},jt.defaultProps={initialLoading:!1,ignoreTabFocus:!1,activeClass:"bg-gray-extra-light",inactiveClass:"bg-white",creativeId:""};var Rt=a("./site-modules/shared/components/appraisal/trade-in-appraiser/trade-in-appraiser-drawer.jsx"),Mt=a("./site-modules/shared/components/appraisal/trade-in-appraiser/trade-in-appraiser.jsx"),Dt=a("./data/models/dealer-info.js"),Lt=a("./tracking/handler.js"),Ft=a("./engagement-handlers/index.js"),Ut=a("./engagement-handlers/calculator-engagement-handler/calculator-engagement-handler.js"),qt=a("./site-modules/shared/components/portal/portal.jsx");a("./site-modules/shared/components/calculator/payment-calculator/payment-calculator.scss");a.d(t,"a",function(){return Yt});const zt="vdp-appraisal-drawer",Bt=700,$t=["make","model","year"];Ft.a.register(Ut.a);class Yt extends b.Component{constructor(e){var t;t=super(e),this.setWrapperRef=(e=>{this.wrapper=e}),this.setShouldRecalculateValue=(e=>{let t=e.shouldRecalculate,a=t.name,s=t.value;this.setState(e=>({shouldRecalculate:Object(i.a)({},e.shouldRecalculate,{[a]:s})}))}),this.setAppraisalMMYLabel=(()=>{const e=!this.props.useDefaults&&this.storage.get(ce.y.LOAN_PREFERENCES)||{},t=e.make,a=e.model,s=e.year,i=t&&a&&s?`Your ${s} ${t} ${a}`:"";this.setState(()=>({appraisalMMYLabel:i}))}),this.setCalculatorChangeObserverState=(()=>{const e=this.state.selection,t=this.props.openedForm,a=m()(e,`${t}.monthlyPayment`),s=this[`${t}ChangeObserver`].prevMonthlyPayment;d()(a)?this[`${t}ChangeObserver`]={isChangedByUser:!1,prevMonthlyPayment:1}:a&&a!==s&&(this[`${t}ChangeObserver`]={isChangedByUser:!!s,prevMonthlyPayment:a});const i=t===le.g?le.h:le.g,n=m()(e,`${i}.monthlyPayment`);!this[`${i}ChangeObserver`].prevMonthlyPayment&&n&&(this[`${i}ChangeObserver`].prevMonthlyPayment=n)}),this.clearMMYFromStorage=(()=>{const e=this.storage.get(ce.y.LOAN_PREFERENCES),t=this.storage.get(ce.y.LEASE_PREFERENCES);this.storage.set(ce.y.LOAN_PREFERENCES,h()(e,$t)),this.storage.set(ce.y.LEASE_PREFERENCES,h()(t,$t)),this.setState(()=>({appraisalMMYLabel:""}))}),this.firePrepopulateTradeInPixel=(()=>{const e=(this.storage.get(ce.y.LEASE_PREFERENCES)||{}).tradeIn;e&&e!==le.I&&Lt.a.fireEvent("prepopulate_trade_in_value",{event_data:{value:e,action_category:"system",action_cause:"page_load","creative-id":this.props.creativeId}})}),this.updateSelection=f()(e=>this.setState(t=>({selection:Object(i.a)({},t.selection,e)}),()=>{const e=this.props.onPaymentsUpdate;if(e&&"function"==typeof e){const t=this.state.selection,a=t.loan,s=t.lease;this.setCalculatorChangeObserverState(),e({loan:Object(i.a)({},a,{isChanged:this.loanChangeObserver.isChangedByUser}),lease:Object(i.a)({},s,{isChanged:this.leaseChangeObserver.isChangedByUser})})}}),Bt),this.updateSelectionValue=function(e,a,s,n){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const o=!s||s===le.g,c=!s||s===le.h,d={},p=m()(r,[le.c]),u=m()(r,[le.kb]);e===le.yb&&(d[le.c]=l()(p)?p:a),l()(u)&&(d[le.kb]=u),t.storage.set(ce.y.LOAN_PREFERENCES,Object(i.a)({},t.storage.get(ce.y.LOAN_PREFERENCES),d,{[e]:a,isUsed:!1})),t.storage.set(ce.y.LEASE_PREFERENCES,Object(i.a)({},t.storage.get(ce.y.LEASE_PREFERENCES),d,{[e]:a,isUsed:!1})),t.setState(t=>({selection:Object(i.a)({},t.selection,{[e]:a}),shouldRecalculate:{[le.g]:o,[le.h]:c}})),n?t.setAppraisalMMYLabel():t.clearMMYFromStorage()},this.toggleCalculators=(e=>{const t=e.currentTarget.getAttribute("name");if(this.props.openedForm!==t){const e=this.props.onCalculatorToggle;e&&"function"==typeof e&&e(t)}}),this.toggleAppraisalDrawer=(()=>{this.setState(e=>({isAppraisalDrawerOpen:!e.isAppraisalDrawerOpen}),()=>{const e=this.state.isAppraisalDrawerOpen,t=this.props.internalDrawerConfig;e&&Object(k.b)(x.b.ACTION_APPRAISE_VEHICLE,x.b.VIEW_APPRAISAL_FORM,this.props.creativeId,"action_start",!0,"What's my car worth?"),t&&t.onToggle(e?le.e.APPRAISER:le.e.CALCULATOR)})}),this.updateMonthlyPayment=((e,t)=>{this.setState(a=>({monthlyPayments:Object(i.a)({},a.monthlyPayments,{[t]:e}),initialLoading:Object(i.a)({},a.initialLoading,{[t]:!1})}))}),this.storage=new W.a("localStorage"),this.state={monthlyPayments:{[le.g]:0,[le.h]:0},initialLoading:{[le.g]:!0,[le.h]:!0},selection:{},isAppraisalDrawerOpen:!1,shouldRecalculate:{[le.g]:!1,[le.h]:!1},appraisalMMYLabel:""},this.loanChangeObserver={isChangedByUser:!1,prevMonthlyPayment:null},this.leaseChangeObserver={isChangedByUser:!1,prevMonthlyPayment:null}}componentDidMount(){this.setAppraisalMMYLabel(),this.firePrepopulateTradeInPixel()}componentDidUpdate(e){const t=this.props.internalDrawerConfig,a=this.state.isAppraisalDrawerOpen;Object(te.q)(e.internalDrawerConfig,t,a,le.e.APPRAISER)&&this.toggleAppraisalDrawer()}render(){const e=this.state,t=e.monthlyPayments,a=e.selection,n=e.isAppraisalDrawerOpen,r=e.appraisalMMYLabel,o=e.initialLoading,l=this.props,c=l.disclaimerSymbol,d=l.wrapperClasses,p=l.calculationClasses,u=l.toggleBtnGroupClasses,g=l.activeClass,f=l.inactiveClass,b=l.showTabs,y=l.payments,v=l.baseCreditScore,C=l.onCreditScoreChange,T=l.sellYourCarConfig,_=l.appliedIncentives,P=l.setZipToStorage,A=l.isLoanTaxesAndFeesEnabled,x=l.isNonTMVDealer,k=l.openedForm,V=l.unselectFinancingPromotions,w=l.baseTermMonths,j=l.baseAPR,R=l.vinData,M=l.useBestPaymentService,D=l.dealerZipCode,L=l.venomVersion,F=l.pageName,U=l.updateGetThisDealBtn,q=l.internalDrawerConfig,z=l.useDefaults,B=l.vehiclePriceProps,$=l.creativeId,Y=l.paymentInputProps,H=l.radioGroupProps,Z=l.hideTaxesFeesSection,G=l.usePaymentWithTaxesAndFeesForTabs,W=y.vin,Q=y.type,X=y.leasePrice,ee=y.price,te=y.taxesAndFeesZipCode,ae=y.styleId,se=y.leasePromiseEndDate,ie=y.tmv,ne=Object(K.b)(Q),re=-1!==ne.indexOf(le.h),oe=-1!==ne.indexOf(le.g),ce=re&&oe,de=k===le.h,pe=k===le.g,me=1===ne.length,ue=h()(a,["lease","loan"]),he=Object(i.a)({},y,{price:X},ue),ge=m()(R,"prices.displayPrice",0),fe=m()(a,"lease.calculatedOffer.residual"),be=!Object(J.a)(m()(R,"type")),Ee={onClick:this.toggleCalculators,disclaimerSymbol:c,activeClass:g,inactiveClass:f,ignoreTabFocus:me};return E.a.createElement(O.Element,{name:le.ib,className:N()("payment-calculator container",d),ref:this.setWrapperRef},b&&E.a.createElement(S.a,{className:u},re&&E.a.createElement(I.a,{xs:ce?"6":"12",className:"px-0"},E.a.createElement(jt,Object(s.a)({},Ee,{name:le.h,trackingId:de?"click_close_loan_calculator":"click_edit_loan_payment",value:t[le.h],isOpen:de,type:le.h,initialLoading:o[le.h]}))),oe&&E.a.createElement(I.a,{xs:ce?"6":"12",className:"px-0"},E.a.createElement(jt,Object(s.a)({},Ee,{name:le.g,trackingId:pe?"click_close_lease_calculator":"click_edit_lease_payment",value:t[le.g],isOpen:pe,type:le.g,initialLoading:o[le.g],creativeId:$})))),E.a.createElement(S.a,{className:p},E.a.createElement(I.a,{className:"px-0"},re&&E.a.createElement("div",{className:N()({"hidden-xs-up":!de})},M?E.a.createElement(Ne,{onMonthlyPaymentUpdate:this.updateMonthlyPayment,onSelectionUpdate:this.updateSelection,onSharedInputUpdate:this.updateSelectionValue,offer:y,selections:ue,isTaxesAndFeesEnabled:A,clearMMYFromStorage:this.clearMMYFromStorage,vin:W,dealerZipCode:D,updateGetThisDealBtn:U,creativeId:$,usePaymentWithTaxesAndFeesForTabs:G,useDefaults:z},E.a.createElement(Et,{vehicle:R,vehiclePrice:ee,appliedIncentives:_,onTradeInClick:this.toggleAppraisalDrawer,onCreditScoreChange:C,taxesAndFeesZipCode:te,setZipToStorage:P,styleId:ae,isNonTMVDealer:x,appraisalMMYLabel:r,msrp:ge,isUsed:be,useBestPaymentService:M,venomVersion:L,pageName:F,internalDrawerConfig:q,vehiclePriceProps:B,paymentInputProps:Y,radioGroupProps:H,hideTaxesFeesSection:Z})):E.a.createElement(ye,{onMonthlyPaymentUpdate:this.updateMonthlyPayment,onRecalculationCall:this.setShouldRecalculateValue,onSelectionUpdate:this.updateSelection,onSharedInputUpdate:this.updateSelectionValue,baseAPR:j,baseTermMonths:w,unselectFinancingPromotions:V,baseCreditScore:v,offer:y,selections:ue,isTaxesAndFeesEnabled:A,clearMMYFromStorage:this.clearMMYFromStorage,vin:W,updateGetThisDealBtn:U,creativeId:$,usePaymentWithTaxesAndFeesForTabs:G,useDefaults:z,msrp:ge},E.a.createElement(Et,{vehicle:R,vehiclePrice:ee,appliedIncentives:_,onTradeInClick:this.toggleAppraisalDrawer,onCreditScoreChange:C,taxesAndFeesZipCode:te,setZipToStorage:P,styleId:ae,isNonTMVDealer:x,appraisalMMYLabel:r,msrp:ge,isUsed:be,venomVersion:L,pageName:F,internalDrawerConfig:q,vehiclePriceProps:B,paymentInputProps:Y,radioGroupProps:H,hideTaxesFeesSection:Z}))),oe&&E.a.createElement("div",{className:N()({"hidden-xs-up":!pe})},E.a.createElement(xt,{onMonthlyPaymentUpdate:this.updateMonthlyPayment,onSelectionUpdate:this.updateSelection,onSharedInputUpdate:this.updateSelectionValue,vin:W,vehicle:R,payments:he,setZip:P,isNonTMVDealer:x,updateGetThisDealBtn:U,selections:ue,creativeId:$,usePaymentWithTaxesAndFeesForTabs:G,useDefaults:z},E.a.createElement(wt,{vehiclePrice:X||ie,onTradeInClick:this.toggleAppraisalDrawer,vin:W,vehicle:R,styleId:ae,leasePromiseEndDate:se,isNonTMVDealer:x,appraisalMMYLabel:r,msrp:ge,residual:fe,venomVersion:L,pageName:F,internalDrawerConfig:q,vehiclePriceProps:B,paymentInputProps:Y,radioGroupProps:H,hideTaxesFeesSection:Z}))))),q?n&&E.a.createElement(qt.a,{selector:q.portalSelector},E.a.createElement(Mt.TradeInAppraiser,{onDone:this.toggleAppraisalDrawer,onTradeInUpdate:this.updateSelectionValue,sellYourCarConfig:T,isPurchase:de,msrp:ge,sellingPrice:ee,residualValue:fe,isUsed:be,columnsSize:{xs:12,md:12,lg:12,xl:12}})):E.a.createElement(Rt.a,{isOpen:n,onToggle:this.toggleAppraisalDrawer,onTradeInUpdate:this.updateSelectionValue,trackingParent:zt,sellYourCarConfig:T,isPurchase:de,msrp:ge,sellingPrice:ee,residualValue:fe,isUsed:be}))}}Yt.propTypes={payments:v.a.shape({type:v.a.string.isRequired,vin:v.a.string.isRequired,taxesAndFeesZipCode:v.a.string}).isRequired,disclaimerSymbol:v.a.string,wrapperClasses:v.a.string,calculationClasses:v.a.string,toggleBtnGroupClasses:v.a.string,showTabs:v.a.bool,onPaymentsUpdate:v.a.func,onCalculatorToggle:v.a.func,baseCreditScore:v.a.string,onCreditScoreChange:v.a.func,sellYourCarConfig:Dt.e,setModelValue:v.a.func.isRequired,appliedIncentives:v.a.arrayOf(v.a.oneOfType([P.b.Incentive,A.b.Incentive])),internalDrawerConfig:v.a.shape({onToggle:v.a.func,portalSelector:v.a.string,openedDrawer:v.a.string}),vehiclePriceProps:v.a.shape({customLabel:v.a.string,customTooltip:v.a.func,hideDescription:v.a.bool,isReadOnly:v.a.bool}),setZipToStorage:v.a.func,dealerZipCode:v.a.string,isLoanTaxesAndFeesEnabled:v.a.bool,isNonTMVDealer:v.a.bool,unselectFinancingPromotions:v.a.func,baseAPR:v.a.number,baseTermMonths:v.a.number,vinData:A.b.InventoryVin,useBestPaymentService:v.a.bool,useDefaults:v.a.bool,venomVersion:v.a.string,pageName:v.a.string,updateGetThisDealBtn:v.a.func,creativeId:v.a.string,paymentInputProps:v.a.shape({}),radioGroupProps:v.a.shape({}),hideTaxesFeesSection:v.a.bool,usePaymentWithTaxesAndFeesForTabs:v.a.bool},Yt.defaultProps={disclaimerSymbol:"",wrapperClasses:"bg-gray-lightest",calculationClasses:"",toggleBtnGroupClasses:"",activeClass:"bg-gray-extra-light",inactiveClass:"bg-white",showTabs:!0,onPaymentsUpdate:null,onCalculatorToggle:null,baseCreditScore:"",onCreditScoreChange:null,vehiclePriceProps:null,sellYourCarConfig:{},appliedIncentives:[],setZipToStorage:null,internalDrawerConfig:null,dealerZipCode:"",isLoanTaxesAndFeesEnabled:!1,isNonTMVDealer:!1,useDefaults:!1,unselectFinancingPromotions:null,baseAPR:null,baseTermMonths:null,vinData:{},useBestPaymentService:!1,venomVersion:"",pageName:"",updateGetThisDealBtn:r.a,creativeId:le.zb,paymentInputProps:null,radioGroupProps:null,hideTaxesFeesSection:!1,usePaymentWithTaxesAndFeesForTabs:!1}},"./site-modules/shared/components/calculator/payment-calculator/payment-calculator.scss":function(e,t,a){},"./site-modules/shared/components/calculator/price-item/price-item.scss":function(e,t,a){},"./site-modules/shared/components/calculator/radio-group/radio-group.jsx":function(e,t,a){"use strict";a.d(t,"a",function(){return f});var s=a("../node_modules/react/index.js"),i=a.n(s),n=a("../node_modules/prop-types/index.js"),r=a.n(n),o=a("../node_modules/classnames/index.js"),l=a.n(o),c=a("../node_modules/reactstrap/lib/Label.js"),d=a.n(c),p=a("../node_modules/reactstrap/lib/ButtonGroup.js"),m=a.n(p),u=a("../node_modules/reactstrap/lib/Button.js"),h=a.n(u),g=a("./site-modules/shared/components/tooltip-item/tooltip-item.jsx");a("./site-modules/shared/components/calculator/radio-group/radio-group.scss");function f(e){let t=e.onClick,a=e.onKeyPress,s=e.values,n=e.selected,r=e.trackingId,o=e.name,c=e.title,p=e.tooltip,u=e.id,f=e.className,b=e.buttonClassName,E=e.selectedValuePostfix,y=e.children;const v=Number(n)||n,C=e=>e===v;return i.a.createElement("div",{className:"radio-group"},c&&i.a.createElement(d.a,{className:"mb-1 d-flex justify-content-between"},i.a.createElement("span",null,c," ",p&&i.a.createElement(g.a,{id:u,item:p,className:"tooltip-text"})),E&&!s.includes(v)&&i.a.createElement("span",null,n," ",E)),y,i.a.createElement(m.a,{className:"d-flex justify-content-between","data-toggle":"buttons","aria-label":u||c},s.map(e=>i.a.createElement(h.a,{key:e,"data-tracking-id":r,"data-tracking-value":e,tabIndex:0,name:o,value:e,onClick:t,onKeyPress:a,size:"responsive",outline:!C(e),color:C(e)?"primary":"secondary",className:l()("radio-group-button w-100",{active:C(e)},{"bg-white text-gray-darker":!C(e)},b),"aria-label":`${c} ${e}`},i.a.createElement("span",{className:l()("font-weight-normal",f)},e)))))}f.propTypes={onClick:r.a.func.isRequired,onKeyPress:r.a.func.isRequired,values:r.a.arrayOf(r.a.oneOfType([r.a.number,r.a.string])).isRequired,selected:r.a.oneOfType([r.a.number,r.a.string]),name:r.a.string.isRequired,title:r.a.string,trackingId:r.a.string,id:r.a.string,children:r.a.node,tooltip:r.a.shape({text:r.a.string.isRequired,placement:r.a.string.isRequired}),className:r.a.string,buttonClassName:r.a.string,selectedValuePostfix:r.a.string},f.defaultProps={trackingId:"",title:"",id:"",tooltip:null,className:"",buttonClassName:null,selected:"",children:null,selectedValuePostfix:""}},"./site-modules/shared/components/calculator/radio-group/radio-group.scss":function(e,t,a){},"./site-modules/shared/components/calculator/taxes-and-fees/taxes-and-fees-utils.jsx":function(e,t,a){"use strict";a.d(t,"a",function(){return h});var s=a("../node_modules/lodash/isFinite.js"),i=a.n(s),n=a("../node_modules/lodash/get.js"),r=a.n(n),o=a("../node_modules/react/index.js"),l=a.n(o),c=a("../node_modules/classnames/index.js"),d=a.n(c),p=a("./site-modules/shared/utils/calculator/taxes-and-fees-helper.js"),m=a("./site-modules/shared/utils/price-utils.js"),u=a("./site-modules/shared/components/tooltip-item/tooltip-item.jsx");function h(e,t,a,s,n){const o=a.title,c=o.name,h=o.slug,g=o.isBold,f=o.notAvailableText,b=Object(p.c)(e,t,a,s,n),E=b.length;return l.a.createElement("div",{key:c},l.a.createElement("div",{className:"d-flex justify-content-between"},l.a.createElement("span",{className:d()("pb-1",{"font-weight-bold":g})},c),E?Object(m.a)(r()(t,h,0),2,2):p.a),l.a.createElement("ul",{className:"list-unstyled mb-0"},E?b.map(t=>{let a=t.name,s=t.slug,n=t.tooltip,r=t.itemValue;return l.a.createElement("li",{key:s,className:"d-flex justify-content-between"},l.a.createElement("span",{className:"pb-0_5"},a," ",n&&l.a.createElement(u.a,{id:`${e}${s}`,className:"tooltip-text",item:n}))," ",i()(r)?Object(m.a)(r,2,2):"not provided")}):l.a.createElement("li",null,f)))}},"./site-modules/shared/components/calculator/taxes-and-fees/taxes-and-fees.scss":function(e,t,a){},"./site-modules/shared/components/calculator/toggle-button/toggle-button.scss":function(e,t,a){},"./site-modules/shared/components/calendar/calendar.jsx":function(e,t,a){"use strict";a.d(t,"a",function(){return I});var s=a("../node_modules/lodash/isEmpty.js"),i=a.n(s),n=a("../node_modules/react/index.js"),r=a.n(n),o=a("../node_modules/prop-types/index.js"),l=a.n(o),c=a("../node_modules/classnames/index.js"),d=a.n(c),p=a("../node_modules/reactstrap/lib/Dropdown.js"),m=a.n(p),u=a("../node_modules/reactstrap/lib/DropdownMenu.js"),h=a.n(u),g=a("../node_modules/reactstrap/lib/DropdownToggle.js"),f=a.n(g),b=a("../node_modules/dateformat/lib/dateformat.js"),E=a.n(b),y=a("../node_modules/react-day-picker/DayPicker.js"),v=a.n(y),C=a("./site-modules/shared/utils/date-utils.js"),S=a("./tracking/constant.js"),T=a("./utils/event-toolbox.js");a("../node_modules/react-day-picker/lib/style.css"),a("./site-modules/shared/components/calendar/calendar.scss");class I extends n.Component{constructor(){super(...arguments),this.state={isCalendarOpen:!1},this.onChange=((e,t)=>{t.disabled||(this.props.onChange(e),this.toggleCalendar())}),this.toggleCalendar=(()=>{this.setState(e=>{let t=e.isCalendarOpen;return T.a.fireCustomEvent(t?S.b.CLOSE_CALENDAR:S.b.OPEN_CALENDAR),{isCalendarOpen:!t}})}),this.handleClick=(e=>{e.preventDefault()})}render(){const e=this.props,t=e.selectedDate,a=e.disabledDays,s=e.deliveryDateClassName,n=this.state.isCalendarOpen,o=Object(C.c)();return r.a.createElement(m.a,{className:"calendar-dropdown",isOpen:n,toggle:this.toggleCalendar,onClick:this.handleClick},r.a.createElement(f.a,{className:"pos-r p-0 m-0 w-100 bg-white text-left font-weight-normal"},r.a.createElement("div",{className:d()("w-100 text-gray-darker form-control",s)},E()(t,"mm/dd/yyyy (ddd.)")),r.a.createElement("span",{className:"delivery-time-icon icon-calendar4 p-0_75 bg-primary text-white"})),r.a.createElement(h.a,{right:!0,onClick:this.handleClick},r.a.createElement(v.a,{onDayClick:this.onChange,selectedDays:t,month:t,initialMonth:t,disabledDays:i()(a)?{before:o}:a})))}}I.propTypes={onChange:l.a.func.isRequired,selectedDate:l.a.instanceOf(Date).isRequired,disabledDays:l.a.oneOfType([l.a.object,l.a.array]),deliveryDateClassName:l.a.string},I.defaultProps={disabledDays:{},deliveryDateClassName:"display-5"}},"./site-modules/shared/components/calendar/calendar.scss":function(e,t,a){},"./site-modules/shared/components/car-buying/trade-in/trade-in-popover.jsx":function(e,t,a){"use strict";a.d(t,"a",function(){return g});var s=a("../node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),i=a("../node_modules/lodash/noop.js"),n=a.n(i),r=a("../node_modules/react/index.js"),o=a.n(r),l=a("../node_modules/prop-types/index.js"),c=a.n(l),d=a("../node_modules/classnames/index.js"),p=a.n(d),m=a("../node_modules/reactstrap/lib/Button.js"),u=a.n(m),h=a("./site-modules/shared/constants/calculator/calculator.js");a("./site-modules/shared/components/car-buying/trade-in/trade-in-popover.scss");function g(e){let t=e.tradeInValidationError,a=e.calculator,i=e.onApplyTradeIn;const n=Object(r.useRef)(),l=Object(r.useState)(!1),c=Object(s.a)(l,2),d=c[0],m=c[1],g=()=>{d&&i(),m(!d)};Object(r.useEffect)(()=>{t&&g()},[t]);const f=o.a.createElement(r.Fragment,null,o.a.createElement("span",null,t),o.a.createElement(u.a,{color:"link",onClick:g,className:"applied-link text-underline font-weight-bold d-block mt-0_5 text-primary-darker p-0 text-capitalize body"},"Got it!"));return o.a.createElement("div",{className:p()("trade-in-popover-wrapper pos-r",{"vdp-calculator":a===h.i})},o.a.createElement("i",{id:"trade-in-popover",className:p()("icon icon-notification2 d-block text-warning",{"h3 mr-0_5":a===h.f,h5:a===h.i})}),d&&o.a.createElement(r.Fragment,null,o.a.createElement("div",{className:p()("popover-body bg-white rounded py-1_5",{"px-1":a===h.f,"px-1_25":a===h.i}),ref:n},f),o.a.createElement("span",{className:"arrow"})))}g.propTypes={tradeInValidationError:c.a.string,onApplyTradeIn:c.a.func,calculator:c.a.string},g.defaultProps={tradeInValidationError:"",onApplyTradeIn:n.a,calculator:h.f}},"./site-modules/shared/components/car-buying/trade-in/trade-in-popover.scss":function(e,t,a){},"./site-modules/shared/components/carousel/carousel.jsx":function(e,t,a){"use strict";a.d(t,"a",function(){return A});var s=a("../node_modules/@babel/runtime/helpers/esm/extends.js"),i=a("../node_modules/@babel/runtime/helpers/esm/objectSpread.js"),n=a("../node_modules/lodash/get.js"),r=a.n(n),o=a("../node_modules/react/index.js"),l=a.n(o),c=a("../node_modules/prop-types/index.js"),d=a.n(c),p=a("../node_modules/react-slick/lib/index.js"),m=a.n(p),u=a("../node_modules/classnames/index.js"),h=a.n(u),g=a("../node_modules/reactstrap/lib/Row.js"),f=a.n(g),b=a("../node_modules/reactstrap/lib/Col.js"),E=a.n(b),y=a("../node_modules/react-router/esm/react-router.js"),v=a("./utils/location.js"),C=(a("../node_modules/slick-carousel/slick/slick.css"),a("../node_modules/slick-carousel/slick/slick-theme.css"),a("./utils/event-toolbox.js")),S=a("./engagement-handlers/index.js"),T=a("./engagement-handlers/carousel-engagement-handler/carousel-engagement-handler.js"),I=(a("./site-modules/shared/components/carousel/carousel.scss"),a("./site-modules/shared/components/carousel/events.js"));S.a.register(T.a);const _=e=>l.a.createElement("div",{className:"left carousel-control"},l.a.createElement("button",{"aria-label":"previous slide",className:h()("icon-prev",e.className),onClick:e.onClick}));_.propTypes={onClick:d.a.func,className:d.a.string},_.defaultProps={onClick:null,className:""};const N=e=>l.a.createElement("div",{className:"right carousel-control"},l.a.createElement("button",{"aria-label":"next slide",className:h()("icon-next",e.className),onClick:e.onClick}));N.propTypes={onClick:d.a.func,className:d.a.string},N.defaultProps={onClick:null,className:""};const O={HORIZONTAL:{PREV:"right",NEXT:"left"},VERTICAL:{PREV:"down",NEXT:"up"}};function P(e){let t=e.direction,a=void 0===t?"":t,s=e.props,i=e.slider,n=e.element,o=e.nextSlide,l=e.actionCause,c=void 0===l?"":l;const d=r()(s,"data-carousel-photo-type",""),p=s.vertical,m=s.infinite,u=(i&&i.innerSlider&&i.innerSlider.state).slideCount,h=s.contentType,g=r()(i,"innerSlider.state.currentSlide",0),f=s.contentDetails||h,b=s.customEventData||{},E=s.noAdsRefresh;C.a.fireCustomEvent(I.a.SWIPE,{target:n,data:{currentSlide:g,nextSlide:o,total:u,vertical:p,infinite:m,contentType:h,contentDetails:f,customEventData:b,direction:a,photoType:d,actionCause:c,noAdsRefresh:E}})}class A extends o.Component{constructor(e){super(e),this.onPrevClick=(()=>{this.onSwipe({direction:this.props.vertical?O.VERTICAL.PREV:O.HORIZONTAL.PREV})}),this.onNextClick=(()=>{this.onSwipe({direction:this.props.vertical?O.VERTICAL.NEXT:O.HORIZONTAL.NEXT})}),this.onBeforeChange=((e,t)=>{this.props.beforeChange&&this.props.beforeChange(e,t)}),this.onAfterChange=(e=>{this.props.afterChange&&this.props.afterChange(e)}),this.onSwipe=(e=>{let t=e.direction,a=void 0===t?"":t,s=e.actionCause,i=void 0===s?"":s;const n=this.props.vertical,r=this.props.infinite,o=this.slider&&this.slider.innerSlider&&this.slider.innerSlider.state,l=o.slideCount,c=function(e,t,a,s,i){const n=e+(s&&a===O.VERTICAL.NEXT||!s&&a===O.HORIZONTAL.NEXT?1:-1),r=t-1;return n<0?i?r:0:n>r?i?0:r:n}(o.currentSlide,l,a,n,r);P({props:this.props,slider:this.slider,element:this.element,direction:a,nextSlide:c,actionCause:i}),this.props.swipeEvent&&this.props.swipeEvent(c)}),this.forceDisableAutoplayOptions=(e=>{let t;const a=[];return e&&(t=Object.assign({},Object(i.a)({},e),{autoplay:!1})).responsive&&(t.responsive.forEach(e=>{a.push(Object(i.a)({},e,{settings:Object.assign({},Object(i.a)({},e.settings),{autoplay:!1})}))}),t.responsive=a),t}),this.next=(()=>{this.slider.slickNext()}),this.prev=(()=>{this.slider.slickPrev()}),this.goto=(e=>{P({props:this.props,slider:this.slider,element:this.element,nextSlide:e}),this.slider.slickGoTo(e)}),this.setSliderRefs=(e=>{this.slider=e,this.element=e&&e.innerSlider&&e.innerSlider.list&&e.innerSlider.list.parentElement})}componentDidMount(){if(this.props.arrows&&this.element){const e=this.element.querySelector(".left.carousel-control"),t=this.element.querySelector(".right.carousel-control");e&&t&&(e.addEventListener("click",this.onPrevClick,!1),t.addEventListener("click",this.onNextClick,!1))}this.slider&&this.props.currentSlideIndex&&this.slider.slickGoTo(this.props.currentSlideIndex)}componentWillUnmount(){if(this.props.arrows&&this.element){const e=this.element.querySelector(".left.carousel-control"),t=this.element.querySelector(".right.carousel-control");e&&t&&(e.removeEventListener("click",this.onPrevClick,!1),t.removeEventListener("click",this.onNextClick,!1))}}renderSlider(){const e=(t=this.props.pageCounter)?!0===t||"xs"===t?"page-counter":`page-counter-${t}`:"";var t;const a=o.Children.count(this.props.children)>1,n=1===this.props.slidesToShow||!this.props.slidesToShow,r=h()("slick-carousel",{"show-one":n},{fluid:this.props.fluid},e,this.props.className),c=Object(i.a)({},this.props,{dots:this.props.dots||!!e,beforeChange:this.onBeforeChange,afterChange:this.onAfterChange,swipeEvent:this.onSwipe,arrows:this.props.arrows&&a,autoplay:this.props.autoplay&&a,draggable:this.props.draggable&&a,swipe:this.props.swipe&&a,className:r}),d=this.context&&this.context.location&&"off"===Object(v.a)(this.context.location)["carousel-autoplay"]?this.forceDisableAutoplayOptions(c):c;return l.a.createElement(m.a,Object(s.a)({ref:this.setSliderRefs},d),this.props.children)}render(){const e=this.props.fluid;return l.a.createElement(f.a,{className:"no-gutters"},l.a.createElement(E.a,{xs:{size:e?12:10,offset:e?0:1}},this.renderSlider()))}}A.contextType=y.e,A.propTypes={className:d.a.string,fluid:d.a.bool,vertical:d.a.bool,infinite:d.a.bool,contentType:d.a.string,contentDetails:d.a.string,customEventData:d.a.shape({}),beforeChange:d.a.func,afterChange:d.a.func,swipeEvent:d.a.func,children:d.a.node,arrows:d.a.bool,pageCounter:d.a.oneOfType([d.a.bool,d.a.oneOf(["xs","sm","md","lg","xl"])]),dots:d.a.bool,dotsClass:d.a.string,autoplay:d.a.bool,draggable:d.a.bool,swipe:d.a.bool,adaptiveHeight:d.a.bool,currentSlideIndex:d.a.number,noAdsRefresh:d.a.bool},A.defaultProps={className:"",fluid:!0,vertical:!1,infinite:!0,contentType:"content",contentDetails:"",customEventData:null,beforeChange:null,afterChange:null,swipeEvent:null,nextArrow:l.a.createElement(N,null),prevArrow:l.a.createElement(_,null),children:null,arrows:!0,pageCounter:!1,dots:!1,dotsClass:"slick-dots",autoplay:!1,draggable:!0,swipe:!0,adaptiveHeight:!1,currentSlideIndex:0,noAdsRefresh:!1}},"./site-modules/shared/components/carousel/carousel.scss":function(e,t,a){},"./site-modules/shared/components/carousel/events.js":function(e,t,a){"use strict";a.d(t,"a",function(){return s});const s={SWIPE:"carousel.swipe"}},"./site-modules/shared/components/color-feature-list-smart/color-feature-list-smart.jsx":function(e,t,a){"use strict";a.d(t,"a",function(){return p});var s=a("../node_modules/@babel/runtime/helpers/esm/extends.js"),i=a("../node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js"),n=a("../node_modules/react/index.js"),r=a.n(n),o=a("../node_modules/prop-types/index.js"),l=a.n(o),c=a("../node_modules/lodash/get.js"),d=a.n(c);function p(e,t){class a extends n.Component{constructor(){super(...arguments),this.onClick=(e=>{const a=d()(e.target.closest(`.${t}-item`),"title",null);a&&this.props.updateHOCState(a)})}render(){const t=this.props,a=t.title,o=(t.updateHOCState,Object(i.a)(t,["title","updateHOCState"]));return r.a.createElement(n.Fragment,null,a&&r.a.createElement("h4",{className:"medium text-center"},a),r.a.createElement(e,Object(s.a)({},o,{onClick:this.onClick})))}}a.propTypes={listItems:l.a.arrayOf(l.a.oneOfType([l.a.shape({name:l.a.string,count:l.a.number,properties:l.a.shape({rgb:l.a.string}),price:l.a.shape({baseMSRP:l.a.number})}),l.a.shape({name:l.a.string,value:l.a.string,count:l.a.number})])).isRequired,updateHOCState:l.a.func,title:l.a.string},a.defaultProps={updateHOCState:()=>{},title:""};const o=e.displayName||e.name||"Component";return a.displayName=`withSmartListHandlers(${o})`,a}},"./site-modules/shared/components/color-list-smart-v2/color-list-smart-v2.scss":function(e,t,a){},"./site-modules/shared/components/delighted/delighted.scss":function(e,t,a){},"./site-modules/shared/components/filter-facets/facet-checkbox/facet-checkbox.scss":function(e,t,a){},"./site-modules/shared/components/find-style-modal/find-style-modal.scss":function(e,t,a){},"./site-modules/shared/components/find-vin-by-address/find-vin-by-address.scss":function(e,t,a){},"./site-modules/shared/components/find-vin-modal/find-vin-modal.scss":function(e,t,a){},"./site-modules/shared/components/logos/carmax-logo.jsx":function(e,t,a){"use strict";a.d(t,"a",function(){return h});var s=a("../node_modules/lodash/get.js"),i=a.n(s),n=a("../node_modules/react/index.js"),r=a.n(n),o=a("../node_modules/prop-types/index.js"),l=a.n(o),c=a("../node_modules/react-redux/es/index.js"),d=a("./utils/image-helpers.js"),p=a("./site-modules/shared/components/image/image.jsx"),m=a("./site-modules/shared/components/experiment/index.jsx");function u(e){let t=e.themeTypeOverride,a=e.className;return r.a.createElement("picture",null,r.a.createElement(m.a,{name:"ads-5469-dark-theme",showDefault:!0},r.a.createElement(m.c,{name:"ctrl",isDefault:!0}),r.a.createElement(m.c,{name:"chal"},"light"!==t&&r.a.createElement("source",{srcSet:Object(d.k)("img/eva/partners/carmax-white.svg",void 0,d.d.STATIC)}))),r.a.createElement(p.a,{imageId:"img/eva/partners/carmax-logo.svg",source:d.d.STATIC,alt:"CarMax logo",className:a}))}u.propTypes={themeTypeOverride:l.a.string,className:l.a.string},u.defaultProps={themeTypeOverride:null,className:"partner-logo"};const h=Object(c.c)(e=>({themeTypeOverride:i()(e,"visitor.themeTypeOverride")}))(u)},"./site-modules/shared/components/logos/edmunds-logo-text.jsx":function(e,t,a){"use strict";a.d(t,"a",function(){return g});var s=a("../node_modules/lodash/get.js"),i=a.n(s),n=a("./utils/image-helpers.js"),r=a("../node_modules/react/index.js"),o=a.n(r),l=a("../node_modules/prop-types/index.js"),c=a.n(l),d=a("./images/logo-white.svg"),p=a.n(d),m=a("../node_modules/react-redux/es/index.js"),u=a("./site-modules/shared/components/experiment/index.jsx");function h(e){const t=e.themeTypeOverride,a=e.className;return o.a.createElement("picture",null,o.a.createElement(u.a,{name:"ads-5469-dark-theme",showDefault:!0},o.a.createElement(u.c,{name:"ctrl",isDefault:!0}),o.a.createElement(u.c,{name:"chal"},"light"!==t&&o.a.createElement("source",{srcSet:p.a}))),o.a.createElement("img",{src:Object(n.q)("/images/logos/edmunds-logo-and-text-226x36-trans.png"),alt:"edmunds logo and edmunds",className:a}))}h.propTypes={themeTypeOverride:c.a.string,className:c.a.string},h.defaultProps={themeTypeOverride:null,className:""};const g=Object(m.c)(e=>({themeTypeOverride:i()(e.visitor,"themeTypeOverride")}))(h)},"./site-modules/shared/components/odometer-wrapper/odometer-wrapper.jsx":function(e,t,a){"use strict";a.r(t),a.d(t,"OdometerWrapper",function(){return m});var s=a("../node_modules/@babel/runtime/helpers/esm/objectSpread.js"),i=a("../node_modules/lodash/noop.js"),n=a.n(i),r=a("../node_modules/react/index.js"),o=a.n(r),l=a("../node_modules/prop-types/index.js"),c=a.n(l),d=a("../node_modules/odometer/odometer.js"),p=a.n(d);a("../node_modules/odometer/themes/odometer-theme-default.css");class m extends r.PureComponent{constructor(){super(...arguments),this.node=o.a.createRef()}componentDidMount(){this.odometer=new p.a(Object(s.a)({el:this.node.current},this.props)),this.props.onDidMount(this.odometer)}componentDidUpdate(){const e=this.props.value;this.odometer.update(e)}render(){return o.a.createElement("div",{className:this.props.classNames,ref:this.node})}}m.propTypes={duration:c.a.number,format:c.a.string,selector:c.a.string,theme:c.a.string,value:c.a.oneOfType([c.a.string,c.a.number]).isRequired,classNames:c.a.string,onDidMount:c.a.func},m.defaultProps={duration:2e3,format:"(,ddd)",selector:".odometer",theme:"default",classNames:"",onDidMount:n.a}},"./site-modules/shared/components/radio-list/radio-list-item.jsx":function(e,t,a){"use strict";a.d(t,"a",function(){return f});var s=a("../node_modules/@babel/runtime/helpers/esm/extends.js"),i=a("../node_modules/react/index.js"),n=a.n(i),r=a("../node_modules/prop-types/index.js"),o=a.n(r),l=a("../node_modules/classnames/index.js"),c=a.n(l),d=a("../node_modules/reactstrap/lib/Label.js"),p=a.n(d),m=a("../node_modules/reactstrap/lib/Input.js"),u=a.n(m),h=a("../node_modules/reactstrap/lib/FormGroup.js"),g=a.n(h);function f(e){let t=e.listItem,a=t.title,i=t.text,r=t.trackingId,o=t.trackingValue,l=t.id,d=t.customAttrs,m=t.hideValue,h=e.name,f=e.onChange,b=e.formGroupClassName,E=e.labelContainerClassName,y=e.checkmarkClassName,v=e.labelClassName,C=e.labelCheckedClassName,S=e.textClassName,T=e.checked;return n.a.createElement(g.a,Object(s.a)({className:c()(b),check:!0},d),n.a.createElement(p.a,{className:c()(E,{[C]:T}),check:!0},n.a.createElement(u.a,{className:"radio-input",type:"radio",value:a,name:h,checked:T,onChange:f,"data-tracking-id":r,"data-tracking-value":o}),n.a.createElement("span",{className:c()("checkmark",y)}),!m&&n.a.createElement("div",{id:l,className:c()(v)},a),n.a.createElement("div",{className:c()(S)},i)))}f.propTypes={listItem:o.a.shape({title:o.a.string,text:o.a.oneOfType([o.a.string,o.a.node]),trackingId:o.a.string,trackingValue:o.a.oneOfType([o.a.string,o.a.number]),id:o.a.oneOfType([o.a.string,o.a.number]),customAttrs:o.a.shape({}),hideValue:o.a.bool}).isRequired,name:o.a.string.isRequired,onChange:o.a.func.isRequired,formGroupClassName:o.a.string,labelContainerClassName:o.a.string,labelClassName:o.a.string,labelCheckedClassName:o.a.string,textClassName:o.a.string,checkmarkClassName:o.a.string,checked:o.a.bool},f.defaultProps={formGroupClassName:null,labelContainerClassName:null,labelClassName:null,labelCheckedClassName:"label-checked",textClassName:null,checkmarkClassName:null,checked:!1}},"./site-modules/shared/components/radio-list/radio-list.scss":function(e,t,a){},"./site-modules/shared/components/styled-select/styled-select.jsx":function(e,t,a){"use strict";a.d(t,"a",function(){return u});var s=a("../node_modules/@babel/runtime/helpers/esm/objectSpread.js"),i=a("../node_modules/@babel/runtime/helpers/esm/extends.js"),n=a("../node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js"),r=a("../node_modules/react/index.js"),o=a.n(r),l=a("../node_modules/prop-types/index.js"),c=a.n(l),d=a("../node_modules/classnames/index.js"),p=a.n(d),m=a("./site-modules/shared/components/select/select.jsx");a("./site-modules/shared/components/styled-select/styled-select.scss");function u(e){let t=e.size,a=e.wrapperClassName,s=e.className,r=e.overrideClasses,l=Object(n.a)(e,["size","wrapperClassName","className","overrideClasses"]);const c=p()("form-control py-0_5 pr-2_5 size-16 text-gray-darker",s);return o.a.createElement("div",{className:p()("styled-select chevron",a,{"size-lg":"lg"===t})},o.a.createElement(m.a,Object(i.a)({className:r||c},l)))}u.propTypes=Object(s.a)({},m.c,{size:c.a.oneOf(["lg"]),wrapperClassName:c.a.string,className:c.a.string,overrideClasses:c.a.string}),u.defaultProps=Object(s.a)({},m.b,{size:null,wrapperClassName:"",className:"",overrideClasses:null})},"./site-modules/shared/components/styled-select/styled-select.scss":function(e,t,a){},"./site-modules/shared/components/time-selector/time-selector.jsx":function(e,t,a){"use strict";a.d(t,"a",function(){return y});var s=a("../node_modules/lodash/get.js"),i=a.n(s),n=a("../node_modules/react/index.js"),r=a.n(n),o=a("../node_modules/classnames/index.js"),l=a.n(o),c=a("../node_modules/reactstrap/lib/Dropdown.js"),d=a.n(c),p=a("../node_modules/reactstrap/lib/DropdownMenu.js"),m=a.n(p),u=a("../node_modules/reactstrap/lib/DropdownToggle.js"),h=a.n(u),g=a("../node_modules/prop-types/index.js"),f=a.n(g),b=a("./tracking/constant.js"),E=a("./utils/event-toolbox.js");a("./site-modules/shared/components/time-selector/time-selector.scss");class y extends n.Component{constructor(){super(...arguments),this.state={isIntervalSelectorVisible:!1},this.toggleIntervalSelector=(()=>{this.setState(e=>{let t=e.isIntervalSelectorVisible;return E.a.fireCustomEvent(t?b.b.CLOSE_TIME_SLOTS:b.b.OPEN_TIME_SLOTS),{isIntervalSelectorVisible:!t}})}),this.closeIntervalSelector=(()=>{E.a.fireCustomEvent(b.b.CLOSE_TIME_SLOTS),this.setState({isIntervalSelectorVisible:!1})}),this.selectInterval=(e=>{const t=i()(e,"target.dataset.name",""),a=i()(e,"target.dataset.value","");this.props.onChange(t,a),this.closeIntervalSelector()}),this.handleClick=(e=>{e.preventDefault()})}render(){const e=this.state.isIntervalSelectorVisible,t=this.props,a=t.deliveryTime,s=t.timeIntervals,i=t.deliveryTimeClassName;return r.a.createElement(d.a,{isOpen:e,toggle:this.toggleIntervalSelector,onClick:this.handleClick},r.a.createElement(h.a,{className:"delivery-time-toggle text-left font-weight-normal p-0 mt-0_25 mt-md-0 pos-r w-100 bg-white"},r.a.createElement("div",{className:l()("delivery-time-picker w-100 text-gray-darker form-control",i)},a),r.a.createElement("span",{className:"delivery-time-icon medium icon-clock p-0_75 bg-primary text-white"})),r.a.createElement(m.a,{className:"delivery-toggle-menu",right:!0},r.a.createElement(v,{selectInterval:this.selectInterval,activeItem:a,timeIntervals:s})))}}function v(e){let t=e.selectInterval,a=e.timeIntervals,s=e.activeItem;return r.a.createElement("div",{className:"delivery-time-selector px-1_5 px-md-0_5"},a.map(e=>{let a=e.title,i=e.value;const n=i===s?"active":"";return r.a.createElement("div",{role:"button",tabIndex:0,onClick:t,"data-value":i,"data-name":"time",className:`delivery-time-option pos-r px-1 py-0_5 mb-0_5 p-md-0_25 ${n}`,key:i},a)}))}y.propTypes={deliveryTime:f.a.string,onChange:f.a.func.isRequired,timeIntervals:f.a.arrayOf(f.a.shape({end:f.a.number,start:f.a.number,title:f.a.string,value:f.a.string})),deliveryTimeClassName:f.a.string},y.defaultProps={timeIntervals:[],deliveryTime:"",deliveryTimeClassName:"display-5"},v.propTypes={selectInterval:f.a.func.isRequired,timeIntervals:f.a.arrayOf(f.a.shape({title:f.a.string,value:f.a.string,start:f.a.number,end:f.a.number})),activeItem:f.a.string.isRequired},v.defaultProps={timeIntervals:[]}},"./site-modules/shared/components/time-selector/time-selector.scss":function(e,t,a){},"./site-modules/shared/components/vehicle-dropdowns/vehicle-dropdowns.scss":function(e,t,a){},"./site-modules/shared/utils/build-and-price-link-constructor.js":function(e,t,a){"use strict";a.d(t,"a",function(){return n});var s=a("./site-modules/shared/utils/string.js");const i=["modelyearId","submodel","styleId"];function n(e,t){let a=e.make,n=e.model,r=e.year,o=e.submodel,l=e.styleId,c=e.modelyearId,d={modelyearId:c,submodel:o,styleId:l};i.forEach((e,t)=>{d[e]=i.slice(0,t).every(e=>d[e])?d[e]:null}),d.modelyearId&&!d.submodel&&(d={defaultValue:c});const p=Object(s.f)(d)||Object(s.f)({defaultYear:r});return`/${a}/${n}/build/${p?`?${p}`:""}${t&&d.styleId?"&priceBreakdown":""}`}},"./site-modules/shared/utils/calculator/loan-helper.js":function(e,t,a){"use strict";a.d(t,"a",function(){return i}),a.d(t,"c",function(){return n}),a.d(t,"b",function(){return r});var s=a("./site-modules/shared/constants/calculator/calculator.js");function i(e,t){let a;switch(t){case s.p:a=e+5;break;case s.n:a=e+1;break;case s.m:a=e+1.5;break;case s.l:a=e;break;default:a=e}return a}function n(e){let t=e.apr,a=e.defaultApr;const n=i(a,s.l),r=i(a,s.n),o=i(a,s.m);return t<=n?s.l:t>n&&t<=r?s.n:t>r&&t<=o?s.m:s.p}function r(e){return s.s[e]}},"./site-modules/shared/utils/inventory-utils/build-filter-pixel-value.js":function(e,t,a){"use strict";a.d(t,"a",function(){return i});const s="~";function i(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return`${e}${s}${t||a}${s}${a}`}},"./site-modules/shared/utils/location.js":function(e,t,a){"use strict";a.d(t,"a",function(){return r}),a.d(t,"b",function(){return o});var s=a("./data/api/api-client.js"),i=a("./utils/metrics-header.js"),n=a("./constants/location.js");function r(e,t){let a=t.pageName,n=t.venomVersion;return s.c.fetchJson(`/zip/v2/${e}`,{headers:Object(i.a)("getLocationByZipCode",a,n)})}function o(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=e.userSet,a=e.zipCode;return!1===t&&a===n.a.zipCode}},104:function(e,t){}}]);
//# sourceMappingURL=vdp-payment-calculator.chunk.83ac08d76690e93524e6.js.map